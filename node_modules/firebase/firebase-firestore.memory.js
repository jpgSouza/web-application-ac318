!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(bf){"use strict";try{(function(){bf=bf&&Object.prototype.hasOwnProperty.call(bf,"default")?bf.default:bf;var t,p,e,i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function d(t,s,u,a){return new(u=u||Promise)(function(n,e){function i(t){try{o(a.next(t))}catch(t){e(t)}}function r(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(i,r)}o((a=a.apply(t,s||[])).next())})}function y(n,i){var r,o,s,t,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=i.call(n,u)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function v(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}(e=p=p||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";function r(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+r+"]  "+t.name+":"],n))}}var o={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},u=p.INFO,a=((t={})[p.DEBUG]="log",t[p.VERBOSE]="log",t[p.INFO]="info",t[p.WARN]="warn",t[p.ERROR]="error",t),h=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in p))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!0,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.DEBUG],t)),this._logHandler.apply(this,s([this,p.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.VERBOSE],t)),this._logHandler.apply(this,s([this,p.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.INFO],t)),this._logHandler.apply(this,s([this,p.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.WARN],t)),this._logHandler.apply(this,s([this,p.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.ERROR],t)),this._logHandler.apply(this,s([this,p.ERROR],t))},c);function c(t){this.name=t,this._logLevel=u,this._logHandler=r,this._userLogHandler=null}function g(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var f,m=(n(l,f=Error),l);function l(t,e){var n=f.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,l.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,w.prototype.create),n}var w=(b.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i,r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(i=r,s.replace(E,function(t,e){var n=i[e];return null!=n?n.toString():"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new m(o,a),c=0,f=Object.keys(r);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=r[l])}return h},b);function b(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,I=(T.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},T.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},T.prototype.setServiceProps=function(t){return this.serviceProps=t,this},T);function T(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},R=R||{},D=_||self;function S(){}function O(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function k(t){var e=O(t);return"array"==e||"object"==e&&"number"==typeof t.length}function L(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),V=0;function U(t,e,n){return t.call.apply(t.bind,arguments)}function M(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?U:M).apply(null,arguments)}function q(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var x=Date.now||function(){return+new Date};function j(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.da=function(){if(!this.j&&(this.j=!0,this.C(),0))t=this,Object.prototype.hasOwnProperty.call(t,P)&&t[P]||(t[P]=++V);var t},F.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function z(t){return Array.prototype.concat.apply([],arguments)}function H(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var Q,X=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function K(t,e){return t<e?-1:e<t?1:0}t:{var $=D.navigator;if($){var J=$.userAgent;if(J){Q=J;break t}}Q=""}function Z(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function tt(t){var e={};for(var n in t)e[n]=t[n];return e}var et="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nt(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<et.length;o++)n=et[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function it(t){return it[" "](t),t}it[" "]=S;var rt,ot,st=Y(Q,"Opera"),ut=Y(Q,"Trident")||Y(Q,"MSIE"),at=Y(Q,"Edge"),ht=at||ut,ct=Y(Q,"Gecko")&&!(Y(Q.toLowerCase(),"webkit")&&!Y(Q,"Edge"))&&!(Y(Q,"Trident")||Y(Q,"MSIE"))&&!Y(Q,"Edge"),ft=Y(Q.toLowerCase(),"webkit")&&!Y(Q,"Edge");function lt(){var t=D.document;return t?t.documentMode:void 0}t:{var pt="",dt=(ot=Q,ct?/rv:([^\);]+)(\)|;)/.exec(ot):at?/Edge\/([\d\.]+)/.exec(ot):ut?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ot):ft?/WebKit\/(\S+)/.exec(ot):st?/(?:Version)[ \/]?(\S+)/.exec(ot):void 0);if(dt&&(pt=dt?dt[1]:""),ut){var yt=lt();if(null!=yt&&yt>parseFloat(pt)){rt=String(yt);break t}}rt=pt}var vt,gt={};function mt(u){return t=u,e=function(){for(var t=0,e=X(String(rt)).split("."),n=X(String(u)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=K(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||K(0==o[2].length,0==s[2].length)||K(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=gt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}if(D.document&&ut){var wt=lt();vt=wt||(parseInt(rt,10)||void 0)}else vt=void 0;var bt=vt,Et=!ut||9<=Number(bt),It=ut&&!mt("9"),Tt=function(){if(!D.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{D.addEventListener("test",S,e),D.removeEventListener("test",S,e)}catch(t){}return t}();function At(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Nt(t,e){if(At.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ct){t:{try{it(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:_t[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}At.prototype.b=function(){this.defaultPrevented=!0},j(Nt,At);var _t={2:"touch",3:"pen",4:"mouse"};Nt.prototype.b=function(){Nt.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,It)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Rt="closure_listenable_"+(1e6*Math.random()|0),Dt=0;function St(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.aa=r,this.key=++Dt,this.V=this.X=!1}function Ot(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function kt(t){this.src=t,this.a={},this.b=0}function Lt(t,e){var n=e.type;if(n in t.a){var i,r=t.a[n],o=B(r,e);(i=0<=o)&&Array.prototype.splice.call(r,o,1),i&&(Ot(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Pt(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==i)return r}return-1}kt.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Pt(t,e,i,r);return-1<s?(e=t[s],n||(e.X=!1)):((e=new St(e,this.src,o,!!i,r)).X=n,t.push(e)),e};var Vt="closure_lm_"+(1e6*Math.random()|0),Ut={};function Mt(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}i=zt(i);return e&&e[Rt]?e.sa(n,i,L(r)?!!r.capture:!!r,o):Ct(e,n,i,!0,r,o)}(t,e,n,i,r);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Mt(t,e[o],n,i,r);return null}return n=zt(n),t&&t[Rt]?t.ra(e,n,L(i)?!!i.capture:!!i,r):Ct(t,e,n,!1,i,r)}function Ct(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=L(r)?!!r.capture:!!r;if(s&&!Et)return null;var u,a,h=Bt(t);if(h||(t[Vt]=h=new kt(t)),(n=h.add(e,n,i,s,o)).proxy)return n;if(u=Ft,i=a=Et?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=i).src=t,i.listener=n,t.addEventListener)Tt||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(xt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function qt(t){if("number"!=typeof t&&t&&!t.V){var e=t.src;if(e&&e[Rt])Lt(e.c,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(xt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Bt(e))?(Lt(n,t),0==n.b&&(n.src=null,e[Vt]=null)):Ot(t)}}}function xt(t){return t in Ut?Ut[t]:Ut[t]="on"+t}function jt(t,e){var n=t.listener,i=t.aa||t.src;return t.X&&qt(t),n.call(i,e)}function Ft(t,e){if(t.V)return!0;if(Et)return jt(t,new Nt(e,this));if(!e)t:{e=["window","event"];for(var n=D,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}return jt(t,e=new Nt(e,this))}function Bt(t){return(t=t[Vt])instanceof kt?t:null}var Gt="__closure_events_fn_"+(1e9*Math.random()>>>0);function zt(e){return"function"==O(e)?e:(e[Gt]||(e[Gt]=function(t){return e.handleEvent(t)}),e[Gt])}function Ht(){F.call(this),this.c=new kt(this),(this.J=this).A=null}function Wt(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.V&&s.capture==n){var u=s.listener,a=s.aa||s.src;s.X&&Lt(t.c,s),r=!1!==u.call(a,i)&&r}}return r&&!i.defaultPrevented}j(Ht,F),Ht.prototype[Rt]=!0,(N=Ht.prototype).addEventListener=function(t,e,n,i){Mt(this,t,e,n,i)},N.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=L(r)?!!r.capture:!!r,i=zt(i),e&&e[Rt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=Pt(s=e.a[n],i,r,o))&&(Ot(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Bt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Pt(n,i,r,o)),(i=-1<e?n[e]:null)&&qt(i))}(this,t,e,n,i)},N.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var i=t.type||t;if("string"==typeof t)t=new At(t,n);else if(t instanceof At)t.target=t.target||n;else{var r=t;nt(t=new At(i,n),r)}if(r=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];r=Wt(s,i,!0,t)&&r}if(r=Wt(s=t.a=n,i,!0,t)&&r,r=Wt(s,i,!1,t)&&r,e)for(o=0;o<e.length;o++)r=Wt(s=t.a=e[o],i,!1,t)&&r;return r},N.C=function(){if(Ht.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)Ot(n[i]);delete e.a[t],e.b--}}this.A=null},N.ra=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},N.sa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var Qt=D.JSON.stringify;function Xt(){this.b=this.a=null}var Yt,Kt=($t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new $t(function(){return new Jt},function(t){t.reset()},100));function $t(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Jt(){this.next=this.b=this.a=null}function Zt(t){D.setTimeout(function(){throw t},0)}function te(t,e){var n;Yt||(n=D.Promise.resolve(void 0),Yt=function(){n.then(ie)}),ee||(Yt(),ee=!0),ne.add(t,e)}Xt.prototype.add=function(t,e){var n=Kt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Jt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var ee=!(Jt.prototype.reset=function(){this.next=this.b=this.a=null}),ne=new Xt;function ie(){for(var t;i=n=void 0,i=null,(n=ne).a&&(i=n.a,n.a=n.a.next,n.a||(n.b=null),i.next=null),t=i;){try{t.a.call(t.b)}catch(t){Zt(t)}var e=Kt;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}var n,i;ee=!1}function re(t,e){Ht.call(this),this.b=t||1,this.a=e||D,this.f=C(this.Ua,this),this.g=x()}function oe(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function se(t,e,n){if("function"==O(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:D.setTimeout(t,e||0)}function ue(t,e,n){F.call(this),this.f=null!=n?C(t,n):t,this.c=e,this.b=C(this.Pa,this),this.a=[]}function ae(t){t.T=se(t.b,t.c),t.f.apply(null,t.a)}function he(t){F.call(this),this.b=t,this.a={}}j(re,Ht),(N=re.prototype).Z=!1,N.L=null,N.Ua=function(){if(this.Z){var t=x()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(oe(this),this.start()))}},N.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=x())},N.C=function(){re.M.C.call(this),oe(this),delete this.a},j(ue,F),(N=ue.prototype).ba=!1,N.T=null,N.Ia=function(t){this.a=arguments,this.T?this.ba=!0:ae(this)},N.C=function(){ue.M.C.call(this),this.T&&(D.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},N.Pa=function(){this.T=null,this.ba&&(this.ba=!1,ae(this))},j(he,F);var ce=[];function fe(t,e,n,i){Array.isArray(n)||(n&&(ce[0]=n.toString()),n=ce);for(var r=0;r<n.length;r++){var o=Mt(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function le(t){Z(t.a,function(t,e){this.a.hasOwnProperty(e)&&qt(t)},t),t.a={}}function pe(){}he.prototype.C=function(){he.M.C.call(this),le(this)},he.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var de=null;function ye(){return de=de||new Ht}function ve(t){At.call(this,"serverreachability",t)}function ge(t){var e=ye();e.dispatchEvent(new ve(e))}function me(t){At.call(this,"statevent",t)}function we(t){var e=ye();e.dispatchEvent(new me(e))}function be(t){At.call(this,"timingevent",t)}function Ee(t,e){if("function"!=O(t))throw Error("Fn must not be null and must be a function");return D.setTimeout(function(){t()},e)}j(ve,At),j(me,At),j(be,At);var Ie={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},Te={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function Ae(){}function Ne(t){var e;return(e=t.a)||(e=t.a={}),e}function _e(){}Ae.prototype.a=null;var Re,De={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function Se(){At.call(this,"d")}function Oe(){At.call(this,"c")}function ke(){}function Le(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new he(this),this.N=Pe,t=ht?125:void 0,this.O=new re(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}j(Se,At),j(Oe,At),j(ke,Ae),Re=new ke;var Pe=45e3,Ve={},Ue={};function Me(t,e,n){t.B=1,t.f=on(Je(e)),t.j=n,t.F=!0,Ce(t,null)}function Ce(t,e){t.s=x(),je(t),t.A=Je(t.f);var n=t.A,i=t.U;Array.isArray(i)||(i=[String(i)]),mn(n.b,"t",i),t.w=0,t.a=hi(t.g,t.g.w?e:null),0<t.J&&(t.D=new ue(C(t.ya,t,t.a),t.J)),fe(t.G,t.a,"readystatechange",t.Sa),e=t.m?tt(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),ge(1)}function qe(t,e,n){for(var i=!0;!t.l&&t.w<n.length;){var r=xe(t,n);if(r==Ue){4==e&&(t.c=4,we(14),i=!1);break}if(r==Ve){t.c=4,we(15),i=!1;break}He(t,r)}4==e&&0==n.length&&(t.c=1,we(16),i=!1),t.b=t.b&&i,i||(ze(t),Ge(t))}function xe(t,e){var n=t.w,i=e.indexOf("\n",n);return-1==i?Ue:(n=Number(e.substring(n,i)),isNaN(n)?Ve:(i+=1)+n>e.length?Ue:(e=e.substr(i,n),t.w=i+n,e))}function je(t){t.P=x()+t.N,Fe(t,t.N)}function Fe(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=Ee(C(t.Qa,t),e)}function Be(t){t.h&&(D.clearTimeout(t.h),t.h=null)}function Ge(t){0==t.g.u||t.l||ri(t.g,t)}function ze(t){Be(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,oe(t.O),le(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function He(t,e){try{var n=t.g;if(0!=n.u&&(n.a==t||Nn(n.b,t)))if(n.A=t.H,!t.o&&Nn(n.b,t)&&3==n.u){try{var i=n.ja.a.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!n.i){if(n.a){if(!(n.a.s+3e3<t.s))break t;ii(n),n.a.cancel(),n.a=null}ni(n),we(18)}}else n.ia=r[1],0<n.ia-n.G&&r[2]<37500&&n.U&&0==n.m&&!n.l&&(n.l=Ee(C(n.Na,n),6e3));if(An(n.b)<=1&&n.O){try{n.O()}catch(t){}n.O=void 0}}else si(n,11)}else if(!t.o&&n.a!=t||ii(n),!W(e))for(e=i=n.ja.a.parse(e),i=0;i<e.length;i++)if(r=e[i],n.G=r[0],r=r[1],2==n.u)if("c"==r[0]){n.B=r[1],n.R=r[2];var o=r[3];null!=o&&(n.oa=o);var s=r[5];null!=s&&"number"==typeof s&&0<s&&(n.D=1.5*s);var u=n,a=t.a;if(a){var h=a.a?a.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var c=u.b;!c.a&&(Y(h,"spdy")||Y(h,"quic")||Y(h,"h2"))&&(c.f=c.g,c.a=new Set,c.b&&(_n(c,c.b),c.b=null))}if(u.s){var f=a.a?a.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.ha=f,rn(u.v,u.s,f))}}n.u=3,n.c&&n.c.na();var l=t;if((u=n).ea=ai(u,u.w?u.R:null,u.P),l.o){Rn(u.b,l);var p=l,d=u.D;d&&p.setTimeout(d),p.h&&(Be(p),je(p)),u.a=l}else ei(u);0<n.f.length&&$n(n)}else"stop"!=r[0]&&"close"!=r[0]||si(n,7);else 3==n.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?si(n,7):Xn(n):"noop"!=r[0]&&n.c&&n.c.ma(r),n.m=0);ge(4)}catch(t){}}function We(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)G(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function Qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Qe)for(n=t.K(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Xe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Ye(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){var r={};for(n=e=0;e<t.a.length;)Ye(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function Ye(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Le.prototype).setTimeout=function(t){this.N=t},N.Sa=function(t){t=t.target;var e=this.D;e&&3==zn(t)?e.Ia():this.ya(t)},N.ya=function(t){try{if(t==this.a)t:{var e=zn(this.a),n=this.a.qa(),i=this.a.S();if(!(e<3||3==e&&!ht&&!this.a.Y())){this.l||4!=e||7==n||ge(8==n||i<=0?3:2),Be(this);var r=this.a.S();this.H=r;var o=this.a.Y();if(this.b=200==r){if(this.R&&!this.o){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.c=3,we(12),ze(this),Ge(this);break t}this.o=!0,He(this,a)}this.F?(qe(this,e,o),ht&&this.b&&3==e&&(fe(this.G,this.O,"tick",this.Ra),this.O.start())):He(this,o),4==e&&ze(this),this.b&&!this.l&&(4==e?ri(this.g,this):(this.b=!1,je(this)))}else 400==r&&0<o.indexOf("Unknown SID")?(this.c=3,we(12)):(this.c=0,we(13)),ze(this),Ge(this)}}}catch(t){}},N.Ra=function(){if(this.a){var t=zn(this.a),e=this.a.Y();this.w<e.length&&(Be(this),qe(this,t,e),this.b&&4!=t&&je(this))}},N.cancel=function(){this.l=!0,ze(this)},N.Qa=function(){this.h=null;var t=x();0<=t-this.P?(2!=this.B&&(ge(3),we(17)),ze(this),this.c=2,Ge(this)):Fe(this,this.P-t)},(N=Qe.prototype).I=function(){Xe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.K=function(){return Xe(this),this.a.concat()},N.get=function(t,e){return Ye(this.b,t)?this.b[t]:e},N.set=function(t,e){Ye(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.K(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var Ke=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function $e(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof $e){this.a=void 0!==e?e:t.a,Ze(this,t.f),this.j=t.j,tn(this,t.c),en(this,t.h),this.g=t.g,e=t.b;var n=new dn;n.c=e.c,e.a&&(n.a=new Qe(e.a),n.b=e.b),nn(this,n),this.i=t.i}else t&&(n=String(t).match(Ke))?(this.a=!!e,Ze(this,n[1]||"",!0),this.j=sn(n[2]||""),tn(this,n[3]||"",!0),en(this,n[4]),this.g=sn(n[5]||"",!0),nn(this,n[6]||"",!0),this.i=sn(n[7]||"")):(this.a=!!e,this.b=new dn(null,this.a))}function Je(t){return new $e(t)}function Ze(t,e,n){t.f=n?sn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function tn(t,e,n){t.c=n?sn(e,!0):e}function en(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function nn(t,e,n){var i,r;e instanceof dn?(t.b=e,i=t.b,(r=t.a)&&!i.f&&(yn(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(vn(this,e),mn(this,n,t))},i)),i.f=r):(n||(e=un(e,ln)),t.b=new dn(e,t.a))}function rn(t,e,n){t.b.set(e,n)}function on(t){return rn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^x()).toString(36)),t}function sn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function un(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,an),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function an(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}$e.prototype.toString=function(){var t=[],e=this.f;e&&t.push(un(e,hn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(un(e,hn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(un(n,"/"==n.charAt(0)?fn:cn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",un(n,pn)),t.join("")};var hn=/[#\/\?@]/g,cn=/[#\?:]/g,fn=/[#\?]/g,ln=/[#\?@]/g,pn=/#/g;function dn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function yn(n){n.a||(n.a=new Qe,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var o=t[n].substring(0,i);r=t[n].substring(i+1)}else o=t[n];e(o,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function vn(t,e){yn(t),e=wn(t,e),Ye(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ye((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Xe(t)))}function gn(t,e){return yn(t),e=wn(t,e),Ye(t.a.b,e)}function mn(t,e,n){vn(t,e),0<n.length&&(t.c=null,t.a.set(wn(t,e),H(n)),t.b+=n.length)}function wn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function bn(t,e){this.b=t,this.a=e}function En(t){this.g=t||In,t=D.PerformanceNavigationTiming?0<(t=D.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(D.ca&&D.ca.ua&&D.ca.ua()&&D.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=dn.prototype).add=function(t,e){yn(this),this.c=null,t=wn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,i){yn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(i,t,e,this)},this)},this)},N.K=function(){yn(this);for(var t=this.a.I(),e=this.a.K(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},N.I=function(t){yn(this);var e=[];if("string"==typeof t)gn(this,t)&&(e=z(e,this.a.get(wn(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},N.set=function(t,e){return yn(this),this.c=null,gn(this,t=wn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.I(i);for(var o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}}return this.c=t.join("&")};var In=10;function Tn(t){return t.b||t.a&&t.a.size>=t.f}function An(t){return t.b?1:t.a?t.a.size:0}function Nn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function _n(t,e){t.a?t.a.add(e):t.b=e}function Rn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Dn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null==t.a||0===t.a.size)return H(t.c);var i=t.c;try{for(var r=A(t.a.values()),o=r.next();!o.done;o=r.next()){var s=o.value;i=i.concat(s.i)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}function Sn(){}function On(){this.a=new Sn}function kn(t,i,e){var r=e||"";try{We(t,function(t,e){var n=t;L(t)&&(n=Qt(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}function Ln(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}En.prototype.cancel=function(){var e,t;if(this.c=Dn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),i=n.next();!i.done;i=n.next()){i.value.cancel()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Sn.prototype.stringify=function(t){return D.JSON.stringify(t,void 0)},Sn.prototype.parse=function(t){return D.JSON.parse(t,void 0)};var Pn=D.JSON.parse;function Vn(t){Ht.call(this),this.headers=new Qe,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=Un,this.B=this.F=!1}j(Vn,Ht);var Un="",Mn=/^https?$/i,Cn=["POST","PUT"];function qn(t){return"content-type"==t.toLowerCase()}function xn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,jn(t),Bn(t)}function jn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Fn(t){if(t.b&&void 0!==R&&(!t.s[1]||4!=zn(t)||2!=t.S()))if(t.l&&4==zn(t))se(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==zn(t)){t.b=!1;try{var e,n=t.S();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1}if(!(e=i)){var r;if(r=0===n){var o=String(t.D).match(Ke)[1]||null;if(!o&&D.self&&D.self.location){var s=D.self.location.protocol;o=s.substr(0,s.length-1)}r=!Mn.test(o?o.toLowerCase():"")}e=r}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<zn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.S()+"]",jn(t)}}finally{Bn(t)}}}function Bn(t,e){if(t.a){Gn(t);var n=t.a,i=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function Gn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(D.clearTimeout(t.m),t.m=null)}function zn(t){return t.a?t.a.readyState:0}function Hn(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}var r;i||(r="",Z(n,function(t,e){r+=e,r+=":",r+=t,r+="\r\n"}),n=r,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):rn(t,e,n))}function Wn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Qn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=Wn("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=Wn("baseRetryDelayMs",5e3,t),this.Ga=Wn("retryDelaySeedMs",1e4,t),this.Da=Wn("forwardChannelMaxRetries",2,t),this.ga=Wn("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new En(t&&t.concurrentRequestLimit),this.ja=new On,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function Xn(t){if(Yn(t),3==t.u){var e=t.H++,n=Je(t.v);rn(n,"SID",t.B),rn(n,"RID",e),rn(n,"TYPE","terminate"),Zn(t,n),(e=new Le(t,e,void 0)).B=2,e.f=on(Je(n)),n=!1,D.navigator&&D.navigator.sendBeacon&&(n=D.navigator.sendBeacon(e.f.toString(),"")),!n&&D.Image&&((new Image).src=e.f,n=!0),n||(e.a=hi(e.g,null),e.a.$(e.f)),e.s=x(),je(e)}ui(t)}function Yn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(D.clearTimeout(t.i),t.i=null),ii(t),t.b.cancel(),t.g&&("number"==typeof t.g&&D.clearTimeout(t.g),t.g=null)}function Kn(t,e){t.f.push(new bn(t.Fa++,e)),3==t.u&&$n(t)}function $n(t){Tn(t.b)||t.g||(t.g=!0,te(t.xa,t),t.o=0)}function Jn(t,e){var n;n=e?e.W:t.H++;var i=Je(t.v);rn(i,"SID",t.B),rn(i,"RID",n),rn(i,"AID",t.G),Zn(t,i),t.h&&t.j&&Hn(i,t.h,t.j),n=new Le(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=ti(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),_n(t.b,n),Me(n,i,e)}function Zn(t,n){t.c&&We({},function(t,e){rn(n,e,t)})}function ti(t,e,n){n=Math.min(t.f.length,n);var i=t.c?C(t.c.Ha,t.c,t):null;t:for(var r=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=r[a].b,c=r[a].a;if((h-=o)<0)o=Math.max(0,r[a].b-100),u=!1;else try{kn(c,s,"req"+h+"_")}catch(t){i&&i(c)}}if(u){i=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,i}function ei(t){t.a||t.i||(t.J=1,te(t.wa,t),t.m=0)}function ni(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=Ee(C(t.wa,t),oi(t,t.m)),t.m++,1)}function ii(t){null!=t.l&&(D.clearTimeout(t.l),t.l=null)}function ri(t,e){var n=null;if(t.a==e){ii(t),t.a=null;var i=2}else{if(!Nn(t.b,e))return;n=e.i,Rn(t.b,e),i=1}if(t.A=e.H,0!=t.u)if(e.b)if(1==i){n=e.j?e.j.length:0,e=x()-e.s;var r=t.o;(i=ye()).dispatchEvent(new be(i)),$n(t)}else ei(t);else if(3==(r=e.c)||0==r&&0<t.A||!(1==i&&function(t,e){if(!(An(t.b)>=t.b.f-(t.g?1:0))){if(t.g)return t.f=e.i.concat(t.f),1;if(!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)))return t.g=Ee(C(t.xa,t,e),oi(t,t.o)),t.o++,1}}(t,e)||2==i&&ni(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),r){case 1:si(t,5);break;case 4:si(t,10);break;case 3:si(t,6);break;default:si(t,2)}}function oi(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function si(t,e){if(2==e){var n=null;t.c&&(n=null);var i=C(t.Ta,t);n||(n=new $e("//www.google.com/images/cleardot.gif"),D.location&&"http"==D.location.protocol||Ze(n,"https"),on(n)),function(t,e){var n=new pe;if(D.Image){var i=new Image;i.onload=q(Ln,n,i,"TestLoadImage: loaded",!0,e),i.onerror=q(Ln,n,i,"TestLoadImage: error",!1,e),i.onabort=q(Ln,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=q(Ln,n,i,"TestLoadImage: timeout",!1,e),D.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=t}else e(!1)}(n.toString(),i)}else we(2);t.u=0,t.c&&t.c.la(e),ui(t),Yn(t)}function ui(t){t.u=0,t.A=-1,t.c&&(0==Dn(t.b).length&&0==t.f.length||(t.b.c.length=0,H(t.f),t.f.length=0),t.c.ka())}function ai(t,e,n){var i,r,o,s,u,a,h=(i=n)instanceof $e?Je(i):new $e(i,void 0);if(""!=h.c)e&&tn(h,e+"."+h.c),en(h,h.h);else{var c=D.location;r=c.protocol,o=e?e+"."+c.hostname:c.hostname,s=+c.port,u=n,a=new $e(null,void 0),r&&Ze(a,r),o&&tn(a,o),s&&en(a,s),u&&(a.g=u),h=a}return t.N&&Z(t.N,function(t,e){rn(h,e,t)}),e=t.s,n=t.ha,e&&n&&rn(h,e,n),rn(h,"VER",t.oa),Zn(t,h),h}function hi(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Vn(t.Ea)).F=t.w,e}function ci(){}function fi(){if(ut&&!(10<=Number(bt)))throw Error("Environmental error: no available transport.")}function li(t,e){Ht.call(this),this.a=new Qn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new yi(this)}function pi(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function di(){Oe.call(this),this.status=1}function yi(t){this.a=t}(N=Vn.prototype).$=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?Ne(this.G):Ne(Re),this.a.onreadystatechange=C(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void xn(this,t)}t=n||"";var r,o=new Qe(this.headers);i&&We(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=qn,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.K()),n=D.FormData&&t instanceof D.FormData,0<=B(Cn,e)&&!i&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Gn(this),0<this.o&&((this.B=(r=this.a,ut&&mt(9)&&"number"==typeof r.timeout&&void 0!==r.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.ta,this)):this.m=se(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){xn(this,t)}},N.ta=function(){void 0!==R&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Bn(this))},N.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Bn(this,!0)),Vn.M.C.call(this)},N.va=function(){this.j||(this.w||this.l||this.g?Fn(this):this.Oa())},N.Oa=function(){Fn(this)},N.S=function(){try{return 2<zn(this)?this.a.status:-1}catch(t){return-1}},N.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Pn(e)}},N.qa=function(){return this.h},N.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Qn.prototype).oa=8,N.u=1,N.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random()),t=this.H++;var e,n=new Le(this,t,void 0),i=this.j;if(this.F&&(i?nt(i=tt(i),this.F):i=this.F),null===this.h&&(n.m=i),this.fa)t:{for(var r=e=0;r<this.f.length;r++){var o=this.f[r];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.f.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=ti(this,n,e),rn(r=Je(this.v),"RID",t),rn(r,"CVER",22),this.s&&rn(r,"X-HTTP-Session-Id",this.s),Zn(this,r),this.h&&i&&Hn(r,this.h,i),_n(this.b,n),this.fa?(rn(r,"$req",e),rn(r,"SID","null"),n.R=!0,Me(n,r,null)):Me(n,r,e),this.u=2}}else 3==this.u&&(t?Jn(this,t):0==this.f.length||Tn(this.b)||Jn(this))},N.wa=function(){this.i=null,this.a=new Le(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=Je(this.ea);rn(t,"RID","rpc"),rn(t,"SID",this.B),rn(t,"CI",this.U?"0":"1"),rn(t,"AID",this.G),Zn(this,t),rn(t,"TYPE","xmlhttp"),this.h&&this.j&&Hn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=on(Je(t)),e.j=null,e.F=!0,Ce(e,n)},N.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,ni(this),we(19))},N.Ta=function(t){we(t?2:1)},(N=ci.prototype).na=function(){},N.ma=function(){},N.la=function(){},N.ka=function(){},N.Ha=function(){},fi.prototype.a=function(t,e){return new li(t,e)},j(li,Ht),(N=li.prototype).addEventListener=function(t,e,n,i){li.M.addEventListener.call(this,t,e,n,i)},N.removeEventListener=function(t,e,n,i){li.M.removeEventListener.call(this,t,e,n,i)},N.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;we(0),t.P=e,t.N=n||{},t.U=t.W,t.v=ai(t,null,t.P),$n(t)},N.close=function(){Xn(this.a)},N.La=function(t){if("string"==typeof t){var e={};e.__data__=t,Kn(this.a,e)}else this.g?((e={}).__data__=Qt(t),Kn(this.a,e)):Kn(this.a,t)},N.C=function(){this.a.c=null,delete this.f,Xn(this.a),delete this.a,li.M.C.call(this)},j(pi,Se),j(di,Oe),j(yi,ci),yi.prototype.na=function(){this.a.dispatchEvent("a")},yi.prototype.ma=function(t){this.a.dispatchEvent(new pi(t))},yi.prototype.la=function(t){this.a.dispatchEvent(new di)},yi.prototype.ka=function(){this.a.dispatchEvent("b")},fi.prototype.createWebChannel=fi.prototype.a,li.prototype.send=li.prototype.La,li.prototype.open=li.prototype.Ka,li.prototype.close=li.prototype.close,Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,Te.COMPLETE="complete",(_e.EventType=De).OPEN="a",De.CLOSE="b",De.ERROR="c",De.MESSAGE="d",Ht.prototype.listen=Ht.prototype.ra,Vn.prototype.listenOnce=Vn.prototype.sa,Vn.prototype.getLastError=Vn.prototype.Ma,Vn.prototype.getLastErrorCode=Vn.prototype.qa,Vn.prototype.getStatus=Vn.prototype.S,Vn.prototype.getResponseJson=Vn.prototype.Ja,Vn.prototype.getResponseText=Vn.prototype.Y,Vn.prototype.send=Vn.prototype.$;var vi={createWebChannelTransport:function(){return new fi},ErrorCode:Ie,EventType:Te,WebChannel:_e,XhrIo:Vn},gi=vi.createWebChannelTransport,mi=vi.ErrorCode,wi=vi.EventType,bi=vi.WebChannel,Ei=vi.XhrIo,Ii=bf.SDK_VERSION,Ti=(Ai.prototype.t=function(){return null!=this.uid},Ai.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},Ai.prototype.isEqual=function(t){return t.uid===this.uid},Ai);function Ai(t){this.uid=t}Ti.UNAUTHENTICATED=new Ti(null),Ti.i=new Ti("google-credentials-uid"),Ti.h=new Ti("first-party-uid");function Ni(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t}var _i,Ri,Di={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Si=(n(Wi,Ri=Error),Wi),Oi=(Hi.prototype.getToken=function(){return Promise.resolve(null)},Hi.prototype.l=function(){},Hi.prototype._=function(t){(this.u=t)(Ti.UNAUTHENTICATED)},Hi.prototype.T=function(){this.u=null},Hi),ki=(zi.prototype.getToken=function(){var e=this,n=this.R,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.R!==n?(Qs("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?($s("string"==typeof t.accessToken),new Ni(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},zi.prototype.l=function(){this.forceRefresh=!0},zi.prototype._=function(t){this.u=t,this.m&&t(this.currentUser)},zi.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.I),this.I=null,this.u=null},zi.prototype.A=function(){var t=this.auth&&this.auth.getUid();return $s(null===t||"string"==typeof t),new Ti(t)},zi),Li=(Object.defineProperty(Gi.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.p([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),Gi),Pi=(Bi.prototype.getToken=function(){return Promise.resolve(new Li(this.P,this.V))},Bi.prototype._=function(t){t(Ti.h)},Bi.prototype.T=function(){},Bi.prototype.l=function(){},Bi),Vi=(Fi.now=function(){return Fi.fromMillis(Date.now())},Fi.fromDate=function(t){return Fi.fromMillis(t.getTime())},Fi.fromMillis=function(t){var e=Math.floor(t/1e3);return new Fi(e,1e6*(t-1e3*e))},Fi.prototype.toDate=function(){return new Date(this.toMillis())},Fi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Fi.prototype.g=function(t){return this.seconds===t.seconds?eu(this.nanoseconds,t.nanoseconds):eu(this.seconds,t.seconds)},Fi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Fi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Fi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Fi),Ui=(ji.v=function(t){return new ji(t)},ji.min=function(){return new ji(new Vi(0,0))},ji.prototype.S=function(t){return this.timestamp.g(t.timestamp)},ji.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ji.prototype.C=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ji.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ji.prototype.D=function(){return this.timestamp},ji),Mi=(Object.defineProperty(xi.prototype,"length",{get:function(){return this.F},enumerable:!0,configurable:!0}),xi.prototype.isEqual=function(t){return 0===xi.N(this,t)},xi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof xi?t.forEach(function(t){e.push(t)}):e.push(t),this.$(e)},xi.prototype.limit=function(){return this.offset+this.length},xi.prototype.L=function(t){return t=void 0===t?1:t,this.$(this.segments,this.offset+t,this.length-t)},xi.prototype.O=function(){return this.$(this.segments,this.offset,this.length-1)},xi.prototype.k=function(){return this.segments[this.offset]},xi.prototype.q=function(){return this.get(this.length-1)},xi.prototype.get=function(t){return this.segments[this.offset+t]},xi.prototype.M=function(){return 0===this.length},xi.prototype.B=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},xi.prototype.U=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},xi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},xi.prototype.W=function(){return this.segments.slice(this.offset,this.limit())},xi.N=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},xi),Ci=(n(qi,_i=Mi),qi.prototype.$=function(t,e,n){return new qi(t,e,n)},qi.prototype.j=function(){return this.W().join("/")},qi.prototype.toString=function(){return this.j()},qi.G=function(t){if(0<=t.indexOf("//"))throw new Si(Di.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new qi(t.split("/").filter(function(t){return 0<t.length}))},qi);function qi(){return null!==_i&&_i.apply(this,arguments)||this}function xi(t,e,n){void 0===e?e=0:e>t.length&&Ks(),void 0===n?n=t.length-e:n>t.length-e&&Ks(),this.segments=t,this.offset=e,this.F=n}function ji(t){this.timestamp=t}function Fi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Si(Di.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Si(Di.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Si(Di.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Si(Di.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Bi(t,e){this.P=t,this.V=e}function Gi(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=Ti.h}function zi(t){var e=this;this.I=null,this.currentUser=Ti.UNAUTHENTICATED,this.m=!1,this.R=0,this.u=null,this.forceRefresh=!1,this.I=function(){e.R++,e.currentUser=e.A(),e.m=!0,e.u&&e.u(e.currentUser)},this.R=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.I):(this.I(null),t.get().then(function(t){e.auth=t,e.I&&e.auth.addAuthTokenListener(e.I)},function(){}))}function Hi(){this.u=null}function Wi(t,e){var n=this;return(n=Ri.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}Ci.H=new Ci([]);var Qi,Xi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Yi=(n(Ki,Qi=Mi),Ki.prototype.$=function(t,e,n){return new Ki(t,e,n)},Ki.K=function(t){return Xi.test(t)},Ki.prototype.j=function(){return this.W().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Ki.K(t)||(t="`"+t+"`"),t}).join(".")},Ki.prototype.toString=function(){return this.j()},Ki.prototype.Y=function(){return 1===this.length&&"__name__"===this.get(0)},Ki.X=function(){return new Ki(["__name__"])},Ki.J=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new Si(Di.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Si(Di.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Si(Di.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new Si(Di.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ki(e)},Ki);function Ki(){return null!==Qi&&Qi.apply(this,arguments)||this}Yi.H=new Yi([]);var $i=(Ji.Z=function(t){return new Ji(Ci.G(t).L(5))},Ji.prototype.tt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Ji.prototype.isEqual=function(t){return null!==t&&0===Ci.N(this.path,t.path)},Ji.prototype.toString=function(){return this.path.toString()},Ji.N=function(t,e){return Ci.N(t.path,e.path)},Ji.et=function(t){return t.length%2==0},Ji.st=function(t){return new Ji(new Ci(t.slice()))},Ji);function Ji(t){this.path=t}function Zi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function tr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function er(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}$i.EMPTY=new $i(new Ci([]));var nr=(ir.fromBase64String=function(t){return new ir(Gs.nt().atob(t))},ir.fromUint8Array=function(t){return new ir(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},ir.prototype.toBase64=function(){return Gs.nt().btoa(this.it)},ir.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.it)},ir.prototype.rt=function(){return 2*this.it.length},ir.prototype.S=function(t){return eu(this.it,t.it)},ir.prototype.isEqual=function(t){return this.it===t.it},ir);function ir(t){this.it=t}function rr(t){return null==t}function or(t){return-0===t&&1/t==-1/0}function sr(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ur(t){var e=yr(t.mapValue.fields.__local_write_time__.timestampValue);return new Vi(e.seconds,e.nanos)}nr.ht=new nr("");var ar=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function hr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?sr(t)?4:10:Ks()}function cr(r,t){var e,n,i,o=hr(r);if(o!==hr(t))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===t.booleanValue;case 4:return ur(r).isEqual(ur(t));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=yr(r.timestampValue),n=yr(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(t);case 5:return r.stringValue===t.stringValue;case 6:return i=t,gr(r.bytesValue).isEqual(gr(i.bytesValue));case 7:return r.referenceValue===t.referenceValue;case 8:return n=t,vr((e=r).geoPointValue.latitude)===vr(n.geoPointValue.latitude)&&vr(e.geoPointValue.longitude)===vr(n.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return vr(t.integerValue)===vr(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=vr(t.doubleValue),i=vr(e.doubleValue);return n===i?or(n)===or(i):isNaN(n)&&isNaN(i)}return!1}(r,t);case 9:return nu(r.arrayValue.values||[],t.arrayValue.values||[],cr);case 10:return function(t){var e=r.mapValue.fields||{},n=t.mapValue.fields||{};if(Zi(e)!==Zi(n))return!1;for(var i in e)if(e.hasOwnProperty(i)&&(void 0===n[i]||!cr(e[i],n[i])))return!1;return!0}(t);default:return Ks()}}function fr(t,e){return void 0!==(t.values||[]).find(function(t){return cr(t,e)})}function lr(t,e){var n,i,r,o,s,u,a,h,c,f,l=hr(t),p=hr(e);if(l!==p)return eu(l,p);switch(l){case 0:return 0;case 1:return eu(t.booleanValue,e.booleanValue);case 2:return h=e,c=vr(t.integerValue||t.doubleValue),f=vr(h.integerValue||h.doubleValue),c<f?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return pr(t.timestampValue,e.timestampValue);case 4:return pr(ur(t),ur(e));case 5:return eu(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=gr(o),a=gr(s),u.S(a);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var o=eu(n[r],i[r]);if(0!==o)return o}return eu(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=eu(vr(n.latitude),vr(i.latitude)))?r:eu(vr(n.longitude),vr(i.longitude));case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var o=lr(n[r],i[r]);if(o)return o}return eu(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(var s=0;s<i.length&&s<o.length;++s){var u=eu(i[s],o[s]);if(0!==u)return u;var a=lr(n[i[s]],r[o[s]]);if(0!==a)return a}return eu(i.length,o.length)}(t.mapValue,e.mapValue);default:throw Ks()}}function pr(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return eu(t,e);var n=yr(t),i=yr(e),r=eu(n.seconds,i.seconds);return 0!==r?r:eu(n.nanos,i.nanos)}function dr(t){return function s(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?"time("+(t=yr(r.timestampValue)).seconds+","+t.nanos+")":"stringValue"in r?r.stringValue:"bytesValue"in r?gr(r.bytesValue).toBase64():"referenceValue"in r?(n=r.referenceValue,$i.Z(n).toString()):"geoPointValue"in r?"geo("+(e=r.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in r?function(){for(var t="[",e=!0,n=0,i=r.arrayValue.values||[];n<i.length;n++){e?e=!1:t+=",",t+=s(i[n])}return t+"]"}():"mapValue"in r?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var o=r[i];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(r.mapValue):Ks();var t,e,n}(t)}function yr(t){if($s(!!t),"string"!=typeof t)return{seconds:vr(t.seconds),nanos:vr(t.nanos)};var e=0,n=ar.exec(t);if($s(!!n),n[1]){var i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}function vr(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function gr(t){return"string"==typeof t?nr.fromBase64String(t):nr.fromUint8Array(t)}function mr(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.j()}}function wr(t){return t&&"integerValue"in t}function br(t){return!!t&&"arrayValue"in t}function Er(t){return t&&"nullValue"in t}function Ir(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Tr(t){return t&&"mapValue"in t}var Ar=(Nr.prototype.ot=function(t,e){return n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},t&&(n.fields.__previous_value__=t),{mapValue:n};var n},Nr.prototype.at=function(t,e){return e},Nr.prototype.ut=function(t){return null},Nr.prototype.isEqual=function(t){return t instanceof Nr},Nr);function Nr(){}Ar.instance=new Ar;var _r=(kr.prototype.ot=function(t,e){return this.apply(t)},kr.prototype.at=function(t,e){return this.apply(t)},kr.prototype.apply=function(t){for(var n=Lr(t),e=function(e){n.some(function(t){return cr(t,e)})||n.push(e)},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},kr.prototype.ut=function(t){return null},kr.prototype.isEqual=function(t){return t instanceof kr&&nu(this.elements,t.elements,cr)},kr),Rr=(Or.prototype.ot=function(t,e){return this.apply(t)},Or.prototype.at=function(t,e){return this.apply(t)},Or.prototype.apply=function(t){for(var n=Lr(t),e=function(e){n=n.filter(function(t){return!cr(t,e)})},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},Or.prototype.ut=function(t){return null},Or.prototype.isEqual=function(t){return t instanceof Or&&nu(this.elements,t.elements,cr)},Or),Dr=(Sr.prototype.ot=function(t,e){var n=this.ut(t),i=this.asNumber(n)+this.asNumber(this.ct);return wr(n)&&wr(this.ct)?this.serializer.lt(i):this.serializer._t(i)},Sr.prototype.at=function(t,e){return e},Sr.prototype.ut=function(t){return wr(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},Sr.prototype.isEqual=function(t){return t instanceof Sr&&cr(this.ct,t.ct)},Sr.prototype.asNumber=function(t){return vr(t.integerValue||t.doubleValue)},Sr);function Sr(t,e){this.serializer=t,this.ct=e}function Or(t){this.elements=t}function kr(t){this.elements=t}function Lr(t){return br(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Pr(t,e){this.version=t,this.transformResults=e}var Vr,Ur,Mr,Cr,qr,xr=(so.prototype.ft=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].B(t))return!0;return!1},so.prototype.isEqual=function(t){return nu(this.fields,t.fields,function(t,e){return t.isEqual(e)})},so),jr=(oo.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},oo),Fr=(ro.dt=function(){return new ro},ro.exists=function(t){return new ro(void 0,t)},ro.updateTime=function(t){return new ro(t)},Object.defineProperty(ro.prototype,"wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),ro.prototype.Tt=function(t){return void 0!==this.updateTime?t instanceof Io&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof Io},ro.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ro),Br=(io.prototype.Et=function(t){},io.It=function(t){return t instanceof Io?t.version:Ui.min()},io),Gr=(n(no,qr=Br),no.prototype.at=function(t,e){this.Et(t);var n=e.version;return new Io(this.key,n,this.value,{hasCommittedMutations:!0})},no.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.Tt(t))return t;var i=Br.It(t);return new Io(this.key,i,this.value,{At:!0})},no.prototype.Pt=function(t){return null},no.prototype.isEqual=function(t){return t instanceof no&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Rt.isEqual(t.Rt)},no),zr=(n(eo,Cr=Br),eo.prototype.at=function(t,e){if(this.Et(t),!this.Rt.Tt(t))return new Ao(this.key,e.version);var n=this.pt(t);return new Io(this.key,e.version,n,{hasCommittedMutations:!0})},eo.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.Tt(t))return t;var i=Br.It(t),r=this.pt(t);return new Io(this.key,i,r,{At:!0})},eo.prototype.Pt=function(t){return null},eo.prototype.isEqual=function(t){return t instanceof eo&&this.key.isEqual(t.key)&&this.Vt.isEqual(t.Vt)&&this.Rt.isEqual(t.Rt)},eo.prototype.pt=function(t){var e;return e=t instanceof Io?t.data():Xr.empty(),this.yt(e)},eo.prototype.yt=function(t){var n=this,i=new Yr(t);return this.Vt.fields.forEach(function(t){if(!t.M()){var e=n.data.field(t);null!==e?i.set(t,e):i.delete(t)}}),i.gt()},eo),Hr=(n(to,Mr=Br),to.prototype.at=function(t,e){if(this.Et(t),$s(null!=e.transformResults),!this.Rt.Tt(t))return new Ao(this.key,e.version);var n=this.bt(t),i=this.vt(t,e.transformResults),r=e.version,o=this.St(n.data(),i);return new Io(this.key,r,o,{hasCommittedMutations:!0})},to.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.Tt(t))return t;var i=this.bt(t),r=this.Ct(n,t,e),o=this.St(i.data(),r);return new Io(this.key,i.version,o,{At:!0})},to.prototype.Pt=function(t){for(var e=null,n=0,i=this.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof Io?t.field(r.field):void 0,s=r.transform.ut(o||null);null!=s&&(e=null==e?(new Yr).set(r.field,s):e.set(r.field,s))}return e?e.gt():null},to.prototype.isEqual=function(t){return t instanceof to&&this.key.isEqual(t.key)&&nu(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Rt.isEqual(t.Rt)},to.prototype.bt=function(t){return t},to.prototype.vt=function(t,e){var n=[];$s(this.fieldTransforms.length===e.length);for(var i=0;i<e.length;i++){var r=this.fieldTransforms[i],o=r.transform,s=null;t instanceof Io&&(s=t.field(r.field)),n.push(o.at(s,e[i]))}return n},to.prototype.Ct=function(t,e,n){for(var i=[],r=0,o=this.fieldTransforms;r<o.length;r++){var s=o[r],u=s.transform,a=null;e instanceof Io&&(a=e.field(s.field)),null===a&&n instanceof Io&&(a=n.field(s.field)),i.push(u.ot(a,t))}return i},to.prototype.St=function(t,e){for(var n=new Yr(t),i=0;i<this.fieldTransforms.length;i++){var r=this.fieldTransforms[i].field;n.set(r,e[i])}return n.gt()},to),Wr=(n(Zr,Ur=Br),Zr.prototype.at=function(t,e){return this.Et(t),new To(this.key,e.version,{hasCommittedMutations:!0})},Zr.prototype.ot=function(t,e,n){return this.Et(t),this.Rt.Tt(t)?new To(this.key,Ui.min()):t},Zr.prototype.Pt=function(t){return null},Zr.prototype.isEqual=function(t){return t instanceof Zr&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},Zr),Qr=(n(Jr,Vr=Br),Jr.prototype.at=function(t,e){Ks()},Jr.prototype.ot=function(t,e,n){Ks()},Jr.prototype.Pt=function(t){Ks()},Jr.prototype.isEqual=function(t){return t instanceof Jr&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},Jr),Xr=($r.empty=function(){return new $r({mapValue:{}})},$r.prototype.field=function(t){if(t.M())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Tr(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.q()])||null},$r.prototype.isEqual=function(t){return cr(this.proto,t.proto)},$r),Yr=(Kr.prototype.set=function(t,e){return this.Nt(t,e),this},Kr.prototype.delete=function(t){return this.Nt(t,null),this},Kr.prototype.Nt=function(t,e){for(var n=this.Ft,i=0;i<t.length-1;++i){var r=t.get(i),o=n.get(r);o instanceof Map||(o=o&&10===hr(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(r,o)),n=o}n.set(t.q(),e)},Kr.prototype.gt=function(){var t=this.$t(Yi.H,this.Ft);return null!=t?new Xr(t):this.Dt},Kr.prototype.$t=function(i,t){var r=this,o=!1,e=this.Dt.field(i),s=Tr(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){if(t instanceof Map){var n=r.$t(i.child(e),t);null!=n&&(s[e]=n,o=!0)}else null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Kr);function Kr(t){void 0===t&&(t=Xr.empty()),this.Dt=t,this.Ft=new Map}function $r(t){this.proto=t}function Jr(t,e){var n=this;return(n=Vr.call(this)||this).key=t,n.Rt=e,n.type=4,n}function Zr(t,e){var n=this;return(n=Ur.call(this)||this).key=t,n.Rt=e,n.type=3,n}function to(t,e){var n=this;return(n=Mr.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Rt=Fr.exists(!0),n}function eo(t,e,n,i){var r=this;return(r=Cr.call(this)||this).key=t,r.data=e,r.Vt=n,r.Rt=i,r.type=1,r}function no(t,e,n){var i=this;return(i=qr.call(this)||this).key=t,i.value=e,i.Rt=n,i.type=0,i}function io(){}function ro(t,e){this.updateTime=t,this.exists=e}function oo(t,e){this.field=t,this.transform=e}function so(t){(this.fields=t).sort(Yi.N)}function uo(t){var u=[];return tr(t.fields||{},function(t,e){var n=new Yi([t]);if(Tr(e)){var i=uo(e.mapValue).fields;if(0===i.length)u.push(n);else for(var r=0,o=i;r<o.length;r++){var s=o[r];u.push(n.child(s))}}else u.push(n)}),new xr(u)}function ao(t,e){this.key=t,this.version=e}function ho(t){this.count=t}var co,fo,lo,po,yo,vo,go,mo,wo,bo,Eo,Io=(n(Yo,Eo=ao),Yo.prototype.field=function(t){return this.Lt.field(t)},Yo.prototype.data=function(){return this.Lt},Yo.prototype.Ot=function(){return this.Lt.proto},Yo.prototype.isEqual=function(t){return t instanceof Yo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.At===t.At&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Lt.isEqual(t.Lt)},Yo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Lt.toString()+", {hasLocalMutations: "+this.At+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Yo.prototype,"hasPendingWrites",{get:function(){return this.At||this.hasCommittedMutations},enumerable:!0,configurable:!0}),Yo),To=(n(Xo,bo=ao),Xo.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Xo.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),Xo.prototype.isEqual=function(t){return t instanceof Xo&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Xo),Ao=(n(Qo,wo=ao),Qo.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Qo.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),Qo.prototype.isEqual=function(t){return t instanceof Qo&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Qo),No=(Wo.prototype.canonicalId=function(){if(null===this.kt){var t=this.path.j();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map(function(t){return t.canonicalId()}).join(","),t+="|ob:",t+=this.orderBy.map(function(t){return t.canonicalId()}).join(","),rr(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.kt=t}return this.kt},Wo.prototype.toString=function(){var t=this.path.j();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),rr(this.limit)||(t+=", limit: "+this.limit),0<this.orderBy.length&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},Wo.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},Wo.prototype.qt=function(){return $i.et(this.path)&&null===this.collectionGroup&&0===this.filters.length},Wo),_o=(Ho.Wt=function(t){return new Ho(t)},Object.defineProperty(Ho.prototype,"orderBy",{get:function(){if(null===this.Bt){this.Bt=[];var t=this.jt(),e=this.Gt();if(null!==t&&null===e)t.Y()||this.Bt.push(new Vo(t)),this.Bt.push(new Vo(Yi.X(),"asc"));else{for(var n=!1,i=0,r=this.Mt;i<r.length;i++){var o=r[i];this.Bt.push(o),o.field.Y()&&(n=!0)}if(!n){var s=0<this.Mt.length?this.Mt[this.Mt.length-1].dir:"asc";this.Bt.push(new Vo(Yi.X(),s))}}}return this.Bt},enumerable:!0,configurable:!0}),Ho.prototype.Ht=function(t){var e=this.filters.concat([t]);return new Ho(this.path,this.collectionGroup,this.Mt.slice(),e,this.limit,this.xt,this.startAt,this.endAt)},Ho.prototype.Kt=function(t){var e=this.Mt.concat([t]);return new Ho(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.xt,this.startAt,this.endAt)},Ho.prototype.zt=function(t){return new Ho(this.path,this.collectionGroup,this.Mt.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},Ho.prototype.Yt=function(t){return new Ho(this.path,this.collectionGroup,this.Mt.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},Ho.prototype.Xt=function(t){return new Ho(this.path,this.collectionGroup,this.Mt.slice(),this.filters.slice(),this.limit,this.xt,t,this.endAt)},Ho.prototype.Jt=function(t){return new Ho(this.path,this.collectionGroup,this.Mt.slice(),this.filters.slice(),this.limit,this.xt,this.startAt,t)},Ho.prototype.Zt=function(t){return new Ho(t,null,this.Mt.slice(),this.filters.slice(),this.limit,this.xt,this.startAt,this.endAt)},Ho.prototype.te=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.Mt.length||1===this.Mt.length&&this.Mt[0].field.Y())},Ho.prototype.canonicalId=function(){return this.ee().canonicalId()+"|lt:"+this.xt},Ho.prototype.toString=function(){return"Query(target="+this.ee().toString()+"; limitType="+this.xt+")"},Ho.prototype.isEqual=function(t){return this.ee().isEqual(t.ee())&&this.xt===t.xt},Ho.prototype.se=function(t,e){for(var n=!1,i=0,r=this.orderBy;i<r.length;i++){var o=r[i],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.Y()}return 0},Ho.prototype.matches=function(t){return this.ie(t)&&this.ne(t)&&this.re(t)&&this.he(t)},Ho.prototype.oe=function(){return!rr(this.limit)&&"F"===this.xt},Ho.prototype.ae=function(){return!rr(this.limit)&&"L"===this.xt},Ho.prototype.Gt=function(){return 0<this.Mt.length?this.Mt[0].field:null},Ho.prototype.jt=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Ro&&n.ue())return n.field}return null},Ho.prototype.ce=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(i instanceof Ro&&0<=t.indexOf(i.op))return i.op}return null},Ho.prototype.qt=function(){return this.ee().qt()},Ho.prototype.le=function(){return null!==this.collectionGroup},Ho.prototype.ee=function(){if(!this.Ut)if("F"===this.xt)this.Ut=new No(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var i=n[e],r="desc"===i.dir?"asc":"desc";t.push(new Vo(i.field,r))}var o=this.endAt?new Po(this.endAt.position,!this.endAt.before):null,s=this.startAt?new Po(this.startAt.position,!this.startAt.before):null;this.Ut=new No(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.Ut},Ho.prototype.ie=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.tt(this.collectionGroup)&&this.path.B(e):$i.et(this.path)?this.path.isEqual(e):this.path.U(e)},Ho.prototype.ne=function(t){for(var e=0,n=this.Mt;e<n.length;e++){var i=n[e];if(!i.field.Y()&&null===t.field(i.field))return!1}return!0},Ho.prototype.re=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},Ho.prototype.he=function(t){return!(this.startAt&&!this.startAt._e(this.orderBy,t)||this.endAt&&this.endAt._e(this.orderBy,t))},Ho.prototype.Qt=function(t){},Ho),Ro=(n(zo,mo=function(){}),zo.create=function(t,e,n){if(t.Y())return"in"===e?new So(t,n):new Do(t,e,n);if(Er(n)){if("=="!==e)throw new Si(Di.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new zo(t,e,n)}if(Ir(n)){if("=="!==e)throw new Si(Di.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new zo(t,e,n)}return"array-contains"===e?new Oo(t,n):"in"===e?new ko(t,n):"array-contains-any"===e?new Lo(t,n):new zo(t,e,n)},zo.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&hr(this.value)===hr(e)&&this.fe(lr(e,this.value))},zo.prototype.fe=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Ks()}},zo.prototype.ue=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},zo.prototype.canonicalId=function(){return this.field.j()+this.op.toString()+dr(this.value)},zo.prototype.isEqual=function(t){return t instanceof zo&&this.op===t.op&&this.field.isEqual(t.field)&&cr(this.value,t.value)},zo.prototype.toString=function(){return this.field.j()+" "+this.op+" "+dr(this.value)},zo),Do=(n(Go,go=Ro),Go.prototype.matches=function(t){var e=$i.N(t.key,this.key);return this.fe(e)},Go),So=(n(Bo,vo=Ro),Bo.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Bo),Oo=(n(Fo,yo=Ro),Fo.prototype.matches=function(t){var e=t.field(this.field);return br(e)&&fr(e.arrayValue,this.value)},Fo),ko=(n(jo,po=Ro),jo.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&fr(this.value.arrayValue,e)},jo),Lo=(n(xo,lo=Ro),xo.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!br(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return fr(e.value.arrayValue,t)})},xo),Po=(qo.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map(function(t){return dr(t)}).join(",")},qo.prototype._e=function(t,e){for(var n=0,i=0;i<this.position.length;i++){var r=t[i],o=this.position[i];if(n=r.field.Y()?$i.N($i.Z(o.referenceValue),e.key):lr(o,e.field(r.field)),"desc"===r.dir&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},qo.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!cr(this.position[e],t.position[e]))return!1;return!0},qo),Vo=(Co.prototype.compare=function(t,e){var n,i,r,o,s=this.de?$i.N(t.key,e.key):(n=this.field,i=e,r=t.field(n),o=i.field(n),null!==r&&null!==o?lr(r,o):Ks());switch(this.dir){case"asc":return s;case"desc":return-1*s;default:return Ks()}},Co.prototype.canonicalId=function(){return this.field.j()+this.dir.toString()},Co.prototype.toString=function(){return this.field.j()+" ("+this.dir+")"},Co.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},Co),Uo=(Mo.prototype.Ee=function(t){return new Mo(this.target,this.targetId,this.we,t,this.Te,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Mo.prototype.Ie=function(t,e){return new Mo(this.target,this.targetId,this.we,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Mo.prototype.me=function(t){return new Mo(this.target,this.targetId,this.we,this.sequenceNumber,this.Te,t,this.resumeToken)},Mo);function Mo(t,e,n,i,r,o,s){void 0===r&&(r=Ui.min()),void 0===o&&(o=Ui.min()),void 0===s&&(s=nr.ht),this.target=t,this.targetId=e,this.we=n,this.sequenceNumber=i,this.Te=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Co(t,e){this.field=t,void 0===e&&(e="asc"),this.dir=e,this.de=t.Y()}function qo(t,e){this.position=t,this.before=e}function xo(t,e){return lo.call(this,t,"array-contains-any",e)||this}function jo(t,e){return po.call(this,t,"in",e)||this}function Fo(t,e){return yo.call(this,t,"array-contains",e)||this}function Bo(t,e){var n=this;return(n=vo.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return $i.Z(t.referenceValue)}),n}function Go(t,e,n){var i=this;return(i=go.call(this,t,e,n)||this).key=$i.Z(n.referenceValue),i}function zo(t,e,n){var i=this;return(i=mo.call(this)||this).field=t,i.op=e,i.value=n,i}function Ho(t,e,n,i,r,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Mt=n,this.filters=i,this.limit=r,this.xt=o,this.startAt=s,this.endAt=u,this.Bt=null,this.Ut=null,this.startAt&&this.Qt(this.startAt),this.endAt&&this.Qt(this.endAt)}function Wo(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.kt=null}function Qo(){return null!==wo&&wo.apply(this,arguments)||this}function Xo(t,e,n){var i=this;return(i=bo.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function Yo(t,e,n,i){var r=this;return(r=Eo.call(this,t,e)||this).Lt=n,r.At=!!i.At,r.hasCommittedMutations=!!i.hasCommittedMutations,r}function Ko(t){switch(t){case Di.OK:return Ks();case Di.CANCELLED:case Di.UNKNOWN:case Di.DEADLINE_EXCEEDED:case Di.RESOURCE_EXHAUSTED:case Di.INTERNAL:case Di.UNAVAILABLE:case Di.UNAUTHENTICATED:return;case Di.INVALID_ARGUMENT:case Di.NOT_FOUND:case Di.ALREADY_EXISTS:case Di.PERMISSION_DENIED:case Di.FAILED_PRECONDITION:case Di.ABORTED:case Di.OUT_OF_RANGE:case Di.UNIMPLEMENTED:case Di.DATA_LOSS:return 1;default:return Ks()}}function $o(t){if(void 0===t)return Xs("GRPC error has no .code"),Di.UNKNOWN;switch(t){case co.OK:return Di.OK;case co.CANCELLED:return Di.CANCELLED;case co.UNKNOWN:return Di.UNKNOWN;case co.DEADLINE_EXCEEDED:return Di.DEADLINE_EXCEEDED;case co.RESOURCE_EXHAUSTED:return Di.RESOURCE_EXHAUSTED;case co.INTERNAL:return Di.INTERNAL;case co.UNAVAILABLE:return Di.UNAVAILABLE;case co.UNAUTHENTICATED:return Di.UNAUTHENTICATED;case co.INVALID_ARGUMENT:return Di.INVALID_ARGUMENT;case co.NOT_FOUND:return Di.NOT_FOUND;case co.ALREADY_EXISTS:return Di.ALREADY_EXISTS;case co.PERMISSION_DENIED:return Di.PERMISSION_DENIED;case co.FAILED_PRECONDITION:return Di.FAILED_PRECONDITION;case co.ABORTED:return Di.ABORTED;case co.OUT_OF_RANGE:return Di.OUT_OF_RANGE;case co.UNIMPLEMENTED:return Di.UNIMPLEMENTED;case co.DATA_LOSS:return Di.DATA_LOSS;default:return Ks()}}(fo=co=co||{})[fo.OK=0]="OK",fo[fo.CANCELLED=1]="CANCELLED",fo[fo.UNKNOWN=2]="UNKNOWN",fo[fo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",fo[fo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",fo[fo.NOT_FOUND=5]="NOT_FOUND",fo[fo.ALREADY_EXISTS=6]="ALREADY_EXISTS",fo[fo.PERMISSION_DENIED=7]="PERMISSION_DENIED",fo[fo.UNAUTHENTICATED=16]="UNAUTHENTICATED",fo[fo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",fo[fo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",fo[fo.ABORTED=10]="ABORTED",fo[fo.OUT_OF_RANGE=11]="OUT_OF_RANGE",fo[fo.UNIMPLEMENTED=12]="UNIMPLEMENTED",fo[fo.INTERNAL=13]="INTERNAL",fo[fo.UNAVAILABLE=14]="UNAVAILABLE",fo[fo.DATA_LOSS=15]="DATA_LOSS";var Jo=(is.prototype.Re=function(t,e){return new is(this.N,this.root.Re(t,e,this.N).Ae(null,null,ts.Pe,null,null))},is.prototype.remove=function(t){return new is(this.N,this.root.remove(t,this.N).Ae(null,null,ts.Pe,null,null))},is.prototype.get=function(t){for(var e=this.root;!e.M();){var n=this.N(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},is.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.M();){var i=this.N(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},is.prototype.M=function(){return this.root.M()},Object.defineProperty(is.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),is.prototype.Ve=function(){return this.root.Ve()},is.prototype.pe=function(){return this.root.pe()},is.prototype.ye=function(t){return this.root.ye(t)},is.prototype.forEach=function(n){this.ye(function(t,e){return n(t,e),!1})},is.prototype.toString=function(){var n=[];return this.ye(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},is.prototype.ge=function(t){return this.root.ge(t)},is.prototype.be=function(){return new Zo(this.root,null,this.N,!1)},is.prototype.ve=function(t){return new Zo(this.root,t,this.N,!1)},is.prototype.Se=function(){return new Zo(this.root,null,this.N,!0)},is.prototype.Ce=function(t){return new Zo(this.root,t,this.N,!0)},is),Zo=(ns.prototype.Ne=function(){var t=this.Fe.pop(),e={key:t.key,value:t.value};if(this.De)for(t=t.left;!t.M();)this.Fe.push(t),t=t.right;else for(t=t.right;!t.M();)this.Fe.push(t),t=t.left;return e},ns.prototype.$e=function(){return 0<this.Fe.length},ns.prototype.Le=function(){if(0===this.Fe.length)return null;var t=this.Fe[this.Fe.length-1];return{key:t.key,value:t.value}},ns),ts=(es.prototype.Ae=function(t,e,n,i,r){return new es(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},es.prototype.M=function(){return!1},es.prototype.ye=function(t){return this.left.ye(t)||t(this.key,this.value)||this.right.ye(t)},es.prototype.ge=function(t){return this.right.ge(t)||t(this.key,this.value)||this.left.ge(t)},es.prototype.min=function(){return this.left.M()?this:this.left.min()},es.prototype.Ve=function(){return this.min().key},es.prototype.pe=function(){return this.right.M()?this.key:this.right.pe()},es.prototype.Re=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.Ae(null,null,null,i.left.Re(t,e,n),null):0===r?i.Ae(null,e,null,null,null):i.Ae(null,null,null,null,i.right.Re(t,e,n))).Oe()},es.prototype.ke=function(){if(this.left.M())return es.EMPTY;var t=this;return t.left.qe()||t.left.left.qe()||(t=t.Me()),(t=t.Ae(null,null,null,t.left.ke(),null)).Oe()},es.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left.M()||i.left.qe()||i.left.left.qe()||(i=i.Me()),i=i.Ae(null,null,null,i.left.remove(t,e),null);else{if(i.left.qe()&&(i=i.xe()),i.right.M()||i.right.qe()||i.right.left.qe()||(i=i.Be()),0===e(t,i.key)){if(i.right.M())return es.EMPTY;n=i.right.min(),i=i.Ae(n.key,n.value,null,null,i.right.ke())}i=i.Ae(null,null,null,null,i.right.remove(t,e))}return i.Oe()},es.prototype.qe=function(){return this.color},es.prototype.Oe=function(){var t=this;return t.right.qe()&&!t.left.qe()&&(t=t.Ue()),t.left.qe()&&t.left.left.qe()&&(t=t.xe()),t.left.qe()&&t.right.qe()&&(t=t.Qe()),t},es.prototype.Me=function(){var t=this.Qe();return t.right.left.qe()&&(t=(t=(t=t.Ae(null,null,null,null,t.right.xe())).Ue()).Qe()),t},es.prototype.Be=function(){var t=this.Qe();return t.left.left.qe()&&(t=(t=t.xe()).Qe()),t},es.prototype.Ue=function(){var t=this.Ae(null,null,es.RED,null,this.right.left);return this.right.Ae(null,null,this.color,t,null)},es.prototype.xe=function(){var t=this.Ae(null,null,es.RED,this.left.right,null);return this.left.Ae(null,null,this.color,null,t)},es.prototype.Qe=function(){var t=this.left.Ae(null,null,!this.left.color,null,null),e=this.right.Ae(null,null,!this.right.color,null,null);return this.Ae(null,null,!this.color,t,e)},es.prototype.We=function(){var t=this.je();return Math.pow(2,t)<=this.size+1},es.prototype.je=function(){if(this.qe()&&this.left.qe())throw Ks();if(this.right.qe())throw Ks();var t=this.left.je();if(t!==this.right.je())throw Ks();return t+(this.qe()?0:1)},es);function es(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:es.RED,this.left=null!=i?i:es.EMPTY,this.right=null!=r?r:es.EMPTY,this.size=this.left.size+1+this.right.size}function ns(t,e,n,i){this.De=i,this.Fe=[];for(var r=1;!t.M();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.De?t.left:t.right;else{if(0===r){this.Fe.push(t);break}this.Fe.push(t),t=this.De?t.right:t.left}}function is(t,e){this.N=t,this.root=e||ts.EMPTY}function rs(){this.size=0}ts.EMPTY=null,ts.RED=!0,ts.Pe=!1,ts.EMPTY=(Object.defineProperty(rs.prototype,"key",{get:function(){throw Ks()},enumerable:!0,configurable:!0}),Object.defineProperty(rs.prototype,"value",{get:function(){throw Ks()},enumerable:!0,configurable:!0}),Object.defineProperty(rs.prototype,"color",{get:function(){throw Ks()},enumerable:!0,configurable:!0}),Object.defineProperty(rs.prototype,"left",{get:function(){throw Ks()},enumerable:!0,configurable:!0}),Object.defineProperty(rs.prototype,"right",{get:function(){throw Ks()},enumerable:!0,configurable:!0}),rs.prototype.Ae=function(t,e,n,i,r){return this},rs.prototype.Re=function(t,e,n){return new ts(t,e)},rs.prototype.remove=function(t,e){return this},rs.prototype.M=function(){return!0},rs.prototype.ye=function(t){return!1},rs.prototype.ge=function(t){return!1},rs.prototype.Ve=function(){return null},rs.prototype.pe=function(){return null},rs.prototype.qe=function(){return!1},rs.prototype.We=function(){return!0},rs.prototype.je=function(){return 0},new rs);var os=(hs.prototype.has=function(t){return null!==this.data.get(t)},hs.prototype.first=function(){return this.data.Ve()},hs.prototype.last=function(){return this.data.pe()},Object.defineProperty(hs.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),hs.prototype.indexOf=function(t){return this.data.indexOf(t)},hs.prototype.forEach=function(n){this.data.ye(function(t,e){return n(t),!1})},hs.prototype.Ge=function(t,e){for(var n=this.data.ve(t[0]);n.$e();){var i=n.Ne();if(0<=this.N(i.key,t[1]))return;e(i.key)}},hs.prototype.He=function(t,e){var n;for(n=void 0!==e?this.data.ve(e):this.data.be();n.$e();)if(!t(n.Ne().key))return},hs.prototype.Ke=function(t){var e=this.data.ve(t);return e.$e()?e.Ne().key:null},hs.prototype.be=function(){return new ss(this.data.be())},hs.prototype.ve=function(t){return new ss(this.data.ve(t))},hs.prototype.add=function(t){return this.Ae(this.data.remove(t).Re(t,!0))},hs.prototype.delete=function(t){return this.has(t)?this.Ae(this.data.remove(t)):this},hs.prototype.M=function(){return this.data.M()},hs.prototype.ze=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},hs.prototype.isEqual=function(t){if(!(t instanceof hs))return!1;if(this.size!==t.size)return!1;for(var e=this.data.be(),n=t.data.be();e.$e();){var i=e.Ne().key,r=n.Ne().key;if(0!==this.N(i,r))return!1}return!0},hs.prototype.W=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},hs.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},hs.prototype.Ae=function(t){var e=new hs(this.N);return e.data=t,e},hs),ss=(as.prototype.Ne=function(){return this.Ye.Ne().key},as.prototype.$e=function(){return this.Ye.$e()},as),us=new Jo($i.N);function as(t){this.Ye=t}function hs(t){this.N=t,this.data=new Jo(this.N)}function cs(){return us}function fs(){return cs()}var ls=new Jo($i.N);function ps(){return ls}var ds=new Jo($i.N),ys=new os($i.N);function vs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ys,i=0,r=t;i<r.length;i++){var o=r[i];n=n.add(o)}return n}var gs=new os(eu);function ms(){return gs}function ws(t,e,n,i){this.Is=t,this.removedTargetIds=e,this.key=n,this.ms=i}function bs(t,e){this.targetId=t,this.Rs=e}function Es(t,e,n,i){void 0===n&&(n=nr.ht),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var Is=(Us.Ze=function(t){return new Us(t.N)},Us.prototype.has=function(t){return null!=this.Xe.get(t)},Us.prototype.get=function(t){return this.Xe.get(t)},Us.prototype.first=function(){return this.Je.Ve()},Us.prototype.last=function(){return this.Je.pe()},Us.prototype.M=function(){return this.Je.M()},Us.prototype.indexOf=function(t){var e=this.Xe.get(t);return e?this.Je.indexOf(e):-1},Object.defineProperty(Us.prototype,"size",{get:function(){return this.Je.size},enumerable:!0,configurable:!0}),Us.prototype.forEach=function(n){this.Je.ye(function(t,e){return n(t),!1})},Us.prototype.add=function(t){var e=this.delete(t.key);return e.Ae(e.Xe.Re(t.key,t),e.Je.Re(t,null))},Us.prototype.delete=function(t){var e=this.get(t);return e?this.Ae(this.Xe.remove(t),this.Je.remove(e)):this},Us.prototype.isEqual=function(t){if(!(t instanceof Us))return!1;if(this.size!==t.size)return!1;for(var e=this.Je.be(),n=t.Je.be();e.$e();){var i=e.Ne().key,r=n.Ne().key;if(!i.isEqual(r))return!1}return!0},Us.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Us.prototype.Ae=function(t,e){var n=new Us;return n.N=this.N,n.Xe=t,n.Je=e,n},Us),Ts=(Vs.prototype.track=function(t){var e=t.doc.key,n=this.ts.get(e);!n||0!==t.type&&3===n.type?this.ts=this.ts.Re(e,t):3===t.type&&1!==n.type?this.ts=this.ts.Re(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ts=this.ts.Re(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ts=this.ts.Re(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ts=this.ts.remove(e):1===t.type&&2===n.type?this.ts=this.ts.Re(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ts=this.ts.Re(e,{type:2,doc:t.doc}):Ks()},Vs.prototype.es=function(){var n=[];return this.ts.ye(function(t,e){n.push(e)}),n},Vs),As=(Ps.os=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new Ps(t,e,Is.Ze(e),r,n,i,!0,!1)},Object.defineProperty(Ps.prototype,"hasPendingWrites",{get:function(){return!this.ns.M()},enumerable:!0,configurable:!0}),Ps.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.rs===t.rs&&this.ns.isEqual(t.ns)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.ss.isEqual(t.ss)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},Ps),Ns=(Ls._s=function(t,e){var n=new Map;return n.set(t,_s.fs(t,e)),new Ls(Ui.min(),n,ms(),cs(),vs())},Ls),_s=(ks.fs=function(t,e){return new ks(nr.ht,e,vs(),vs(),vs())},ks),Rs=(Object.defineProperty(Os.prototype,"ds",{get:function(){return this.ps},enumerable:!0,configurable:!0}),Object.defineProperty(Os.prototype,"resumeToken",{get:function(){return this.Vs},enumerable:!0,configurable:!0}),Object.defineProperty(Os.prototype,"gs",{get:function(){return 0!==this.As},enumerable:!0,configurable:!0}),Object.defineProperty(Os.prototype,"bs",{get:function(){return this.ys},enumerable:!0,configurable:!0}),Os.prototype.vs=function(t){0<t.rt()&&(this.ys=!0,this.Vs=t)},Os.prototype.Ss=function(){var n=vs(),i=vs(),r=vs();return this.Ps.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:Ks()}}),new _s(this.Vs,this.ps,n,i,r)},Os.prototype.Cs=function(){this.ys=!1,this.Ps=Cs()},Os.prototype.Ds=function(t,e){this.ys=!0,this.Ps=this.Ps.Re(t,e)},Os.prototype.Fs=function(t){this.ys=!0,this.Ps=this.Ps.remove(t)},Os.prototype.Ns=function(){this.As+=1},Os.prototype.$s=function(){--this.As},Os.prototype.Ls=function(){this.ys=!0,this.ps=!0},Os),Ds=(Ss.prototype.Bs=function(t){for(var e=0,n=t.Is;e<n.length;e++){var i=n[e];t.ms instanceof Io?this.Us(i,t.ms):t.ms instanceof To&&this.Qs(i,t.key,t.ms)}for(var r=0,o=t.removedTargetIds;r<o.length;r++){var s=o[r];this.Qs(s,t.key,t.ms)}},Ss.prototype.Ws=function(n){var i=this;this.js(n,function(t){var e=i.Gs(t);switch(n.state){case 0:i.Hs(t)&&e.vs(n.resumeToken);break;case 1:e.$s(),e.gs||e.Cs(),e.vs(n.resumeToken);break;case 2:e.$s(),e.gs||i.removeTarget(t);break;case 3:i.Hs(t)&&(e.Ls(),e.vs(n.resumeToken));break;case 4:i.Hs(t)&&(i.Ks(t),e.vs(n.resumeToken));break;default:Ks()}})},Ss.prototype.js=function(t,n){var i=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ks.forEach(function(t,e){i.Hs(e)&&n(e)})},Ss.prototype.zs=function(t){var e=t.targetId,n=t.Rs.count,i=this.Ys(e);if(i){var r=i.target;if(r.qt())if(0===n){var o=new $i(r.path);this.Qs(e,o,new To(o,Ui.min()))}else $s(1===n);else this.Xs(e)!==n&&(this.Ks(e),this.xs=this.xs.add(e))}},Ss.prototype.Js=function(r){var o=this,s=new Map;this.ks.forEach(function(t,e){var n=o.Ys(e);if(n){if(t.ds&&n.target.qt()){var i=new $i(n.target.path);null!==o.qs.get(i)||o.Zs(e,i)||o.Qs(e,i,new To(i,r))}t.bs&&(s.set(e,t.Ss()),t.Cs())}});var i=vs();this.Ms.forEach(function(t,e){var n=!0;e.He(function(t){var e=o.Ys(t);return!e||2===e.we||(n=!1)}),n&&(i=i.add(t))});var t=new Ns(r,s,this.xs,this.qs,i);return this.qs=cs(),this.Ms=Ms(),this.xs=new os(eu),t},Ss.prototype.Us=function(t,e){if(this.Hs(t)){var n=this.Zs(t,e.key)?2:0;this.Gs(t).Ds(e.key,n),this.qs=this.qs.Re(e.key,e),this.Ms=this.Ms.Re(e.key,this.ti(e.key).add(t))}},Ss.prototype.Qs=function(t,e,n){if(this.Hs(t)){var i=this.Gs(t);this.Zs(t,e)?i.Ds(e,1):i.Fs(e),this.Ms=this.Ms.Re(e,this.ti(e).delete(t)),n&&(this.qs=this.qs.Re(e,n))}},Ss.prototype.removeTarget=function(t){this.ks.delete(t)},Ss.prototype.Xs=function(t){var e=this.Gs(t).Ss();return this.Os.ei(t).size+e.ws.size-e.Es.size},Ss.prototype.Ns=function(t){this.Gs(t).Ns()},Ss.prototype.Gs=function(t){var e=this.ks.get(t);return e||(e=new Rs,this.ks.set(t,e)),e},Ss.prototype.ti=function(t){var e=this.Ms.get(t);return e||(e=new os(eu),this.Ms=this.Ms.Re(t,e)),e},Ss.prototype.Hs=function(t){var e=null!==this.Ys(t);return e||Qs("WatchChangeAggregator","Detected inactive target",t),e},Ss.prototype.Ys=function(t){var e=this.ks.get(t);return e&&e.gs?null:this.Os.si(t)},Ss.prototype.Ks=function(e){var n=this;this.ks.set(e,new Rs),this.Os.ei(e).forEach(function(t){n.Qs(e,t,null)})},Ss.prototype.Zs=function(t,e){return this.Os.ei(t).has(e)},Ss);function Ss(t){this.Os=t,this.ks=new Map,this.qs=cs(),this.Ms=Ms(),this.xs=new os(eu)}function Os(){this.As=0,this.Ps=Cs(),this.Vs=nr.ht,this.ps=!1,this.ys=!0}function ks(t,e,n,i,r){this.resumeToken=t,this.ds=e,this.ws=n,this.Ts=i,this.Es=r}function Ls(t,e,n,i,r){this.Te=t,this.as=e,this.us=n,this.cs=i,this.ls=r}function Ps(t,e,n,i,r,o,s,u){this.query=t,this.docs=e,this.ss=n,this.docChanges=i,this.ns=r,this.fromCache=o,this.rs=s,this.hs=u}function Vs(){this.ts=new Jo($i.N)}function Us(n){this.N=n?function(t,e){return n(t,e)||$i.N(t.key,e.key)}:function(t,e){return $i.N(t.key,e.key)},this.Xe=ps(),this.Je=new Jo(this.N)}function Ms(){return new Jo($i.N)}function Cs(){return new Jo($i.N)}var qs={asc:"ASCENDING",desc:"DESCENDING"},xs={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},js=(Fs.prototype.ni=function(t){var e=void 0===t.code?Di.UNKNOWN:$o(t.code);return new Si(e,t.message||"")},Fs.prototype.ri=function(t){return this.options.hi||rr(t)?t:{value:t}},Fs.prototype.oi=function(t){var e;return rr(e="object"==typeof t?t.value:t)?null:e},Fs.prototype.lt=function(t){return{integerValue:""+t}},Fs.prototype._t=function(t){if(this.options.hi){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:or(t)?"-0":t}},Fs.prototype.ai=function(t){return"number"==typeof(e=t)&&Number.isInteger(e)&&!or(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER?this.lt(t):this._t(t);var e},Fs.prototype.D=function(t){return this.options.hi?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},Fs.prototype.v=function(t){var e=yr(t);return new Vi(e.seconds,e.nanos)},Fs.prototype.ui=function(t){return this.options.hi?t.toBase64():t.toUint8Array()},Fs.prototype.ci=function(t){return this.options.hi?($s(void 0===t||"string"==typeof t),nr.fromBase64String(t||"")):($s(void 0===t||t instanceof Uint8Array),nr.fromUint8Array(t||new Uint8Array))},Fs.prototype.toVersion=function(t){return this.D(t.D())},Fs.prototype.fromVersion=function(t){return $s(!!t),Ui.v(this.v(t))},Fs.prototype.li=function(t,e){return this._i(e||this.ii).child("documents").child(t).j()},Fs.prototype.fi=function(t){var e=Ci.G(t);return $s(Bs(e)),e},Fs.prototype.di=function(t){return this.li(t.path)},Fs.prototype.Z=function(t){var e=this.fi(t);return $s(e.get(1)===this.ii.projectId),$s(!e.get(3)&&!this.ii.database||e.get(3)===this.ii.database),new $i(this.wi(e))},Fs.prototype.Ti=function(t){return this.li(t)},Fs.prototype.Ei=function(t){var e=this.fi(t);return 4===e.length?Ci.H:this.wi(e)},Object.defineProperty(Fs.prototype,"Ii",{get:function(){return new Ci(["projects",this.ii.projectId,"databases",this.ii.database]).j()},enumerable:!0,configurable:!0}),Fs.prototype._i=function(t){return new Ci(["projects",t.projectId,"databases",t.database])},Fs.prototype.wi=function(t){return $s(4<t.length&&"documents"===t.get(4)),t.L(5)},Fs.prototype.mi=function(t,e){return{name:this.di(t),fields:e.proto.mapValue.fields}},Fs.prototype.Ri=function(t){return{name:this.di(t.key),fields:t.Ot().mapValue.fields,updateTime:this.D(t.version.D())}},Fs.prototype.Ai=function(t,e){var n=this.Z(t.name),i=this.fromVersion(t.updateTime),r=new Xr({mapValue:{fields:t.fields}});return new Io(n,i,r,{hasCommittedMutations:!!e})},Fs.prototype.Pi=function(t){$s(!!t.found),t.found.name,t.found.updateTime;var e=this.Z(t.found.name),n=this.fromVersion(t.found.updateTime),i=new Xr({mapValue:{fields:t.found.fields}});return new Io(e,n,i,{})},Fs.prototype.Vi=function(t){$s(!!t.missing),$s(!!t.readTime);var e=this.Z(t.missing),n=this.fromVersion(t.readTime);return new To(e,n)},Fs.prototype.pi=function(t){return"found"in t?this.Pi(t):"missing"in t?this.Vi(t):Ks()},Fs.prototype.yi=function(t){var e;if("targetChange"in t){t.targetChange;var n=this.gi(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],r=this.ci(t.targetChange.resumeToken),o=t.targetChange.cause,s=o&&this.ni(o);e=new Es(n,i,r,s||null)}else if("documentChange"in t){t.documentChange;var u=t.documentChange;u.document,u.document.name,u.document.updateTime;var a=this.Z(u.document.name),h=this.fromVersion(u.document.updateTime),c=new Xr({mapValue:{fields:u.document.fields}}),f=new Io(a,h,c,{}),l=u.targetIds||[],p=u.removedTargetIds||[];e=new ws(l,p,f.key,f)}else if("documentDelete"in t){t.documentDelete;var d=t.documentDelete;d.document;var y=this.Z(d.document),v=d.readTime?this.fromVersion(d.readTime):Ui.min(),g=new To(y,v),m=d.removedTargetIds||[];e=new ws([],m,g.key,g)}else if("documentRemove"in t){t.documentRemove;var w=t.documentRemove;w.document;var b=this.Z(w.document),E=w.removedTargetIds||[];e=new ws([],E,b,null)}else{if(!("filter"in t))return Ks();t.filter;var I=t.filter;I.targetId;var T=I.count||0,A=new ho(T),N=I.targetId;e=new bs(N,A)}return e},Fs.prototype.gi=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Ks()},Fs.prototype.bi=function(t){if(!("targetChange"in t))return Ui.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Ui.min():this.fromVersion(e.readTime)},Fs.prototype.vi=function(t){var e,n=this;if(t instanceof Gr)e={update:this.mi(t.key,t.value)};else if(t instanceof Wr)e={delete:this.di(t.key)};else if(t instanceof zr)e={update:this.mi(t.key,t.data),updateMask:this.Si(t.Vt)};else if(t instanceof Hr)e={transform:{document:this.di(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.Ci(t)})}};else{if(!(t instanceof Qr))return Ks();e={verify:this.di(t.key)}}return t.Rt.wt||(e.currentDocument=this.Di(t.Rt)),e},Fs.prototype.Fi=function(t){var e=this,n=t.currentDocument?this.Ni(t.currentDocument):Fr.dt();if(t.update){t.update.name;var i=this.Z(t.update.name),r=new Xr({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.$i(t.updateMask);return new zr(i,r,o,n)}return new Gr(i,r,n)}if(t.delete){var s=this.Z(t.delete);return new Wr(s,n)}if(t.transform){var u=this.Z(t.transform.document),a=t.transform.fieldTransforms.map(function(t){return e.Li(t)});return $s(!0===n.exists),new Hr(u,a)}if(t.verify){var h=this.Z(t.verify);return new Qr(h,n)}return Ks()},Fs.prototype.Di=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Ks()},Fs.prototype.Ni=function(t){return void 0!==t.updateTime?Fr.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?Fr.exists(t.exists):Fr.dt()},Fs.prototype.Oi=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(Ui.min())&&(n=this.fromVersion(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults),new Pr(n,i)},Fs.prototype.ki=function(t,e){var n=this;return t&&0<t.length?($s(void 0!==e),t.map(function(t){return n.Oi(t,e)})):[]},Fs.prototype.Ci=function(t){var e=t.transform;if(e instanceof Ar)return{fieldPath:t.field.j(),setToServerValue:"REQUEST_TIME"};if(e instanceof _r)return{fieldPath:t.field.j(),appendMissingElements:{values:e.elements}};if(e instanceof Rr)return{fieldPath:t.field.j(),removeAllFromArray:{values:e.elements}};if(e instanceof Dr)return{fieldPath:t.field.j(),increment:e.ct};throw Ks()},Fs.prototype.Li=function(t){var e=null;if("setToServerValue"in t)$s("REQUEST_TIME"===t.setToServerValue),e=Ar.instance;else if("appendMissingElements"in t){var n=t.appendMissingElements.values||[];e=new _r(n)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];e=new Rr(i)}else"increment"in t?e=new Dr(this,t.increment):Ks();var r=Yi.J(t.fieldPath);return new jr(r,e)},Fs.prototype.qi=function(t){return{documents:[this.Ti(t.path)]}},Fs.prototype.Mi=function(t){$s(1===t.documents.length);var e=t.documents[0];return _o.Wt(this.Ei(e)).ee()},Fs.prototype.xi=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.Ti(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.Ti(n.O()),e.structuredQuery.from=[{collectionId:n.q()}]);var i=this.Bi(t.filters);i&&(e.structuredQuery.where=i);var r=this.Ui(t.orderBy);r&&(e.structuredQuery.orderBy=r);var o=this.ri(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Qi(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Qi(t.endAt)),e},Fs.prototype.Wi=function(t){var e=this.Ei(t.parent),n=t.structuredQuery,i=n.from?n.from.length:0,r=null;if(0<i){$s(1===i);var o=n.from[0];o.allDescendants?r=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.ji(n.where));var u=[];n.orderBy&&(u=this.Gi(n.orderBy));var a=null;n.limit&&(a=this.oi(n.limit));var h=null;n.startAt&&(h=this.Hi(n.startAt));var c=null;return n.endAt&&(c=this.Hi(n.endAt)),new _o(e,r,u,s,a,"F",h,c).ee()},Fs.prototype.Ki=function(t){var e=this.zi(t.we);return null==e?null:{"goog-listen-tags":e}},Fs.prototype.zi=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ks()}},Fs.prototype.ee=function(t){var e,n=t.target;return(e=n.qt()?{documents:this.qi(n)}:{query:this.xi(n)}).targetId=t.targetId,0<t.resumeToken.rt()&&(e.resumeToken=this.ui(t.resumeToken)),e},Fs.prototype.Bi=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof Ro?e.Yi(t):Ks()});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},Fs.prototype.ji=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.Xi(t)]:void 0!==t.fieldFilter?[this.Ji(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.ji(t)}).reduce(function(t,e){return t.concat(e)}):Ks():[]},Fs.prototype.Ui=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.Zi(t)})},Fs.prototype.Gi=function(t){var e=this;return t.map(function(t){return e.tn(t)})},Fs.prototype.Qi=function(t){return{before:t.before,values:t.position}},Fs.prototype.Hi=function(t){var e=!!t.before,n=t.values||[];return new Po(n,e)},Fs.prototype.en=function(t){return qs[t]},Fs.prototype.sn=function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}},Fs.prototype.nn=function(t){return xs[t]},Fs.prototype.rn=function(t){switch(t){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Ks()}},Fs.prototype.hn=function(t){return{fieldPath:t.j()}},Fs.prototype.on=function(t){return Yi.J(t.fieldPath)},Fs.prototype.Zi=function(t){return{field:this.hn(t.field),direction:this.en(t.dir)}},Fs.prototype.tn=function(t){return new Vo(this.on(t.field),this.sn(t.direction))},Fs.prototype.Ji=function(t){return Ro.create(this.on(t.fieldFilter.field),this.rn(t.fieldFilter.op),t.fieldFilter.value)},Fs.prototype.Yi=function(t){if("=="===t.op){if(Ir(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NAN"}};if(Er(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.hn(t.field),op:this.nn(t.op),value:t.value}}},Fs.prototype.Xi=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.on(t.unaryFilter.field);return Ro.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=this.on(t.unaryFilter.field);return Ro.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Ks()}},Fs.prototype.Si=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.j())}),{fieldPaths:e}},Fs.prototype.$i=function(t){var e=t.fieldPaths||[];return new xr(e.map(function(t){return Yi.J(t)}))},Fs);function Fs(t,e){this.ii=t,this.options=e}function Bs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var Gs=(Hs.an=function(t){Hs.platform&&Ks(),Hs.platform=t},Hs.nt=function(){return Hs.platform||Ks(),Hs.platform},Hs),zs=new h("@firebase/firestore");function Hs(){}function Ws(){return zs.logLevel}function Qs(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(zs.logLevel<=p.DEBUG){var i=e.map(Ys);zs.debug.apply(zs,v(["Firestore ("+Ii+"): "+t],i))}}function Xs(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(zs.logLevel<=p.ERROR){var i=e.map(Ys);zs.error.apply(zs,v(["Firestore ("+Ii+"): "+t],i))}}function Ys(t){if("string"==typeof t)return t;var e=Gs.nt();try{return e.un(t)}catch(e){return t}}function Ks(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+Ii+") INTERNAL ASSERTION FAILED: "+t;throw Xs(e),new Error(e)}function $s(t){t||Ks()}function Js(t){return t}var Zs=(tu.cn=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var i=Gs.nt().ln(40),r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length));return n},tu);function tu(){}function eu(t,e){return t<e?-1:e<t?1:0}function nu(t,n,i){return t.length===n.length&&t.every(function(t,e){return i(t,n[e])})}function iu(t,e,n,i,r){this.ii=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}var ru=(Object.defineProperty(wu.prototype,"_n",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),wu.prototype.isEqual=function(t){return t instanceof wu&&t.projectId===this.projectId&&t.database===this.database},wu.prototype.S=function(t){return eu(this.projectId,t.projectId)||eu(this.database,t.database)},wu),ou=(mu.prototype.get=function(t){var e=this.fn(t),n=this.dn[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],u=o[1];if(s.isEqual(t))return u}},mu.prototype.has=function(t){return void 0!==this.get(t)},mu.prototype.set=function(t,e){var n=this.fn(t),i=this.dn[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(i[r][0].isEqual(t))return void(i[r]=[t,e]);i.push([t,e])}else this.dn[n]=[[t,e]]},mu.prototype.delete=function(t){var e=this.fn(t),n=this.dn[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(n[i][0].isEqual(t))return 1===n.length?delete this.dn[e]:n.splice(i,1),!0;return!1},mu.prototype.forEach=function(u){tr(this.dn,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];u(o,s)}})},mu.prototype.M=function(){return er(this.dn)},mu),su=(gu.prototype.at=function(t,e,n){for(var i=n.Tn,r=0;r<this.mutations.length;r++){var o=this.mutations[r];if(o.key.isEqual(t)){var s=i[r];e=o.at(e,s)}}return e},gu.prototype.ot=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++){var r=i[n];r.key.isEqual(t)&&(e=r.ot(e,e,this.wn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=a.ot(e,o,this.wn))}return e},gu.prototype.En=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.ot(t.key,n.get(t.key));e&&(r=r.Re(t.key,e))}),r},gu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},vs())},gu.prototype.isEqual=function(t){return this.batchId===t.batchId&&nu(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&nu(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},gu),uu=(vu.from=function(t,e,n){$s(t.mutations.length===n.length);for(var i=ds,r=t.mutations,o=0;o<r.length;o++)i=i.Re(r[o].key,n[o].version);return new vu(t,e,n,i)},vu),au=(yu.prototype.catch=function(t){return this.next(void 0,t)},yu.prototype.next=function(i,r){var o=this;return this.Vn&&Ks(),this.Vn=!0,this.Pn?this.error?this.pn(r,this.error):this.yn(i,this.result):new yu(function(e,n){o.Rn=function(t){o.yn(i,t).next(e,n)},o.An=function(t){o.pn(r,t).next(e,n)}})},yu.prototype.gn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},yu.prototype.bn=function(t){try{var e=t();return e instanceof yu?e:yu.resolve(e)}catch(t){return yu.reject(t)}},yu.prototype.yn=function(t,e){return t?this.bn(function(){return t(e)}):yu.resolve(e)},yu.prototype.pn=function(t,e){return t?this.bn(function(){return t(e)}):yu.reject(e)},yu.resolve=function(n){return new yu(function(t,e){t(n)})},yu.reject=function(n){return new yu(function(t,e){e(n)})},yu.vn=function(t){return new yu(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},yu.Sn=function(t){for(var n=yu.resolve(!1),e=function(e){n=n.next(function(t){return t?yu.resolve(t):e()})},i=0,r=t;i<r.length;i++)e(r[i]);return n},yu.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.vn(r)},yu),hu=(du.prototype.Nn=function(e,n){var i=this;return this.Dn.$n(e,n).next(function(t){return i.Ln(e,n,t)})},du.prototype.Ln=function(t,i,r){return this.Cn.On(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].ot(i,t);return t})},du.prototype.kn=function(t,e,r){var o=fs();return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].ot(t,e);o=o.Re(t,e)}),o},du.prototype.qn=function(e,t){var n=this;return this.Cn.getEntries(e,t).next(function(t){return n.Mn(e,t)})},du.prototype.Mn=function(i,r){var o=this;return this.Dn.xn(i,r).next(function(t){var e=o.kn(i,r,t),n=cs();return e.forEach(function(t,e){e=e||new To(t,Ui.min()),n=n.Re(t,e)}),n})},du.prototype.Bn=function(t,e,n){return e.qt()?this.Un(t,e.path):e.le()?this.Qn(t,e,n):this.Wn(t,e,n)},du.prototype.Un=function(t,e){return this.Nn(t,new $i(e)).next(function(t){var e=ps();return t instanceof Io&&(e=e.Re(t.key,t)),e})},du.prototype.Qn=function(n,i,r){var o=this,s=i.collectionGroup,u=ps();return this.Fn.jn(n,s).next(function(t){return au.forEach(t,function(t){var e=i.Zt(t.child(s));return o.Wn(n,e,r).next(function(t){t.forEach(function(t,e){u=u.Re(t,e)})})}).next(function(){return u})})},du.prototype.Wn=function(e,n,t){var c,f,i=this;return this.Cn.Bn(e,n,t).next(function(t){return c=t,i.Dn.Gn(e,n)}).next(function(t){return f=t,i.Hn(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],u=s.key,a=c.get(u),h=s.ot(a,a,i.wn);c=h instanceof Io?c.Re(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){n.matches(e)||(c=c.remove(t))}),c})},du.prototype.Hn=function(t,e,n){for(var i=vs(),r=0,o=e;r<o.length;r++)for(var s=0,u=o[r].mutations;s<u.length;s++){var a=u[s];a instanceof zr&&null===n.get(a.key)&&(i=i.add(a.key))}var h=n;return this.Cn.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Io&&(h=h.Re(t,e))}),h})},du),cu=(pu.Yn=function(t,e){for(var n=vs(),i=vs(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new pu(t,e.fromCache,n,i)},pu),fu=(lu.prototype.Jn=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},lu.prototype.next=function(){var t=++this.previousValue;return this.Zn&&this.Zn(t),t},lu);function lu(t,e){var n=this;this.previousValue=t,e&&(e.Xn=function(t){return n.Jn(t)},this.Zn=function(t){return e.tr(t)})}function pu(t,e,n,i){this.targetId=t,this.fromCache=e,this.Kn=n,this.zn=i}function du(t,e,n){this.Cn=t,this.Dn=e,this.Fn=n}function yu(t){var e=this;this.Rn=null,this.An=null,this.result=void 0,this.error=void 0,this.Pn=!1,this.Vn=!1,t(function(t){e.Pn=!0,e.result=t,e.Rn&&e.Rn(t)},function(t){e.Pn=!0,e.error=t,e.An&&e.An(t)})}function vu(t,e,n,i){this.batch=t,this.In=e,this.Tn=n,this.mn=i}function gu(t,e,n,i){this.batchId=t,this.wn=e,this.baseMutations=n,this.mutations=i}function mu(t){this.fn=t,this.dn={}}function wu(t,e){this.projectId=t,this.database=e||"(default)"}fu.er=-1;function bu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Eu=(Du.prototype.reset=function(){this.or=0},Du.prototype.cr=function(){this.or=this.hr},Du.prototype.lr=function(t){var e=this;this.cancel();var n=Math.floor(this.or+this._r()),i=Math.max(0,Date.now()-this.ur),r=Math.max(0,n-i);0<r&&Qs("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.or+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this.ar=this.sr.dr(this.ir,r,function(){return e.ur=Date.now(),t()}),this.or*=this.rr,this.or<this.nr&&(this.or=this.nr),this.or>this.hr&&(this.or=this.hr)},Du.prototype.wr=function(){null!==this.ar&&(this.ar.Tr(),this.ar=null)},Du.prototype.cancel=function(){null!==this.ar&&(this.ar.cancel(),this.ar=null)},Du.prototype._r=function(){return(Math.random()-.5)*this.or},Du),Iu=(Ru.prototype.Ir=function(t,e){return this.Er.add(e),au.resolve()},Ru.prototype.jn=function(t,e){return au.resolve(this.Er.getEntries(e))},Ru),Tu=(_u.prototype.add=function(t){var e=t.q(),n=t.O(),i=this.index[e]||new os(Ci.N),r=!i.has(n);return this.index[e]=i.add(n),r},_u.prototype.has=function(t){var e=t.q(),n=t.O(),i=this.index[e];return i&&i.has(n)},_u.prototype.getEntries=function(t){return(this.index[t]||new os(Ci.N)).W()},_u),Au=(Nu.prototype.next=function(){return this.mr+=2,this.mr},Nu.Rr=function(){return new Nu(0)},Nu.Ar=function(){return new Nu(-1)},Nu);function Nu(t){this.mr=t}function _u(){this.index={}}function Ru(){this.Er=new Tu}function Du(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.sr=t,this.ir=e,this.nr=n,this.rr=i,this.hr=r,this.or=0,this.ar=null,this.ur=Date.now(),this.reset()}function Su(t){return"IndexedDbTransactionError"===t.name}var Ou=(Pu.gr=function(t,e,n,i,r){var o=new Pu(t,e,Date.now()+n,i,r);return o.start(n),o},Pu.prototype.start=function(t){var e=this;this.br=setTimeout(function(){return e.vr()},t)},Pu.prototype.Tr=function(){return this.vr()},Pu.prototype.cancel=function(t){null!==this.br&&(this.clearTimeout(),this.yr.reject(new Si(Di.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Pu.prototype.vr=function(){var e=this;this.Pr.Sr(function(){return null!==e.br?(e.clearTimeout(),e.op().then(function(t){return e.yr.resolve(t)})):Promise.resolve()})},Pu.prototype.clearTimeout=function(){null!==this.br&&(this.pr(this),clearTimeout(this.br),this.br=null)},Pu),ku=(Object.defineProperty(Lu.prototype,"Mr",{get:function(){return this.Fr},enumerable:!0,configurable:!0}),Lu.prototype.Sr=function(t){this.enqueue(t)},Lu.prototype.xr=function(t){this.Br(),this.Ur(t)},Lu.prototype.Qr=function(t){return this.Br(),this.Ur(t)},Lu.prototype.Wr=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.Br(),this.Fr?[3,2]:(this.Fr=!0,(e=Gs.nt().window)&&e.removeEventListener("visibilitychange",this.qr),[4,this.Qr(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Lu.prototype.enqueue=function(t){return this.Br(),this.Fr?new Promise(function(t){}):this.Ur(t)},Lu.prototype.jr=function(r){var t=this;this.Br(),this.Fr||(this.Dr=this.Dr.then(function(){var n=new bu,i=function(){return d(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,r()];case 1:return t.sent(),n.resolve(),this.kr.reset(),[3,3];case 2:if(!Su(e=t.sent()))throw n.resolve(),e;return Qs("AsyncQueue","Operation failed with retryable error: "+e),this.kr.lr(i),[3,3];case 3:return[2]}})})};return t.Sr(i),n.promise}))},Lu.prototype.Ur=function(t){var i=this,e=this.Cr.then(function(){return i.Lr=!0,t().catch(function(t){throw i.$r=t,i.Lr=!1,Xs("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return i.Lr=!1,t})});return this.Cr=e},Lu.prototype.dr=function(t,e,n){var i=this;this.Br(),-1<this.Or.indexOf(t)&&(e=0);var r=Ou.gr(this,t,e,n,function(t){return i.Gr(t)});return this.Nr.push(r),r},Lu.prototype.Br=function(){this.$r&&Ks()},Lu.prototype.Hr=function(){},Lu.prototype.Kr=function(){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.Cr];case 1:t.sent(),t.label=2;case 2:if(e!==this.Cr)return[3,0];t.label=3;case 3:return[2]}})})},Lu.prototype.zr=function(t){for(var e=0,n=this.Nr;e<n.length;e++)if(n[e].ir===t)return!0;return!1},Lu.prototype.Yr=function(i){var r=this;return this.Kr().then(function(){r.Nr.sort(function(t,e){return t.Vr-e.Vr});for(var t=0,e=r.Nr;t<e.length;t++){var n=e[t];if(n.Tr(),"all"!==i&&n.ir===i)break}return r.Kr()})},Lu.prototype.Xr=function(t){this.Or.push(t)},Lu.prototype.Gr=function(t){var e=this.Nr.indexOf(t);this.Nr.splice(e,1)},Lu);function Lu(){var t=this;this.Cr=Promise.resolve(),this.Dr=Promise.resolve(),this.Fr=!1,this.Nr=[],this.$r=null,this.Lr=!1,this.Or=[],this.kr=new Eu(this,"async_queue_retry"),this.qr=function(){return t.kr.wr()};var e=Gs.nt().window;e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.qr)}function Pu(t,e,n,i,r){this.Pr=t,this.ir=e,this.Vr=n,this.op=i,this.pr=r,this.yr=new bu,this.then=this.yr.promise.then.bind(this.yr.promise),this.yr.promise.catch(function(t){})}function Vu(t,e){if(Xs("AsyncQueue",e+": "+t),Su(t))return new Si(Di.UNAVAILABLE,e+": "+t);throw t}var Uu=(Mu.eh=function(t){return new Mu(t,Mu.sh,Mu.ih)},Mu);function Mu(t,e,n){this.Jr=t,this.Zr=e,this.th=n}Uu.nh=-1,Uu.rh=1048576,Uu.hh=41943040,Uu.sh=10,Uu.ih=1e3,Uu.oh=new Uu(Uu.hh,Uu.sh,Uu.ih),Uu.DISABLED=new Uu(Uu.nh,0,0);var Cu=(qu.prototype.start=function(){return Promise.resolve()},qu.prototype.Ah=function(r){return d(this,void 0,void 0,function(){var e,m,n,i=this;return y(this,function(t){switch(t.label){case 0:return e=this.Dn,m=this.Ih,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return i.Dn.Ph(v).next(function(t){return g=t,e=i.persistence.fh(r),m=new hu(i.dh,e,i.persistence.mh()),e.Ph(v)}).next(function(t){for(var e=[],n=[],i=vs(),r=0,o=g;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++){var h=a[u];i=i.add(h.key)}}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];i=i.add(y.key)}}return m.qn(v,i).next(function(t){return{Vh:t,ph:e,yh:n}})})})];case 1:return n=t.sent(),[2,(this.Dn=e,this.Ih=m,this.ah.Rh(this.Ih),n)]}})})},qu.prototype.gh=function(u){var a,h=this,c=Vi.now(),t=u.reduce(function(t,e){return t.add(e.key)},vs());return this.persistence.runTransaction("Locally write mutations","readwrite",function(s){return h.Ih.qn(s,t).next(function(t){a=t;for(var e=[],n=0,i=u;n<i.length;n++){var r=i[n],o=r.Pt(a.get(r.key));null!=o&&e.push(new zr(r.key,o,uo(o.proto.mapValue),Fr.exists(!0)))}return h.Dn.bh(s,c,e,u)})}).then(function(t){var e=t.En(a);return{batchId:t.batchId,vh:e}})},qu.prototype.Sh=function(i){var r=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=i.batch.keys(),n=r.dh.Ch({Dh:!0});return r.Fh(t,i,n).next(function(){return n.apply(t)}).next(function(){return r.Dn.Nh(t)}).next(function(){return r.Ih.qn(t,e)})})},qu.prototype.$h=function(t){var i=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Dn.Lh(e,t).next(function(t){return $s(null!==t),n=t.keys(),i.Dn.Oh(e,t)}).next(function(){return i.Dn.Nh(e)}).next(function(){return i.Ih.qn(e,n)})})},qu.prototype.kh=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Dn.kh(t)})},qu.prototype.qh=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Th.qh(t)})},qu.prototype.Mh=function(a){var h=this,c=a.Te,f=this.uh;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var r=h.dh.Ch({Dh:!0});f=h.uh;var s=[];a.as.forEach(function(t,e){var n=f.get(e);if(n){s.push(h.Th.xh(o,t.Es,e).next(function(){return h.Th.Bh(o,t.ws,e)}));var i=t.resumeToken;if(0<i.rt()){var r=n.Ie(i,c).Ee(o.Uh);f=f.Re(e,r),qu.Qh(n,r,t)&&s.push(h.Th.Wh(o,r))}}});var u=cs(),n=vs();if(a.cs.forEach(function(t,e){n=n.add(t)}),s.push(r.getEntries(o,n).next(function(i){a.cs.forEach(function(t,e){var n=i.get(t);e instanceof To&&e.version.isEqual(Ui.min())?(r.jh(t,c),u=u.Re(t,e)):null==n||0<e.version.S(n.version)||0===e.version.S(n.version)&&n.hasPendingWrites?(r.Gh(e,c),u=u.Re(t,e)):Qs("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.ls.has(t)&&s.push(h.persistence.Kh.Hh(o,t))})})),!c.isEqual(Ui.min())){var t=h.Th.qh(o).next(function(t){return h.Th.zh(o,o.Uh,c)});s.push(t)}return au.vn(s).next(function(){return r.apply(o)}).next(function(){return h.Ih.Mn(o,u)})}).then(function(t){return h.uh=f,t})},qu.Qh=function(t,e,n){return $s(0<e.resumeToken.rt()),0===t.resumeToken.rt()||e.Te.C()-t.Te.C()>=this.Yh||0<n.ws.size+n.Ts.size+n.Es.size},qu.prototype.Xh=function(c){return d(this,void 0,void 0,function(){var e,n,i,r,o,s,u,a,h=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return au.forEach(c,function(e){return au.forEach(e.Kn,function(t){return h.persistence.Kh.Jh(n,e.targetId,t)}).next(function(){return au.forEach(e.zn,function(t){return h.persistence.Kh.Zh(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!Su(e=t.sent()))throw e;return Qs("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,i=c;n<i.length;n++)r=i[n],o=r.targetId,r.fromCache||(s=this.uh.get(o),u=s.Te,a=s.me(u),this.uh=this.uh.Re(o,a));return[2]}})})},qu.prototype.to=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Dn.eo(t,e)})},qu.prototype.so=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Ih.Nn(t,e)})},qu.prototype.io=function(i){var r=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.Th.no(e,i).next(function(t){return t?(n=t,au.resolve(n)):r.Th.ro(e).next(function(t){return n=new Uo(i,t,0,e.Uh),r.Th.ho(e,n).next(function(){return n})})})}).then(function(t){var e=r.uh.get(t.targetId);return(null===e||0<t.Te.S(e.Te))&&(r.uh=r.uh.Re(t.targetId,t),r.lh.set(i,t.targetId)),t})},qu.prototype.no=function(t,e){var n=this.lh.get(e);return void 0!==n?au.resolve(this.uh.get(n)):this.Th.no(t,e)},qu.prototype.oo=function(t,e){var n=this,i=this.uh.get(t),r=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",r,function(t){return e?au.resolve():n.persistence.Kh.removeTarget(t,i)}).then(function(){n.uh=n.uh.remove(t),n.lh.delete(i.target)})},qu.prototype.ao=function(t,n){var i=this,r=Ui.min(),o=vs();return this.persistence.runTransaction("Execute query","readonly",function(e){return i.no(e,t.ee()).next(function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,i.Th.uo(e,t.targetId).next(function(t){o=t})}).next(function(){return i.ah.Bn(e,t,n?r:Ui.min(),n?o:vs())}).next(function(t){return{documents:t,co:o}})})},qu.prototype.Fh=function(t,r,o){var e=this,s=r.batch,n=s.keys(),u=au.resolve();return n.forEach(function(i){u=u.next(function(){return o.On(t,i)}).next(function(t){var e=t,n=r.mn.get(i);$s(null!==n),(!e||e.version.S(n)<0)&&(e=s.at(i,e,r))&&o.Gh(e,r.In)})}),u.next(function(){return e.Dn.Oh(t,s)})},qu.prototype.lo=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e._o(t,n.uh)})},qu);function qu(t,e,n){this.persistence=t,this.ah=e,this.uh=new Jo(eu),this.lh=new ou(function(t){return t.canonicalId()}),this._h=Ui.min(),this.Dn=t.fh(n),this.dh=t.wh(),this.Th=t.Eh(),this.Ih=new hu(this.dh,this.Dn,this.persistence.mh()),this.ah.Rh(this.Ih)}function xu(e){return d(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Di.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Qs("LocalStore","Unexpectedly lost primary lease"),[2]})})}Cu.Yh=3e8;var ju=(Gu.prototype.M=function(){return this.fo.M()},Gu.prototype.Jh=function(t,e){var n=new Fu(t,e);this.fo=this.fo.add(n),this.wo=this.wo.add(n)},Gu.prototype.Eo=function(t,e){var n=this;t.forEach(function(t){return n.Jh(t,e)})},Gu.prototype.Zh=function(t,e){this.Io(new Fu(t,e))},Gu.prototype.mo=function(t,e){var n=this;t.forEach(function(t){return n.Zh(t,e)})},Gu.prototype.Ro=function(t){var e=this,n=$i.EMPTY,i=new Fu(n,t),r=new Fu(n,t+1),o=[];return this.wo.Ge([i,r],function(t){e.Io(t),o.push(t.key)}),o},Gu.prototype.Ao=function(){var e=this;this.fo.forEach(function(t){return e.Io(t)})},Gu.prototype.Io=function(t){this.fo=this.fo.delete(t),this.wo=this.wo.delete(t)},Gu.prototype.Po=function(t){var e=$i.EMPTY,n=new Fu(e,t),i=new Fu(e,t+1),r=vs();return this.wo.Ge([n,i],function(t){r=r.add(t.key)}),r},Gu.prototype.Vo=function(t){var e=new Fu(t,0),n=this.fo.Ke(e);return null!==n&&t.isEqual(n.key)},Gu),Fu=(Bu.do=function(t,e){return $i.N(t.key,e.key)||eu(t.po,e.po)},Bu.To=function(t,e){return eu(t.po,e.po)||$i.N(t.key,e.key)},Bu);function Bu(t,e){this.key=t,this.po=e}function Gu(){this.fo=new os(Fu.do),this.wo=new os(Fu.To)}function zu(t,e){if(0!==e.length)throw new Si(Di.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+aa(e.length,"argument")+".")}function Hu(t,e,n){if(e.length!==n)throw new Si(Di.INVALID_ARGUMENT,"Function "+t+"() requires "+aa(n,"argument")+", but was called with "+aa(e.length,"argument")+".")}function Wu(t,e,n){if(e.length<n)throw new Si(Di.INVALID_ARGUMENT,"Function "+t+"() requires at least "+aa(n,"argument")+", but was called with "+aa(e.length,"argument")+".")}function Qu(t,e,n,i){if(e.length<n||e.length>i)throw new Si(Di.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+aa(e.length,"argument")+".")}function Xu(t,e,n,i){ta(t,e,ua(n)+" argument",i)}function Yu(t,e,n,i){void 0!==i&&Xu(t,e,n,i)}function Ku(t,e,n,i){ta(t,e,n+" option",i)}function $u(t,e,n,i){void 0!==i&&Ku(t,e,n,i)}function Ju(t,e,n,i,a){void 0!==i&&function(t,e,n){for(var i=[],r=0,o=a;r<o.length;r++){var s=o[r];if(s===n)return;i.push(na(s))}var u=na(n);throw new Si(Di.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+i.join(", "))}(t,n,i)}function Zu(t,e,n,i){if(!e.some(function(t){return t===i}))throw new Si(Di.INVALID_ARGUMENT,"Invalid value "+na(i)+" provided to function "+t+"() for its "+ua(n)+" argument. Acceptable values: "+e.join(", "));return i}function ta(t,e,n,i){if(!("object"===e?ea(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=na(i);throw new Si(Di.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function ea(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function na(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Ks();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function ia(t,e,n){if(void 0===n)throw new Si(Di.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+ua(e)+" argument, but it was undefined.")}function ra(n,t,i){tr(t,function(t,e){if(i.indexOf(t)<0)throw new Si(Di.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function oa(t,e,n,i){var r=na(i);return new Si(Di.INVALID_ARGUMENT,"Function "+t+"() requires its "+ua(n)+" argument to be a "+e+", but it was: "+r)}function sa(t,e,n){if(n<=0)throw new Si(Di.INVALID_ARGUMENT,"Function "+t+"() requires its "+ua(e)+" argument to be a positive number, but it was: "+n+".")}function ua(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function aa(t,e){return t+" "+e+(1===t?"":"s")}function ha(){if("undefined"==typeof Uint8Array)throw new Si(Di.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function ca(){if(!Gs.nt().yo)throw new Si(Di.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function fa(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Si(Di.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Xu("FieldPath","string",e,t[e]),0===t[e].length)throw new Si(Di.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.vo=new Yi(t)}var la,pa=(va.fromBase64String=function(t){Hu("Blob.fromBase64String",arguments,1),Xu("Blob.fromBase64String","string",1,t),ca();try{return new va(nr.fromBase64String(t))}catch(t){throw new Si(Di.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},va.fromUint8Array=function(t){if(Hu("Blob.fromUint8Array",arguments,1),ha(),!(t instanceof Uint8Array))throw oa("Blob.fromUint8Array","Uint8Array",1,t);return new va(nr.fromUint8Array(t))},va.prototype.toBase64=function(){return Hu("Blob.toBase64",arguments,0),ca(),this.bo.toBase64()},va.prototype.toUint8Array=function(){return Hu("Blob.toUint8Array",arguments,0),ha(),this.bo.toUint8Array()},va.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},va.prototype.isEqual=function(t){return this.bo.isEqual(t.bo)},va),da=(n(ya,la=fa),ya.documentId=function(){return ya.So},ya.prototype.isEqual=function(t){if(!(t instanceof ya))throw oa("isEqual","FieldPath",1,t);return this.vo.isEqual(t.vo)},ya);function ya(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return la.call(this,t)||this}function va(t){ca(),this.bo=t}da.So=new da(Yi.X().j());var ga,ma,wa,ba,Ea,Ia,Ta,Aa=new RegExp("[~\\*/\\[\\]]"),Na=function(){this.Co=this},_a=(n(Qa,Ta=Na),Qa.prototype.Fo=function(t){if(2!==t.No)throw 1===t.No?t.$o(this.Do+"() can only appear at the top level of your update data"):t.$o(this.Do+"() cannot be used with set() unless you pass {merge:true}");return t.Vt.push(t.path),null},Qa.prototype.isEqual=function(t){return t instanceof Qa},Qa),Ra=(n(Wa,Ia=Na),Wa.prototype.Fo=function(t){return new jr(t.path,Ar.instance)},Wa.prototype.isEqual=function(t){return t instanceof Wa},Wa),Da=(n(Ha,Ea=Na),Ha.prototype.Fo=function(t){var e=new Ya({No:3,methodName:this.Do,Oo:!0},t.ii,t.serializer,t.ignoreUndefinedProperties),n=this.Lo.map(function(t){return Za(t,e)}),i=new _r(n);return new jr(t.path,i)},Ha.prototype.isEqual=function(t){return this===t},Ha),Sa=(n(za,ba=Na),za.prototype.Fo=function(t){var e=new Ya({No:3,methodName:this.Do,Oo:!0},t.ii,t.serializer,t.ignoreUndefinedProperties),n=this.Lo.map(function(t){return Za(t,e)}),i=new Rr(n);return new jr(t.path,i)},za.prototype.isEqual=function(t){return this===t},za),Oa=(n(Ga,wa=Na),Ga.prototype.Fo=function(t){var e=new Ya({No:3,methodName:this.Do},t.ii,t.serializer,t.ignoreUndefinedProperties),n=Za(this.ko,e),i=new Dr(t.serializer,n);return new jr(t.path,i)},Ga.prototype.isEqual=function(t){return this===t},Ga),ka=(n(Ba,ma=Na),Ba.delete=function(){return zu("FieldValue.delete",arguments),new La(new _a("FieldValue.delete"))},Ba.serverTimestamp=function(){return zu("FieldValue.serverTimestamp",arguments),new La(new Ra("FieldValue.serverTimestamp"))},Ba.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Wu("FieldValue.arrayUnion",arguments,1),new La(new Da("FieldValue.arrayUnion",t))},Ba.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Wu("FieldValue.arrayRemove",arguments,1),new La(new Sa("FieldValue.arrayRemove",t))},Ba.increment=function(t){return Xu("FieldValue.increment","number",1,t),Hu("FieldValue.increment",arguments,1),new La(new Oa("FieldValue.increment",t))},Ba),La=(n(Fa,ga=ka),Fa.prototype.Fo=function(t){return this.Co.Fo(t)},Fa.prototype.isEqual=function(t){return t instanceof Fa&&this.Co.isEqual(t.Co)},Fa),Pa=(Object.defineProperty(ja.prototype,"latitude",{get:function(){return this.qo},enumerable:!0,configurable:!0}),Object.defineProperty(ja.prototype,"longitude",{get:function(){return this.Mo},enumerable:!0,configurable:!0}),ja.prototype.isEqual=function(t){return this.qo===t.qo&&this.Mo===t.Mo},ja.prototype.g=function(t){return eu(this.qo,t.qo)||eu(this.Mo,t.Mo)},ja),Va=/^__.*__$/,Ua=function(t,e,n){this.xo=t,this.Bo=e,this.Uo=n},Ma=(xa.prototype.Qo=function(t,e){var n=[];return null!==this.Vt?n.push(new zr(t,this.data,this.Vt,e)):n.push(new Gr(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Hr(t,this.fieldTransforms)),n},xa),Ca=(qa.prototype.Qo=function(t,e){var n=[new zr(t,this.data,this.Vt,e)];return 0<this.fieldTransforms.length&&n.push(new Hr(t,this.fieldTransforms)),n},qa);function qa(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}function xa(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}function ja(t,e){if(Hu("GeoPoint",arguments,2),Xu("GeoPoint","number",1,t),Xu("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Si(Di.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Si(Di.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.qo=t,this.Mo=e}function Fa(t){var e=this;return(e=ga.call(this)||this).Co=t,e.Do=t.Do,e}function Ba(){return null!==ma&&ma.apply(this,arguments)||this}function Ga(t,e){var n=this;return(n=wa.call(this)||this).Do=t,n.ko=e,n}function za(t,e){var n=this;return(n=ba.call(this)||this).Do=t,n.Lo=e,n}function Ha(t,e){var n=this;return(n=Ea.call(this)||this).Do=t,n.Lo=e,n}function Wa(t){var e=this;return(e=Ia.call(this)||this).Do=t,e}function Qa(t){var e=this;return(e=Ta.call(this)||this).Do=t,e}function Xa(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Ks()}}var Ya=(Object.defineProperty(Ja.prototype,"path",{get:function(){return this.settings.path},enumerable:!0,configurable:!0}),Object.defineProperty(Ja.prototype,"No",{get:function(){return this.settings.No},enumerable:!0,configurable:!0}),Ja.prototype.jo=function(t){return new Ja(Object.assign(Object.assign({},this.settings),t),this.ii,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Vt)},Ja.prototype.Go=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.jo({path:n,Oo:!1});return i.Ho(t),i},Ja.prototype.Ko=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.jo({path:n,Oo:!1});return i.Wo(),i},Ja.prototype.zo=function(t){return this.jo({path:void 0,Oo:!0})},Ja.prototype.$o=function(t){var e=!this.path||this.path.M()?"":" (found in field "+this.path.toString()+")";return new Si(Di.INVALID_ARGUMENT,"Function "+this.settings.methodName+"() called with invalid data. "+t+e)},Ja.prototype.contains=function(e){return void 0!==this.Vt.find(function(t){return e.B(t)})||void 0!==this.fieldTransforms.find(function(t){return e.B(t.field)})},Ja.prototype.Wo=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Ho(this.path.get(t))},Ja.prototype.Ho=function(t){if(0===t.length)throw this.$o("Document fields must not be empty");if(Xa(this.No)&&Va.test(t))throw this.$o('Document fields cannot begin and end with "__"')},Ja),Ka=($a.prototype.Xo=function(t,e,n){void 0===n&&(n={});var i=this.Jo(n.merge||n.mergeFields?2:0,t);nh("Data must be an object, but it was:",i,e);var r,o,s=th(e,i);if(n.merge)r=new xr(i.Vt),o=i.fieldTransforms;else if(n.mergeFields){for(var u=[],a=0,h=n.mergeFields;a<h.length;a++){var c=h[a],f=void 0;if(c instanceof fa)f=c.vo;else{if("string"!=typeof c)throw Ks();f=rh(t,c)}if(!i.contains(f))throw new Si(Di.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");oh(u,f)||u.push(f)}r=new xr(u),o=i.fieldTransforms.filter(function(t){return r.ft(t.field)})}else r=null,o=i.fieldTransforms;return new Ma(new Xr(s),r,o)},$a.prototype.Zo=function(o,t){var s=this.Jo(1,o);nh("Data must be an object, but it was:",s,t);var u=[],a=new Yr;tr(t,function(t,e){var n=rh(o,t),i=s.Ko(n);if(e instanceof Na&&e.Co instanceof _a)u.push(n);else{var r=Za(e,i);null!=r&&(u.push(n),a.set(n,r))}});var e=new xr(u);return new Ca(a.gt(),e,s.fieldTransforms)},$a.prototype.ta=function(t,e,n,i){var r=this.Jo(1,t),o=[ih(t,e)],s=[n];if(i.length%2!=0)throw new Si(Di.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var u=0;u<i.length;u+=2)o.push(ih(t,i[u])),s.push(i[u+1]);for(var a=[],h=new Yr,c=o.length-1;0<=c;--c)if(!oh(a,o[c])){var f=o[c],l=s[c],p=r.Ko(f);if(l instanceof Na&&l.Co instanceof _a)a.push(f);else{var d=Za(l,p);null!=d&&(a.push(f),h.set(f,d))}}var y=new xr(a);return new Ca(h.gt(),y,r.fieldTransforms)},$a.prototype.Jo=function(t,e){return new Ya({No:t,methodName:e,path:Yi.H,Oo:!1},this.ii,this.serializer,this.ignoreUndefinedProperties)},$a.prototype.ea=function(t,e,n){return void 0===n&&(n=!1),Za(e,this.Jo(n?4:3,t))},$a);function $a(t,e,n){this.ii=t,this.ignoreUndefinedProperties=e,this.serializer=n||Gs.nt().Yo(t)}function Ja(t,e,n,i,r,o){this.settings=t,this.ii=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.Wo(),this.fieldTransforms=r||[],this.Vt=o||[]}function Za(s,t){if(eh(s))return nh("Unsupported field value:",t,s),th(s,t);if(s instanceof Na)return function(t,e){if(!Xa(e.No))throw e.$o(t.Do+"() can only be used with update() and set()");if(!e.path)throw e.$o(t.Do+"() is not currently supported inside arrays");var n=t.Fo(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Vt.push(t.path),s instanceof Array){if(t.settings.Oo&&4!==t.No)throw t.$o("Nested arrays are not supported");return function(t){for(var e=[],n=0,i=0,r=s;i<r.length;i++){var o=Za(r[i],t.zo(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return e.serializer.ai(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Vi.fromDate(t);return{timestampValue:e.serializer.D(n)}}if(t instanceof Vi){var i=new Vi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:e.serializer.D(i)}}if(t instanceof Pa)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof pa)return{bytesValue:e.serializer.ui(t)};if(t instanceof Ua){var r=e.ii,o=t.xo;if(!o.isEqual(r))throw e.$o("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+r.projectId+"/"+r.database);return{referenceValue:e.serializer.li(t.Bo.path,t.xo)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.$o("Unsupported field value: "+na(t))}(s,t)}function th(t,i){var r={};return er(t)?i.path&&0<i.path.length&&i.Vt.push(i.path):tr(t,function(t,e){var n=Za(e,i.Go(t));null!=n&&(r[t]=n)}),{mapValue:{fields:r}}}function eh(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Vi||t instanceof Pa||t instanceof pa||t instanceof Ua||t instanceof Na)}function nh(t,e,n){if(!eh(n)||!ea(n)){var i=na(n);throw"an object"===i?e.$o(t+" a custom object"):e.$o(t+" "+i)}}function ih(t,e){if(e instanceof fa)return e.vo;if("string"==typeof e)return rh(t,e);throw new Si(Di.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function rh(t,e){try{return function(e){if(0<=e.search(Aa))throw new Si(Di.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(da.bind.apply(da,v([void 0],e.split("."))))}catch(t){throw new Si(Di.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).vo}catch(e){var n=e instanceof Error?e.message:e.toString();throw new Si(Di.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function oh(t,e){return t.some(function(t){return t.isEqual(e)})}function sh(t){this.key=t}function uh(t){this.key=t}function ah(t,e,n){this.query=t,this.targetId=e,this.view=n}function hh(t){this.key=t,this.Cc=!1}function ch(){this.al=void 0,this.ul=[]}var fh,lh,ph,dh,yh=(Xh.prototype.oa=function(){return 1===this.state||2===this.state||4===this.state},Xh.prototype.aa=function(){return 2===this.state},Xh.prototype.start=function(){3!==this.state?this.auth():this.ua()},Xh.prototype.stop=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.oa()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Xh.prototype.ca=function(){this.state=0,this.kr.reset()},Xh.prototype.la=function(){var t=this;this.aa()&&null===this.ha&&(this.ha=this.sr.dr(this.sa,6e4,function(){return t._a()}))},Xh.prototype.fa=function(t){this.da(),this.stream.send(t)},Xh.prototype._a=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.aa()?[2,this.close(0)]:[2]})})},Xh.prototype.da=function(){this.ha&&(this.ha.cancel(),this.ha=null)},Xh.prototype.close=function(e,n){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.da(),this.kr.cancel(),this.ra++,3!==e?this.kr.reset():n&&n.code===Di.RESOURCE_EXHAUSTED?(Xs(n.toString()),Xs("Using maximum backoff delay to prevent overloading the backend."),this.kr.cr()):n&&n.code===Di.UNAUTHENTICATED&&this.na.l(),null!==this.stream&&(this.wa(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Ta(n)];case 1:return t.sent(),[2]}})})},Xh.prototype.wa=function(){},Xh.prototype.auth=function(){var n=this;this.state=1;var t=this.Ea(this.ra),e=this.ra;this.na.getToken().then(function(t){n.ra===e&&n.Ia(t)},function(e){t(function(){var t=new Si(Di.UNKNOWN,"Fetching auth token failed: "+e.message);return n.ma(t)})})},Xh.prototype.Ia=function(t){var e=this,n=this.Ea(this.ra);this.stream=this.Ra(t),this.stream.Aa(function(){n(function(){return e.state=2,e.listener.Aa()})}),this.stream.Ta(function(t){n(function(){return e.ma(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Xh.prototype.ua=function(){var t=this;this.state=4,this.kr.lr(function(){return d(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},Xh.prototype.ma=function(t){return Qs("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Xh.prototype.Ea=function(e){var n=this;return function(t){n.sr.Sr(function(){return n.ra===e?t():(Qs("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Xh),vh=(n(Qh,ph=yh),Qh.prototype.Ra=function(t){return this.ia.Pa("Listen",t)},Qh.prototype.onMessage=function(t){this.kr.reset();var e=this.serializer.yi(t),n=this.serializer.bi(t);return this.listener.Va(e,n)},Qh.prototype.pa=function(t){var e={};e.database=this.serializer.Ii,e.addTarget=this.serializer.ee(t);var n=this.serializer.Ki(t);n&&(e.labels=n),this.fa(e)},Qh.prototype.ya=function(t){var e={};e.database=this.serializer.Ii,e.removeTarget=t,this.fa(e)},Qh),gh=(n(Wh,lh=yh),Object.defineProperty(Wh.prototype,"ba",{get:function(){return this.ga},enumerable:!0,configurable:!0}),Wh.prototype.start=function(){this.ga=!1,this.lastStreamToken=nr.ht,lh.prototype.start.call(this)},Wh.prototype.wa=function(){this.ga&&this.va([])},Wh.prototype.Ra=function(t){return this.ia.Pa("Write",t)},Wh.prototype.onMessage=function(t){if($s(!!t.streamToken),this.lastStreamToken=this.serializer.ci(t.streamToken),this.ga){this.kr.reset();var e=this.serializer.ki(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.Sa(n,e)}return $s(!t.writeResults||0===t.writeResults.length),this.ga=!0,this.listener.Ca()},Wh.prototype.Da=function(){var t={};t.database=this.serializer.Ii,this.fa(t)},Wh.prototype.va=function(t){var e=this,n={streamToken:this.serializer.ui(this.lastStreamToken),writes:t.map(function(t){return e.serializer.vi(t)})};this.fa(n)},Wh),mh=(n(Hh,fh=function(){this.Fa=void 0}),Hh.prototype.$a=function(){if(this.Na)throw new Si(Di.FAILED_PRECONDITION,"The client has already been terminated.")},Hh.prototype.La=function(e,n){var i=this;return this.$a(),this.credentials.getToken().then(function(t){return i.ia.La(e,n,t)}).catch(function(t){throw t.code===Di.UNAUTHENTICATED&&i.credentials.l(),t})},Hh.prototype.Oa=function(e,n){var i=this;return this.$a(),this.credentials.getToken().then(function(t){return i.ia.Oa(e,n,t)}).catch(function(t){throw t.code===Di.UNAUTHENTICATED&&i.credentials.l(),t})},Hh),wh=(zh.prototype.Ua=function(i){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.Qa(),0<this.mutations.length)throw new Si(Di.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return d(this,void 0,void 0,function(){var n,e,i,r,o;return y(this,function(t){switch(t.label){case 0:return n=Js(s),e={database:n.serializer.Ii,documents:u.map(function(t){return n.serializer.di(t)})},[4,n.Oa("BatchGetDocuments",e)];case 1:return i=t.sent(),r=new Map,i.forEach(function(t){var e=n.serializer.pi(t);r.set(e.key.toString(),e)}),o=[],[2,(u.forEach(function(t){var e=r.get(t.toString());$s(!!e),o.push(e)}),o)]}})})}(this.ka,i)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof To||t instanceof Io?n.Wa(t):Ks()}),e)]}})})},zh.prototype.set=function(t,e){this.write(e.Qo(t,this.Rt(t))),this.Ba.add(t)},zh.prototype.update=function(t,e){try{this.write(e.Qo(t,this.ja(t)))}catch(t){this.xa=t}this.Ba.add(t)},zh.prototype.delete=function(t){this.write([new Wr(t,this.Rt(t))]),this.Ba.add(t)},zh.prototype.commit=function(){return d(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:if(this.Qa(),this.xa)throw this.xa;return e=this.qa,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new $i(Ci.G(e));i.mutations.push(new Qr(n,i.Rt(n)))}),[4,function(i,r){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return e=Js(i),n={database:e.serializer.Ii,writes:r.map(function(t){return e.serializer.vi(t)})},[4,e.La("Commit",n)];case 1:return t.sent(),[2]}})})}(this.ka,this.mutations)];case 1:return t.sent(),this.Ma=!0,[2]}})})},zh.prototype.Wa=function(t){var e;if(t instanceof Io)e=t.version;else{if(!(t instanceof To))throw Ks();e=Ui.min()}var n=this.qa.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Si(Di.ABORTED,"Document version changed between two reads.")}else this.qa.set(t.key.toString(),e)},zh.prototype.Rt=function(t){var e=this.qa.get(t.toString());return!this.Ba.has(t)&&e?Fr.updateTime(e):Fr.dt()},zh.prototype.ja=function(t){var e=this.qa.get(t.toString());if(this.Ba.has(t)||!e)return Fr.exists(!0);if(e.isEqual(Ui.min()))throw new Si(Di.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Fr.updateTime(e)},zh.prototype.write=function(t){this.Qa(),this.mutations=this.mutations.concat(t)},zh.prototype.Qa=function(){},zh),bh=(Gh.prototype.Ya=function(){var t=this;0===this.Ha&&(this.Xa("Unknown"),this.Ka=this.Pr.dr("online_state_timeout",1e4,function(){return t.Ka=null,t.Ja("Backend didn't respond within 10 seconds."),t.Xa("Offline"),Promise.resolve()}))},Gh.prototype.Za=function(t){"Online"===this.state?this.Xa("Unknown"):(this.Ha++,1<=this.Ha&&(this.tu(),this.Ja("Connection failed 1 times. Most recent error: "+t.toString()),this.Xa("Offline")))},Gh.prototype.set=function(t){this.tu(),this.Ha=0,"Online"===t&&(this.za=!1),this.Xa(t)},Gh.prototype.Xa=function(t){t!==this.state&&(this.state=t,this.Ga(t))},Gh.prototype.Ja=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.za?(Xs(e),this.za=!1):Qs("OnlineStateTracker",e)},Gh.prototype.tu=function(){null!==this.Ka&&(this.Ka.cancel(),this.Ka=null)},Gh),Eh=(Bh.prototype.start=function(){return this.enableNetwork()},Bh.prototype.enableNetwork=function(){return this.networkEnabled=!0,this.mu()},Bh.prototype.mu=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.au()?(this.Ru()?this.Au():this.cu.set("Unknown"),[4,this.Pu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Bh.prototype.disableNetwork=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Vu()];case 1:return t.sent(),this.cu.set("Offline"),[2]}})})},Bh.prototype.Vu=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.wu.stop()];case 1:return t.sent(),[4,this.lu.stop()];case 2:return t.sent(),0<this.su.length&&(Qs("RemoteStore","Stopping write stream with "+this.su.length+" pending writes"),this.su=[]),this.pu(),[2]}})})},Bh.prototype.yu=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Qs("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.Vu()];case 1:return t.sent(),this.hu.yu(),this.cu.set("Unknown"),[2]}})})},Bh.prototype.listen=function(t){this.iu.has(t.targetId)||(this.iu.set(t.targetId,t),this.Ru()?this.Au():this.lu.aa()&&this.gu(t))},Bh.prototype.bu=function(t){this.iu.delete(t),this.lu.aa()&&this.vu(t),0===this.iu.size&&(this.lu.aa()?this.lu.la():this.au()&&this.cu.set("Unknown"))},Bh.prototype.si=function(t){return this.iu.get(t)||null},Bh.prototype.ei=function(t){return this.Su.ei(t)},Bh.prototype.gu=function(t){this.nu.Ns(t.targetId),this.lu.pa(t)},Bh.prototype.vu=function(t){this.nu.Ns(t),this.lu.ya(t)},Bh.prototype.Au=function(){this.nu=new Ds(this),this.lu.start(),this.cu.Ya()},Bh.prototype.Ru=function(){return this.au()&&!this.lu.oa()&&0<this.iu.size},Bh.prototype.au=function(){return!this.ru&&this.isPrimary&&this.networkEnabled},Bh.prototype.pu=function(){this.nu=null},Bh.prototype._u=function(){return d(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.iu.forEach(function(t,e){n.gu(t)}),[2]})})},Bh.prototype.fu=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){return this.pu(),this.Ru()?(this.cu.Za(e),this.Au()):this.cu.set("Unknown"),[2]})})},Bh.prototype.du=function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:if(this.cu.set("Online"),!(r instanceof Es&&2===r.state&&r.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Cu(r)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Qs("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),e),[4,this.Du(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(r instanceof ws?this.nu.Bs(r):r instanceof bs?this.nu.zs(r):this.nu.Ws(r),o.isEqual(Ui.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.eu.qh()];case 8:return n=t.sent(),0<=o.S(n)?[4,this.Fu(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Qs("RemoteStore","Failed to raise snapshot:",i=t.sent()),[4,this.Du(i)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Bh.prototype.Du=function(n,i){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(!Su(n))throw n;return this.ru=!0,[4,this.Vu()];case 1:return t.sent(),this.cu.set("Offline"),i=i||function(){return e.eu.qh()},this.Pr.jr(function(){return d(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Qs("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),this.ru=!1,[4,this.mu()];case 2:return t.sent(),[2]}})})}),[2]}})})},Bh.prototype.Nu=function(e){var n=this;return e().catch(function(t){return n.Du(t,e)})},Bh.prototype.Fu=function(i){var r=this,t=this.nu.Js(i);return t.as.forEach(function(t,e){if(0<t.resumeToken.rt()){var n=r.iu.get(e);n&&r.iu.set(e,n.Ie(t.resumeToken,i))}}),t.us.forEach(function(t){var e=r.iu.get(t);if(e){r.iu.set(t,e.Ie(nr.ht,e.Te)),r.vu(t);var n=new Uo(e.target,t,1,e.sequenceNumber);r.gu(n)}}),this.Su.Mh(t)},Bh.prototype.Cu=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:e=o.cause,n=0,i=o.targetIds,t.label=1;case 1:return n<i.length?(r=i[n],this.iu.has(r)?[4,this.Su.$u(r,e)]:[3,3]):[3,5];case 2:t.sent(),this.iu.delete(r),this.nu.removeTarget(r),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Bh.prototype.Pu=function(){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:e=0<this.su.length?this.su[this.su.length-1].batchId:-1,t.label=1;case 1:if(!this.Lu())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.eu.to(e)];case 3:return null===(n=t.sent())?(0===this.su.length&&this.wu.la(),[3,7]):(e=n.batchId,this.Ou(n),[3,6]);case 4:return i=t.sent(),[4,this.Du(i)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.ku()&&this.qu(),[2]}})})},Bh.prototype.Lu=function(){return this.au()&&this.su.length<10},Bh.prototype.Mu=function(){return this.su.length},Bh.prototype.Ou=function(t){this.su.push(t),this.wu.aa()&&this.wu.ba&&this.wu.va(t.mutations)},Bh.prototype.ku=function(){return this.au()&&!this.wu.oa()&&0<this.su.length},Bh.prototype.qu=function(){this.wu.start()},Bh.prototype.Tu=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.wu.Da(),[2]})})},Bh.prototype.Iu=function(){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){for(e=0,n=this.su;e<n.length;e++)i=n[e],this.wu.va(i.mutations);return[2]})})},Bh.prototype.Sa=function(r,o){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return e=this.su.shift(),n=uu.from(e,r,o),[4,this.Nu(function(){return i.Su.xu(n)})];case 1:return t.sent(),[4,this.Pu()];case 2:return t.sent(),[2]}})})},Bh.prototype.Eu=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e&&this.wu.ba?[4,this.Bu(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.ku()&&this.qu(),[2]}})})},Bh.prototype.Bu=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return Ko(n=r.code)&&n!==Di.ABORTED?(e=this.su.shift(),this.wu.ca(),[4,this.Nu(function(){return i.Su.Uu(e.batchId,r)})]):[3,3];case 1:return t.sent(),[4,this.Pu()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Bh.prototype.Qu=function(){return new wh(this.ka)},Bh.prototype.uu=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Vu()];case 1:return t.sent(),this.cu.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},Bh.prototype.Wu=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.au()?(Qs("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.uu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Bh.prototype.ju=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return(this.isPrimary=e)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:[4,this.Vu()];case 3:t.sent(),this.cu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Bh),Ih=(Fh.prototype.Gu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Fh.prototype.Hu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Fh.prototype.Ku=function(){var t={activeTargetIds:this.activeTargetIds.W(),updateTimeMs:Date.now()};return JSON.stringify(t)},Fh),Th=(jh.prototype.Xu=function(t){},jh.prototype.Ju=function(t,e,n){},jh.prototype.Zu=function(t){return this.zu.Gu(t),this.Yu[t]||"not-current"},jh.prototype.tc=function(t,e,n){this.Yu[t]=e},jh.prototype.ec=function(t){this.zu.Hu(t)},jh.prototype.sc=function(t){return this.zu.activeTargetIds.has(t)},jh.prototype.ic=function(t){delete this.Yu[t]},jh.prototype.nc=function(){return this.zu.activeTargetIds},jh.prototype.rc=function(t){return this.zu.activeTargetIds.has(t)},jh.prototype.start=function(){return this.zu=new Ih,Promise.resolve()},jh.prototype.Ah=function(t,e,n){},jh.prototype.hc=function(t){},jh.prototype.yu=function(){},jh.prototype.tr=function(t){},jh),Ah=(Object.defineProperty(xh.prototype,"lc",{get:function(){return this.oc},enumerable:!0,configurable:!0}),xh.prototype._c=function(t,e){var u=this,a=e?e.fc:new Ts,h=e?e.cc:this.cc,c=e?e.ns:this.ns,f=h,l=!1,p=this.query.oe()&&h.size===this.query.limit?h.last():null,d=this.query.ae()&&h.size===this.query.limit?h.first():null;if(t.ye(function(t,e){var n=h.get(t),i=e instanceof Io?e:null;i=i&&(u.query.matches(i)?i:null);var r=!!n&&u.ns.has(n.key),o=!!i&&(i.At||u.ns.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(a.track({type:3,doc:i}),s=!0):u.dc(n,i)||(a.track({type:2,doc:i}),s=!0,(p&&0<u.query.se(i,p)||d&&u.query.se(i,d)<0)&&(l=!0)):!n&&i?(a.track({type:0,doc:i}),s=!0):n&&!i&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=i?(f=f.add(i),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.oe()||this.query.ae())for(;f.size>this.query.limit;){var n=this.query.oe()?f.last():f.first();f=f.delete(n.key),c=c.delete(n.key),a.track({type:1,doc:n})}return{cc:f,fc:a,wc:l,ns:c}},xh.prototype.dc=function(t,e){return t.At&&e.hasCommittedMutations&&!e.At},xh.prototype.Tc=function(t,e,n){var o=this,i=this.cc;this.cc=t.cc,this.ns=t.ns;var r=t.fc.es();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.query.se(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ks()}}var i,r}),this.Ec(n);var s=e?this.Ic():[],u=0===this.uc.size&&this.ds?1:0,a=u!==this.ac;return this.ac=u,0!==r.length||a?{snapshot:new As(this.query,t.cc,i,r,t.ns,0==u,a,!1),mc:s}:{mc:s}},xh.prototype.Rc=function(t){return this.ds&&"Offline"===t?(this.ds=!1,this.Tc({cc:this.cc,fc:new Ts,ns:this.ns,wc:!1},!1)):{mc:[]}},xh.prototype.Ac=function(t){return!this.oc.has(t)&&!!this.cc.has(t)&&!this.cc.get(t).At},xh.prototype.Ec=function(t){var e=this;t&&(t.ws.forEach(function(t){return e.oc=e.oc.add(t)}),t.Ts.forEach(function(t){}),t.Es.forEach(function(t){return e.oc=e.oc.delete(t)}),this.ds=t.ds)},xh.prototype.Ic=function(){var e=this;if(!this.ds)return[];var n=this.uc;this.uc=vs(),this.cc.forEach(function(t){e.Ac(t.key)&&(e.uc=e.uc.add(t.key))});var i=[];return n.forEach(function(t){e.uc.has(t)||i.push(new uh(t))}),this.uc.forEach(function(t){n.has(t)||i.push(new sh(t))}),i},xh.prototype.Pc=function(t){this.oc=t.co,this.uc=vs();var e=this._c(t.documents);return this.Tc(e,!0)},xh.prototype.Vc=function(){return As.os(this.query,this.cc,this.ns,0===this.ac)},xh),Nh=(qh.prototype.yc=function(){this.gc()},qh.prototype.gc=function(){var t=this;this.kr.lr(function(){return d(t,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){return e=new wh(this.ka),(n=this.bc(e))&&n.then(function(t){i.Pr.Sr(function(){return e.commit().then(function(){i.yr.resolve(t)}).catch(function(t){i.vc(t)})})}).catch(function(t){i.vc(t)}),[2]})})})},qh.prototype.bc=function(t){try{var e=this.updateFunction(t);return!rr(e)&&e.catch&&e.then?e:(this.yr.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.yr.reject(t),null}},qh.prototype.vc=function(t){var e=this;0<this.pc&&this.Sc(t)?(--this.pc,this.Pr.Sr(function(){return e.gc(),Promise.resolve()})):this.yr.reject(t)},qh.prototype.Sc=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ko(e)},qh),_h=(Object.defineProperty(Ch.prototype,"Wc",{get:function(){return!0},enumerable:!0,configurable:!0}),Ch.prototype.subscribe=function(t){this.$c=t},Ch.prototype.listen=function(s){return d(this,void 0,void 0,function(){var e,n,i,r,o;return y(this,function(t){switch(t.label){case 0:return this.jc("listen()"),(i=this.Lc.get(s))?(e=i.targetId,this.Fc.Zu(e),n=i.view.Vc(),[3,4]):[3,1];case 1:return[4,this.eu.io(s.ee())];case 2:return r=t.sent(),o=this.Fc.Zu(r.targetId),e=r.targetId,[4,this.Gc(s,e,"current"===o)];case 3:n=t.sent(),this.Wc&&this.Dc.listen(r),t.label=4;case 4:return[2,n]}})})},Ch.prototype.Gc=function(u,a,h){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return[4,this.eu.ao(u,!0)];case 1:return e=t.sent(),n=new Ah(u,e.co),i=n._c(e.documents),r=_s.fs(a,h&&"Offline"!==this.onlineState),o=n.Tc(i,this.Wc,r),this.Hc(a,o.mc),s=new ah(u,a,n),[2,(this.Lc.set(u,s),this.Oc.has(a)?this.Oc.get(a).push(u):this.Oc.set(a,[u]),o.snapshot)]}})})},Ch.prototype.bu=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return this.jc("unlisten()"),e=this.Lc.get(r),1<(n=this.Oc.get(e.targetId)).length?[2,(this.Oc.set(e.targetId,n.filter(function(t){return!t.isEqual(r)})),void this.Lc.delete(r))]:this.Wc?(this.Fc.ec(e.targetId),this.Fc.rc(e.targetId)?[3,2]:[4,this.eu.oo(e.targetId,!1).then(function(){i.Fc.ic(e.targetId),i.Dc.bu(e.targetId),i.Kc(e.targetId)}).catch(xu)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.Kc(e.targetId),[4,this.eu.oo(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Ch.prototype.write=function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:this.jc("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.eu.gh(r)];case 2:return e=t.sent(),this.Fc.Xu(e.batchId),this.zc(e.batchId,o),[4,this.Yc(e.vh)];case 3:return t.sent(),[4,this.Dc.Pu()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),i=Vu(n,"Failed to persist write"),o.reject(i),[3,6];case 6:return[2]}})})},Ch.prototype.runTransaction=function(t,e,n){new Nh(t,this.ka,e,n).yc()},Ch.prototype.Mh=function(n){return d(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:this.jc("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.eu.Mh(n)];case 2:return e=t.sent(),n.as.forEach(function(t,e){var n=i.Mc.get(e);n&&($s(t.ws.size+t.Ts.size+t.Es.size<=1),0<t.ws.size?n.Cc=!0:0<t.Ts.size?$s(n.Cc):0<t.Es.size&&($s(n.Cc),n.Cc=!1))}),[4,this.Yc(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,xu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Ch.prototype.Rc=function(i,t){this.jc("applyOnlineStateChange()");var r=[];this.Lc.forEach(function(t,e){var n=e.view.Rc(i);n.snapshot&&r.push(n.snapshot)}),this.$c.Xc(i),this.$c.Va(r),this.onlineState=i},Ch.prototype.$u=function(u,a){return d(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.jc("rejectListens()"),this.Fc.tc(u,"rejected",a),e=this.Mc.get(u),(n=e&&e.key)?(i=(i=new Jo($i.N)).Re(n,new To(n,Ui.min())),r=vs().add(n),o=new Ns(Ui.min(),new Map,new os(eu),i,r),[4,this.Mh(o)]):[3,2];case 1:return t.sent(),this.qc=this.qc.remove(n),this.Mc.delete(u),this.Jc(),[3,4];case 2:return[4,this.eu.oo(u,!1).then(function(){return s.Kc(u,a)}).catch(xu)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},Ch.prototype.xu=function(i){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.jc("applySuccessfulWrite()"),e=i.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.eu.Sh(i)];case 2:return n=t.sent(),this.Zc(e,null),this.tl(e),this.Fc.Ju(e,"acknowledged"),[4,this.Yc(n)];case 3:return t.sent(),[3,6];case 4:return[4,xu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Ch.prototype.Uu=function(n,i){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:this.jc("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.eu.$h(n)];case 2:return e=t.sent(),this.Zc(n,i),this.tl(n),this.Fc.Ju(n,"rejected",i),[4,this.Yc(e)];case 3:return t.sent(),[3,6];case 4:return[4,xu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Ch.prototype.el=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:this.Dc.au()||Qs("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.eu.kh()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.Uc.get(e)||[]).push(o),this.Uc.set(e,n),[3,4]);case 3:return i=t.sent(),r=Vu(i,"Initialization of waitForPendingWrites() operation failed"),o.reject(r),[3,4];case 4:return[2]}})})},Ch.prototype.tl=function(t){(this.Uc.get(t)||[]).forEach(function(t){t.resolve()}),this.Uc.delete(t)},Ch.prototype.sl=function(e){this.Uc.forEach(function(t){t.forEach(function(t){t.reject(new Si(Di.CANCELLED,e))})}),this.Uc.clear()},Ch.prototype.zc=function(t,e){var n=this.Bc[this.currentUser.s()];n=(n=n||new Jo(eu)).Re(t,e),this.Bc[this.currentUser.s()]=n},Ch.prototype.Zc=function(t,e){var n=this.Bc[this.currentUser.s()];if(n){var i=n.get(t);i&&(e?i.reject(e):i.resolve(),n=n.remove(t)),this.Bc[this.currentUser.s()]=n}},Ch.prototype.Kc=function(t,e){var n=this;void 0===e&&(e=null),this.Fc.ec(t);for(var i=0,r=this.Oc.get(t);i<r.length;i++){var o=r[i];this.Lc.delete(o),e&&this.$c.il(o,e)}this.Oc.delete(t),this.Wc&&this.xc.Ro(t).forEach(function(t){n.xc.Vo(t)||n.nl(t)})},Ch.prototype.nl=function(t){var e=this.qc.get(t);null!==e&&(this.Dc.bu(e),this.qc=this.qc.remove(t),this.Mc.delete(e),this.Jc())},Ch.prototype.Hc=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof sh?(this.xc.Jh(r.key,t),this.rl(r)):r instanceof uh?(Qs("SyncEngine","Document no longer in limbo: "+r.key),this.xc.Zh(r.key,t),this.xc.Vo(r.key)||this.nl(r.key)):Ks()}},Ch.prototype.rl=function(t){var e=t.key;this.qc.get(e)||(Qs("SyncEngine","New document in limbo: "+e),this.kc.push(e),this.Jc())},Ch.prototype.Jc=function(){for(;0<this.kc.length&&this.qc.size<this.Nc;){var t=this.kc.shift(),e=this.Qc.next();this.Mc.set(e,new hh(t)),this.qc=this.qc.Re(t,e),this.Dc.listen(new Uo(_o.Wt(t.path).ee(),e,2,fu.er))}},Ch.prototype.hl=function(){return this.qc},Ch.prototype.ol=function(){return this.kc},Ch.prototype.Yc=function(i,a){return d(this,void 0,void 0,function(){var o,s,e,u=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Lc.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view._c(i);return n.wc?u.eu.ao(r.query,!1).then(function(t){var e=t.documents;return r.view._c(e,n)}):n}).then(function(t){var e=a&&a.as.get(r.targetId),n=r.view.Tc(t,u.Wc,e);if(u.Hc(r.targetId,n.mc),n.snapshot){u.Wc&&u.Fc.tc(r.targetId,n.snapshot.fromCache?"not-current":"current"),o.push(n.snapshot);var i=cu.Yn(r.targetId,n.snapshot);s.push(i)}}))}),[4,Promise.all(e)];case 1:return t.sent(),this.$c.Va(o),[4,this.eu.Xh(s)];case 2:return t.sent(),[2]}})})},Ch.prototype.jc=function(t){},Ch.prototype.Wu=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:[4,this.eu.Ah(n)];case 1:return e=t.sent(),this.currentUser=n,this.sl("'waitForPendingWrites' promise is rejected due to a user change."),this.Fc.Ah(n,e.ph,e.yh),[4,this.Yc(e.Vh)];case 2:t.sent(),t.label=3;case 3:return[4,this.Dc.Wu()];case 4:return t.sent(),[2]}})})},Ch.prototype.enableNetwork=function(){return this.Dc.enableNetwork()},Ch.prototype.disableNetwork=function(){return this.Dc.disableNetwork()},Ch.prototype.ei=function(t){var e=this.Mc.get(t);if(e&&e.Cc)return vs().add(e.key);var n=vs(),i=this.Oc.get(t);if(!i)return n;for(var r=0,o=i;r<o.length;r++){var s=o[r],u=this.Lc.get(s);n=n.ze(u.view.lc)}return n},Ch),Rh=(Mh.prototype.listen=function(u){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(i=this.cl.get(e))||(n=!0,i=new ch),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),r=i,[4,this.Su.listen(e)];case 2:return r.al=t.sent(),[3,4];case 3:return o=t.sent(),s=Vu(o,"Initialization of query '"+u.query+"' failed"),[2,void u.onError(s)];case 4:return this.cl.set(e,i),i.ul.push(u),u.Rc(this.onlineState),i.al&&u._l(i.al)&&this.fl(),[2]}})})},Mh.prototype.bu=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){return e=o.query,n=!1,(i=this.cl.get(e))&&0<=(r=i.ul.indexOf(o))&&(i.ul.splice(r,1),n=0===i.ul.length),n?[2,(this.cl.delete(e),this.Su.bu(e))]:[2]})})},Mh.prototype.Va=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this.cl.get(o);if(s){for(var u=0,a=s.ul;u<a.length;u++)a[u]._l(r)&&(e=!0);s.al=r}}e&&this.fl()},Mh.prototype.il=function(t,e){var n=this.cl.get(t);if(n)for(var i=0,r=n.ul;i<r.length;i++)r[i].onError(e);this.cl.delete(t)},Mh.prototype.Xc=function(r){this.onlineState=r;var o=!1;this.cl.forEach(function(t,e){for(var n=0,i=e.ul;n<i.length;n++)i[n].Rc(r)&&(o=!0)}),o&&this.fl()},Mh.prototype.dl=function(t){this.ll.add(t),t.next()},Mh.prototype.wl=function(t){this.ll.delete(t)},Mh.prototype.fl=function(){this.ll.forEach(function(t){t.next()})},Mh),Dh=(Uh.prototype._l=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new As(t.query,t.docs,t.ss,e,t.ns,t.fromCache,t.rs,!0)}var o=!1;return this.El?this.ml(t)&&(this.Tl.next(t),o=!0):this.Rl(t,this.onlineState)&&(this.Al(t),o=!0),this.Il=t,o},Uh.prototype.onError=function(t){this.Tl.error(t)},Uh.prototype.Rc=function(t){this.onlineState=t;var e=!1;return this.Il&&!this.El&&this.Rl(this.Il,t)&&(this.Al(this.Il),e=!0),e},Uh.prototype.Rl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Pl&&n||t.docs.M()&&"Offline"!==e)},Uh.prototype.ml=function(t){if(0<t.docChanges.length)return!0;var e=this.Il&&this.Il.hasPendingWrites!==t.hasPendingWrites;return!(!t.rs&&!e)&&!0===this.options.includeMetadataChanges},Uh.prototype.Al=function(t){t=As.os(t.query,t.docs,t.ns,t.fromCache),this.El=!0,this.Tl.next(t)},Uh),Sh=(Vh.prototype.Rh=function(t){this.Vl=t},Vh.prototype.Bn=function(e,i,r,o){var s=this;return i.te()||r.isEqual(Ui.min())?this.pl(e,i):this.Vl.qn(e,o).next(function(t){var n=s.yl(i,t);return(i.oe()||i.ae())&&s.wc(i.xt,n,o,r)?s.pl(e,i):(Ws()<=p.DEBUG&&Qs("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),i.toString()),s.Vl.Bn(e,i,r).next(function(e){return n.forEach(function(t){e=e.Re(t.key,t)}),e}))})},Vh.prototype.yl=function(n,t){var i=new os(function(t,e){return n.se(t,e)});return t.forEach(function(t,e){e instanceof Io&&n.matches(e)&&(i=i.add(e))}),i},Vh.prototype.wc=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.S(i))},Vh.prototype.pl=function(t,e){return Ws()<=p.DEBUG&&Qs("IndexFreeQueryEngine","Using full collection scan to execute query:",e.toString()),this.Vl.Bn(t,e,Ui.min())},Vh),Oh=(Ph.prototype.vl=function(t){return au.resolve(0===this.Dn.length)},Ph.prototype.bh=function(t,e,n,i){var r=this.gl;this.gl++,0<this.Dn.length&&this.Dn[this.Dn.length-1];var o=new su(r,e,n,i);this.Dn.push(o);for(var s=0,u=i;s<u.length;s++){var a=u[s];this.bl=this.bl.add(new Fu(a.key,r)),this.Fn.Ir(t,a.key.path.O())}return au.resolve(o)},Ph.prototype.Lh=function(t,e){return au.resolve(this.Sl(e))},Ph.prototype.eo=function(t,e){var n=e+1,i=this.Cl(n),r=i<0?0:i;return au.resolve(this.Dn.length>r?this.Dn[r]:null)},Ph.prototype.kh=function(){return au.resolve(0===this.Dn.length?-1:this.gl-1)},Ph.prototype.Ph=function(t){return au.resolve(this.Dn.slice())},Ph.prototype.$n=function(t,e){var n=this,i=new Fu(e,0),r=new Fu(e,Number.POSITIVE_INFINITY),o=[];return this.bl.Ge([i,r],function(t){var e=n.Sl(t.po);o.push(e)}),au.resolve(o)},Ph.prototype.xn=function(t,e){var i=this,r=new os(eu);return e.forEach(function(t){var e=new Fu(t,0),n=new Fu(t,Number.POSITIVE_INFINITY);i.bl.Ge([e,n],function(t){r=r.add(t.po)})}),au.resolve(this.Dl(r))},Ph.prototype.Gn=function(t,e){var n=e.path,i=n.length+1,r=n;$i.et(r)||(r=r.child(""));var o=new Fu(new $i(r),0),s=new os(eu);return this.bl.He(function(t){var e=t.key.path;return!!n.B(e)&&(e.length===i&&(s=s.add(t.po)),!0)},o),au.resolve(this.Dl(s))},Ph.prototype.Dl=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.Sl(t);null!==e&&i.push(e)}),i},Ph.prototype.Oh=function(n,i){var r=this;$s(0===this.Fl(i.batchId,"removed")),this.Dn.shift();var o=this.bl;return au.forEach(i.mutations,function(t){var e=new Fu(t.key,i.batchId);return o=o.delete(e),r.Kh.Nl(n,t.key)}).next(function(){r.bl=o})},Ph.prototype.$l=function(t){},Ph.prototype.Vo=function(t,e){var n=new Fu(e,0),i=this.bl.Ke(n);return au.resolve(e.isEqual(i&&i.key))},Ph.prototype.Nh=function(t){return this.Dn.length,au.resolve()},Ph.prototype.Fl=function(t,e){return this.Cl(t)},Ph.prototype.Cl=function(t){return 0===this.Dn.length?0:t-this.Dn[0].batchId},Ph.prototype.Sl=function(t){var e=this.Cl(t);return e<0||e>=this.Dn.length?null:this.Dn[e]},Ph),kh=(Lh.prototype.Gh=function(t,e,n){var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.Ll(e);return this.docs=this.docs.Re(i,{Ol:e,size:s,readTime:n}),this.size+=s-o,this.Fn.Ir(t,i.path.O())},Lh.prototype.jh=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Lh.prototype.On=function(t,e){var n=this.docs.get(e);return au.resolve(n?n.Ol:null)},Lh.prototype.getEntries=function(t,e){var n=this,i=fs();return e.forEach(function(t){var e=n.docs.get(t);i=i.Re(t,e?e.Ol:null)}),au.resolve(i)},Lh.prototype.Bn=function(t,e,n){for(var i=ps(),r=new $i(e.path.child("")),o=this.docs.ve(r);o.$e();){var s=o.Ne(),u=s.key,a=s.value,h=a.Ol,c=a.readTime;if(!e.path.B(u.path))break;c.S(n)<=0||h instanceof Io&&e.matches(h)&&(i=i.Re(h.key,h))}return au.resolve(i)},Lh.prototype.kl=function(t,e){return au.forEach(this.docs,function(t){return e(t)})},Lh.prototype.Ch=function(t){return new Lh.ql(this)},Lh.prototype.Ml=function(t){return au.resolve(this.size)},Lh);function Lh(t,e){this.Fn=t,this.Ll=e,this.docs=new Jo($i.N),this.size=0}function Ph(t,e){this.Fn=t,this.Kh=e,this.Dn=[],this.gl=1,this.bl=new os(Fu.do)}function Vh(){}function Uh(t,e,n){this.query=t,this.Tl=e,this.El=!1,this.Il=null,this.onlineState="Unknown",this.options=n||{}}function Mh(t){this.Su=t,this.cl=new ou(function(t){return t.canonicalId()}),this.onlineState="Unknown",this.ll=new Set,this.Su.subscribe(this)}function Ch(t,e,n,i,r,o){this.eu=t,this.Dc=e,this.ka=n,this.Fc=i,this.currentUser=r,this.Nc=o,this.$c=null,this.Lc=new ou(function(t){return t.canonicalId()}),this.Oc=new Map,this.kc=[],this.qc=new Jo($i.N),this.Mc=new Map,this.xc=new ju,this.Bc={},this.Uc=new Map,this.Qc=Au.Ar(),this.onlineState="Unknown"}function qh(t,e,n,i){this.Pr=t,this.ka=e,this.updateFunction=n,this.yr=i,this.pc=5,this.kr=new Eu(this.Pr,"transaction_retry")}function xh(t,e){this.query=t,this.oc=e,this.ac=null,this.ds=!1,this.uc=vs(),this.ns=vs(),this.cc=new Is(t.se.bind(t))}function jh(){this.zu=new Ih,this.Yu={},this.Su=null,this.Ga=null,this.Xn=null}function Fh(){this.activeTargetIds=ms()}function Bh(t,e,n,i,r){var o,s,u,a,h,c,f,l,p=this;this.eu=t,this.ka=e,this.Pr=n,this.su=[],this.iu=new Map,this.nu=null,this.networkEnabled=!1,this.isPrimary=!1,this.ru=!1,this.hu=r,this.hu.ou(function(t){n.Sr(function(){return d(p,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.au()?(Qs("RemoteStore","Restarting streams for network reachability change."),[4,this.uu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.cu=new bh(n,i),this.lu=(h=this.ka,c=n,f={Aa:this._u.bind(this),Ta:this.fu.bind(this),Va:this.du.bind(this)},l=Js(h),new vh(c,l.ia,l.credentials,l.serializer,f)),this.wu=(o=this.ka,s=n,u={Aa:this.Tu.bind(this),Ta:this.Eu.bind(this),Ca:this.Iu.bind(this),Sa:this.Sa.bind(this)},a=Js(o),new gh(s,a.ia,a.credentials,a.serializer,u))}function Gh(t,e){this.Pr=t,this.Ga=e,this.state="Unknown",this.Ha=0,this.Ka=null,this.za=!0}function zh(t){this.ka=t,this.qa=new Map,this.mutations=[],this.Ma=!1,this.xa=null,this.Ba=new Set}function Hh(t,e,n){var i=this;return(i=fh.call(this)||this).ia=t,i.credentials=e,i.serializer=n,i.Na=!1,i}function Wh(t,e,n,i,r){var o=this;return(o=lh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this).serializer=i,o.ga=!1,o.lastStreamToken=nr.ht,o}function Qh(t,e,n,i,r){var o=this;return(o=ph.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this).serializer=i,o}function Xh(t,e,n,i,r,o){this.sr=t,this.sa=n,this.ia=i,this.na=r,this.listener=o,this.state=0,this.ra=0,this.ha=null,this.stream=null,this.kr=new Eu(t,e)}function Yh(t){var e=this;return(e=dh.call(this)||this).jl=t,e}function Kh(){this.vh=new ou(function(t){return t.toString()}),this.xl=!1}kh.ql=(Object.defineProperty(Kh.prototype,"readTime",{get:function(){return this.Bl},set:function(t){this.Bl=t},enumerable:!0,configurable:!0}),Kh.prototype.Gh=function(t,e){this.Ul(),this.readTime=e,this.vh.set(t.key,t)},Kh.prototype.jh=function(t,e){this.Ul(),e&&(this.readTime=e),this.vh.set(t,null)},Kh.prototype.On=function(t,e){this.Ul();var n=this.vh.get(e);return void 0!==n?au.resolve(n):this.Ql(t,e)},Kh.prototype.getEntries=function(t,e){return this.Wl(t,e)},Kh.prototype.apply=function(t){return this.Ul(),this.xl=!0,this.Tc(t)},Kh.prototype.Ul=function(){},n(Yh,dh=Kh),Yh.prototype.Tc=function(n){var i=this,r=[];return this.vh.forEach(function(t,e){e?r.push(i.jl.Gh(n,e,i.readTime)):i.jl.jh(t)}),au.vn(r)},Yh.prototype.Ql=function(t,e){return this.jl.On(t,e)},Yh.prototype.Wl=function(t,e){return this.jl.getEntries(t,e)},Yh);var $h,Jh=(pc.prototype.js=function(t,n){return this.Gl.forEach(function(t,e){return n(e)}),au.resolve()},pc.prototype.qh=function(t){return au.resolve(this.lastRemoteSnapshotVersion)},pc.prototype.Yl=function(t){return au.resolve(this.Hl)},pc.prototype.ro=function(t){return this.highestTargetId=this.zl.next(),au.resolve(this.highestTargetId)},pc.prototype.zh=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hl&&(this.Hl=e),au.resolve()},pc.prototype.Xl=function(t){this.Gl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.zl=new Au(e),this.highestTargetId=e),t.sequenceNumber>this.Hl&&(this.Hl=t.sequenceNumber)},pc.prototype.ho=function(t,e){return this.Xl(e),this.targetCount+=1,au.resolve()},pc.prototype.Wh=function(t,e){return this.Xl(e),au.resolve()},pc.prototype.Jl=function(t,e){return this.Gl.delete(e.target),this.Kl.Ro(e.targetId),--this.targetCount,au.resolve()},pc.prototype.Zl=function(n,i,r){var o=this,s=0,u=[];return this.Gl.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.Gl.delete(t),u.push(o.t_(n,e.targetId)),s++)}),au.vn(u).next(function(){return s})},pc.prototype.e_=function(t){return au.resolve(this.targetCount)},pc.prototype.no=function(t,e){var n=this.Gl.get(e)||null;return au.resolve(n)},pc.prototype.Bh=function(t,e,n){return this.Kl.Eo(e,n),au.resolve()},pc.prototype.xh=function(e,t,n){this.Kl.mo(t,n);var i=this.persistence.Kh,r=[];return i&&t.forEach(function(t){r.push(i.Nl(e,t))}),au.vn(r)},pc.prototype.t_=function(t,e){return this.Kl.Ro(e),au.resolve()},pc.prototype.uo=function(t,e){var n=this.Kl.Po(e);return au.resolve(n)},pc.prototype.Vo=function(t,e){return au.resolve(this.Kl.Vo(e))},pc),Zh=(lc.prototype.start=function(){return Promise.resolve()},lc.prototype.yu=function(){return this.n_=!1,Promise.resolve()},Object.defineProperty(lc.prototype,"h_",{get:function(){return this.n_},enumerable:!0,configurable:!0}),lc.prototype.o_=function(){},lc.prototype.mh=function(){return this.Fn},lc.prototype.fh=function(t){var e=this.s_[t.s()];return e||(e=new Oh(this.Fn,this.Kh),this.s_[t.s()]=e),e},lc.prototype.Eh=function(){return this.Th},lc.prototype.wh=function(){return this.Cn},lc.prototype.runTransaction=function(t,e,n){var i=this;Qs("MemoryPersistence","Starting transaction:",t);var r=new tc(this.i_.next());return this.Kh.a_(),n(r).next(function(t){return i.Kh.u_(r).next(function(){return t})}).gn().then(function(t){return r.c_(),t})},lc.prototype.l_=function(e,n){return au.Sn(Object.values(this.s_).map(function(t){return function(){return t.Vo(e,n)}}))},lc),tc=(fc.prototype.f_=function(t){this.__.push(t)},fc.prototype.c_=function(){this.__.forEach(function(t){return t()})},n(cc,$h=fc),cc),ec=(hc.T_=function(t){return new hc(t)},Object.defineProperty(hc.prototype,"E_",{get:function(){if(this.w_)return this.w_;throw Ks()},enumerable:!0,configurable:!0}),hc.prototype.Jh=function(t,e,n){return this.d_.Jh(n,e),this.E_.delete(n),au.resolve()},hc.prototype.Zh=function(t,e,n){return this.d_.Zh(n,e),this.E_.add(n),au.resolve()},hc.prototype.Nl=function(t,e){return this.E_.add(e),au.resolve()},hc.prototype.removeTarget=function(t,e){var n=this;this.d_.Ro(e.targetId).forEach(function(t){return n.E_.add(t)});var i=this.persistence.Eh();return i.uo(t,e.targetId).next(function(t){t.forEach(function(t){return n.E_.add(t)})}).next(function(){return i.Jl(t,e)})},hc.prototype.a_=function(){this.w_=new Set},hc.prototype.u_=function(t){var n=this,i=this.persistence.wh().Ch();return au.forEach(this.E_,function(e){return n.I_(t,e).next(function(t){t||i.jh(e)})}).next(function(){return n.w_=null,i.apply(t)})},hc.prototype.Hh=function(t,e){var n=this;return this.I_(t,e).next(function(t){t?n.E_.delete(e):n.E_.add(e)})},hc.prototype.r_=function(t){return 0},hc.prototype.I_=function(t,e){var n=this;return au.Sn([function(){return au.resolve(n.d_.Vo(e))},function(){return n.persistence.Eh().Vo(t,e)},function(){return n.persistence.l_(t,e)}])},hc),nc="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",ic=(ac.prototype.initialize=function(n){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:return this.Fc=this.m_(n),this.persistence=this.R_(n),[4,this.persistence.start()];case 1:return t.sent(),this.A_=this.P_(n),this.eu=this.V_(n),this.Dc=this.p_(n),this.Su=this.y_(n),this.g_=this.b_(n),this.Fc.Ga=function(t){return e.Su.Rc(t,1)},this.Dc.Su=this.Su,[4,this.eu.start()];case 2:return t.sent(),[4,this.Fc.start()];case 3:return t.sent(),[4,this.Dc.start()];case 4:return t.sent(),[4,this.Dc.ju(this.Su.Wc)];case 5:return t.sent(),[2]}})})},ac.prototype.b_=function(t){return new Rh(this.Su)},ac.prototype.P_=function(t){return null},ac.prototype.V_=function(t){return new Cu(this.persistence,new Sh,t.v_)},ac.prototype.R_=function(t){if(t.C_.S_)throw new Si(Di.FAILED_PRECONDITION,nc);return new Zh(ec.T_)},ac.prototype.p_=function(t){var e=this;return new Eh(this.eu,t.ka,t.Pr,function(t){return e.Su.Rc(t,0)},t.platform.D_())},ac.prototype.m_=function(t){return new Th},ac.prototype.y_=function(t){return new _h(this.eu,this.Dc,t.ka,this.Fc,t.v_,t.Nc)},ac.prototype.clearPersistence=function(t){throw new Si(Di.FAILED_PRECONDITION,nc)},ac),rc=(uc.prototype.start=function(e,n){var i=this;this.$a();var r=new bu,o=new bu,s=!1;return this.credentials._(function(t){if(!s)return s=!0,Qs("FirestoreClient","Initializing. user=",t.uid),i.N_(e,n,t,o).then(r.resolve,r.reject);i.Pr.jr(function(){return i.Wu(t)})}),this.Pr.Sr(function(){return r.promise}),o.promise},uc.prototype.enableNetwork=function(){var t=this;return this.$a(),this.Pr.enqueue(function(){return t.Su.enableNetwork()})},uc.prototype.N_=function(a,h,c,f){return d(this,void 0,void 0,function(){var i,r,o,s,u=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,this.platform.L_(this.F_)];case 1:return i=t.sent(),r=this.platform.Yo(this.F_.ii),e=i,n=this.credentials,o=new mh(e,n,r),[4,a.initialize({Pr:this.Pr,F_:this.F_,platform:this.platform,ka:o,clientId:this.clientId,v_:c,Nc:100,C_:h})];case 2:return t.sent(),this.persistence=a.persistence,this.Fc=a.Fc,this.eu=a.eu,this.Dc=a.Dc,this.Su=a.Su,this.A_=a.A_,this.O_=a.g_,this.persistence.o_(function(){return d(u,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),f.resolve(),[3,4];case 3:if(s=t.sent(),f.reject(s),!this.k_(s))throw s;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+s),this.N_(new ic,{S_:!1},c,f))];case 4:return[2]}var e,n})})},uc.prototype.k_=function(t){return"FirebaseError"===t.name?t.code===Di.FAILED_PRECONDITION||t.code===Di.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},uc.prototype.$a=function(){if(this.Pr.Mr)throw new Si(Di.FAILED_PRECONDITION,"The client has already been terminated.")},uc.prototype.Wu=function(t){return this.Pr.Hr(),Qs("FirestoreClient","Credential Changed. Current user: "+t.uid),this.Su.Wu(t)},uc.prototype.disableNetwork=function(){var t=this;return this.$a(),this.Pr.enqueue(function(){return t.Su.disableNetwork()})},uc.prototype.terminate=function(){var t=this;return this.Pr.Wr(function(){return d(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.A_&&this.A_.stop(),[4,this.Dc.yu()];case 1:return t.sent(),[4,this.Fc.yu()];case 2:return t.sent(),[4,this.persistence.yu()];case 3:return t.sent(),this.credentials.T(),[2]}})})})},uc.prototype.waitForPendingWrites=function(){var t=this;this.$a();var e=new bu;return this.Pr.Sr(function(){return t.Su.el(e)}),e.promise},uc.prototype.listen=function(t,e,n){var i=this;this.$a();var r=new Dh(t,e,n);return this.Pr.Sr(function(){return i.O_.listen(r)}),r},uc.prototype.bu=function(t){var e=this;this.q_||this.Pr.Sr(function(){return e.O_.bu(t)})},uc.prototype.M_=function(o){return d(this,void 0,void 0,function(){var r,e=this;return y(this,function(t){switch(t.label){case 0:return this.$a(),r=new bu,[4,this.Pr.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.eu.so(o)];case 1:return(e=t.sent())instanceof Io?r.resolve(e):e instanceof To?r.resolve(null):r.reject(new Si(Di.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),i=Vu(n,"Failed to get document '"+o+" from cache"),r.reject(i),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),r.promise)]}})})},uc.prototype.x_=function(a){return d(this,void 0,void 0,function(){var u,e=this;return y(this,function(t){switch(t.label){case 0:return this.$a(),u=new bu,[4,this.Pr.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.eu.ao(a,!0)];case 1:return e=t.sent(),n=new Ah(a,e.co),i=n._c(e.documents),r=n.Tc(i,!1),u.resolve(r.snapshot),[3,3];case 2:return o=t.sent(),s=Vu(o,"Failed to execute query '"+a+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})},uc.prototype.write=function(t){var e=this;this.$a();var n=new bu;return this.Pr.Sr(function(){return e.Su.write(t,n)}),n.promise},uc.prototype.ii=function(){return this.F_.ii},uc.prototype.dl=function(t){var e=this;this.$a(),this.Pr.Sr(function(){return e.O_.dl(t),Promise.resolve()})},uc.prototype.wl=function(t){var e=this;this.q_||this.Pr.Sr(function(){return e.O_.wl(t),Promise.resolve()})},Object.defineProperty(uc.prototype,"q_",{get:function(){return this.Pr.Mr},enumerable:!0,configurable:!0}),uc.prototype.transaction=function(t){var e=this;this.$a();var n=new bu;return this.Pr.Sr(function(){return e.Su.runTransaction(e.Pr,t,n),Promise.resolve()}),n.promise},uc),oc=(sc.prototype.next=function(t){this.B_(this.observer.next,t)},sc.prototype.error=function(t){this.B_(this.observer.error,t)},sc.prototype.U_=function(){this.muted=!0},sc.prototype.B_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},sc);function sc(t){this.observer=t,this.muted=!1}function uc(t,e,n,i){this.platform=t,this.F_=e,this.credentials=n,this.Pr=i,this.clientId=Zs.cn()}function ac(){}function hc(t){this.persistence=t,this.d_=new ju,this.w_=null}function cc(t){var e=this;return(e=$h.call(this)||this).Uh=t,e}function fc(){this.__=[]}function lc(t){var e=this;this.s_={},this.i_=new fu(0),this.n_=!1,this.n_=!0,this.Kh=t(this),this.Th=new Jh(this),this.Fn=new Iu,this.Cn=new kh(this.Fn,function(t){return e.Kh.r_(t)})}function pc(t){this.persistence=t,this.Gl=new ou(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Ui.min(),this.highestTargetId=0,this.Hl=0,this.Kl=new ju,this.targetCount=0,this.zl=Au.Rr()}function dc(r){return function(){if("object"==typeof r&&null!==r)for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return 1}}()}var yc,vc,gc,mc=(Bc.prototype.j_=function(t){switch(hr(t)){case 0:return null;case 1:return t.booleanValue;case 2:return vr(t.integerValue||t.doubleValue);case 3:return this.G_(t.timestampValue);case 4:return this.H_(t);case 5:return t.stringValue;case 6:return new pa(gr(t.bytesValue));case 7:return this.K_(t.referenceValue);case 8:return this.z_(t.geoPointValue);case 9:return this.Y_(t.arrayValue);case 10:return this.X_(t.mapValue);default:throw Ks()}},Bc.prototype.X_=function(t){var n=this,i={};return tr(t.fields||{},function(t,e){i[t]=n.j_(e)}),i},Bc.prototype.z_=function(t){return new Pa(vr(t.latitude),vr(t.longitude))},Bc.prototype.Y_=function(t){var e=this;return(t.values||[]).map(function(t){return e.j_(t)})},Bc.prototype.H_=function(t){switch(this.Q_){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return sr(n)?t(n):n}(t);return null==e?null:this.j_(e);case"estimate":return this.G_(ur(t));default:return null}},Bc.prototype.G_=function(t){var e=yr(t),n=new Vi(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Bc.prototype.K_=function(t){var e=Ci.G(t);$s(Bs(e));var n=new ru(e.get(1),e.get(3)),i=new $i(e.L(5));return n.isEqual(this.ii)||Xs("Document "+i+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.ii.projectId+"/"+this.ii.database+") instead."),this.W_(i)},Bc),wc=Uu.nh,bc=(Fc.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Fc),Ec=(Object.defineProperty(jc.prototype,"af",{get:function(){return this.uf||(this.uf=new Ka(this.xo,this.hf.ignoreUndefinedProperties)),this.uf},enumerable:!0,configurable:!0}),jc.prototype.settings=function(t){Hu("Firestore.settings",arguments,1),Xu("Firestore.settings","object",1,t);var e=new bc(t);if(this.ef&&!this.hf.isEqual(e))throw new Si(Di.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.hf=e).credentials&&(this.nf=function(t){if(!t)return new Oi;switch(t.type){case"gapi":var e=t.cf;return $s(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Pi(e,t.V||"0");case"provider":return t.cf;default:throw new Si(Di.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},jc.prototype.enableNetwork=function(){return this.tf(),this.ef.enableNetwork()},jc.prototype.disableNetwork=function(){return this.tf(),this.ef.disableNetwork()},jc.prototype.enablePersistence=function(t){var e,n;if(this.ef)throw new Si(Di.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var i=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Xs("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),i=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,i&&r))throw new Si(Di.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.lf(this.rf,{S_:!0,cacheSizeBytes:this.hf.cacheSizeBytes,synchronizeTabs:i,_f:r})},jc.prototype.clearPersistence=function(){return d(this,void 0,void 0,function(){var i,e=this;return y(this,function(t){if(void 0!==this.ef&&!this.ef.q_)throw new Si(Di.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return i=new bu,[2,(this.Z_.xr(function(){return d(e,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.ff(),[4,this.rf.clearPersistence(e)];case 1:return t.sent(),i.resolve(),[3,3];case 2:return n=t.sent(),i.reject(n),[3,3];case 3:return[2]}})})}),i.promise)]})})},jc.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(jc.prototype,"df",{get:function(){return this.tf(),this.ef.q_},enumerable:!0,configurable:!0}),jc.prototype.waitForPendingWrites=function(){return this.tf(),this.ef.waitForPendingWrites()},jc.prototype.onSnapshotsInSync=function(t){if(this.tf(),dc(t))return this.wf(t);Xu("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.wf(e)},jc.prototype.wf=function(t){var e=this,n=new oc({next:function(){t.next&&t.next()},error:function(t){throw Ks()}});return this.ef.dl(n),function(){n.U_(),e.ef.wl(n)}},jc.prototype.tf=function(){return this.ef||this.lf(new ic,{S_:!1}),this.ef},jc.prototype.ff=function(){return new iu(this.xo,this.if,this.hf.host,this.hf.ssl,this.hf.forceLongPolling)},jc.prototype.lf=function(t,e){var n=this.ff();return this.ef=new rc(Gs.nt(),n,this.nf,this.Z_),this.ef.start(t,e)},jc.sf=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Si(Di.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Si(Di.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new ru(n)},Object.defineProperty(jc.prototype,"app",{get:function(){if(!this.J_)throw new Si(Di.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.J_},enumerable:!0,configurable:!0}),jc.prototype.collection=function(t){return Hu("Firestore.collection",arguments,1),Xu("Firestore.collection","non-empty string",1,t),this.tf(),new Oc(Ci.G(t),this,null)},jc.prototype.doc=function(t){return Hu("Firestore.doc",arguments,1),Xu("Firestore.doc","non-empty string",1,t),this.tf(),Ac.Tf(Ci.G(t),this,null)},jc.prototype.collectionGroup=function(t){if(Hu("Firestore.collectionGroup",arguments,1),Xu("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Si(Di.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.tf(),new Dc(new _o(Ci.H,t),this,null)},jc.prototype.runTransaction=function(e){var n=this;return Hu("Firestore.runTransaction",arguments,1),Xu("Firestore.runTransaction","function",1,e),this.tf().transaction(function(t){return e(new Ic(n,t))})},jc.prototype.batch=function(){return this.tf(),new Tc(this)},Object.defineProperty(jc,"logLevel",{get:function(){switch(Ws()){case p.DEBUG:return"debug";case p.ERROR:return"error";case p.SILENT:return"silent";case p.WARN:return"warn";case p.INFO:return"info";case p.VERBOSE:return"verbose";default:return"error"}},enumerable:!0,configurable:!0}),jc.setLogLevel=function(t){Hu("Firestore.setLogLevel",arguments,1),Zu("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),zs.setLogLevel(t)},jc.prototype.Ef=function(){return this.hf.timestampsInSnapshots},jc),Ic=(xc.prototype.get=function(t){var n=this;Hu("Transaction.get",arguments,1);var i=Wc("Transaction.get",t,this.If);return this.mf.Ua([i.Bo]).then(function(t){if(!t||1!==t.length)return Ks();var e=t[0];if(e instanceof To)return new _c(n.If,i.Bo,null,!1,!1,i.Uo);if(e instanceof Io)return new _c(n.If,i.Bo,e,!1,!1,i.Uo);throw Ks()})},xc.prototype.set=function(t,e,n){Qu("Transaction.set",arguments,2,3);var i=Wc("Transaction.set",t,this.If);n=Gc("Transaction.set",n);var r=Qc(i.Uo,e,"Transaction.set"),o=r[0],s=r[1],u=this.If.af.Xo(s,o,n);return this.mf.set(i.Bo,u),this},xc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof da?(Wu("Transaction.update",arguments,3),i=Wc("Transaction.update",t,this.If),this.If.af.ta("Transaction.update",e,n,o)):(Hu("Transaction.update",arguments,2),i=Wc("Transaction.update",t,this.If),this.If.af.Zo("Transaction.update",e)),this.mf.update(i.Bo,r),this},xc.prototype.delete=function(t){Hu("Transaction.delete",arguments,1);var e=Wc("Transaction.delete",t,this.If);return this.mf.delete(e.Bo),this},xc),Tc=(qc.prototype.set=function(t,e,n){Qu("WriteBatch.set",arguments,2,3),this.Pf();var i=Wc("WriteBatch.set",t,this.If);n=Gc("WriteBatch.set",n);var r=Qc(i.Uo,e,"WriteBatch.set"),o=r[0],s=r[1],u=this.If.af.Xo(s,o,n);return this.Rf=this.Rf.concat(u.Qo(i.Bo,Fr.dt())),this},qc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Pf(),r="string"==typeof e||e instanceof da?(Wu("WriteBatch.update",arguments,3),i=Wc("WriteBatch.update",t,this.If),this.If.af.ta("WriteBatch.update",e,n,o)):(Hu("WriteBatch.update",arguments,2),i=Wc("WriteBatch.update",t,this.If),this.If.af.Zo("WriteBatch.update",e)),this.Rf=this.Rf.concat(r.Qo(i.Bo,Fr.exists(!0))),this},qc.prototype.delete=function(t){Hu("WriteBatch.delete",arguments,1),this.Pf();var e=Wc("WriteBatch.delete",t,this.If);return this.Rf=this.Rf.concat(new Wr(e.Bo,Fr.dt())),this},qc.prototype.commit=function(){return this.Pf(),this.Af=!0,0<this.Rf.length?this.If.tf().write(this.Rf):Promise.resolve()},qc.prototype.Pf=function(){if(this.Af)throw new Si(Di.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},qc),Ac=(n(Cc,gc=Ua),Cc.Tf=function(t,e,n){if(t.length%2!=0)throw new Si(Di.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.j()+" has "+t.length);return new Cc(new $i(t),e,n)},Object.defineProperty(Cc.prototype,"id",{get:function(){return this.Bo.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(Cc.prototype,"parent",{get:function(){return new Oc(this.Bo.path.O(),this.firestore,this.Uo)},enumerable:!0,configurable:!0}),Object.defineProperty(Cc.prototype,"path",{get:function(){return this.Bo.path.j()},enumerable:!0,configurable:!0}),Cc.prototype.collection=function(t){if(Hu("DocumentReference.collection",arguments,1),Xu("DocumentReference.collection","non-empty string",1,t),!t)throw new Si(Di.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Ci.G(t);return new Oc(this.Bo.path.child(e),this.firestore,null)},Cc.prototype.isEqual=function(t){if(!(t instanceof Cc))throw oa("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Bo.isEqual(t.Bo)&&this.Uo===t.Uo},Cc.prototype.set=function(t,e){Qu("DocumentReference.set",arguments,1,2),e=Gc("DocumentReference.set",e);var n=Qc(this.Uo,t,"DocumentReference.set"),i=n[0],r=n[1],o=this.firestore.af.Xo(r,i,e);return this.ef.write(o.Qo(this.Bo,Fr.dt()))},Cc.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof da?(Wu("DocumentReference.update",arguments,2),this.firestore.af.ta("DocumentReference.update",t,e,i)):(Hu("DocumentReference.update",arguments,1),this.firestore.af.Zo("DocumentReference.update",t)),this.ef.write(n.Qo(this.Bo,Fr.exists(!0)))},Cc.prototype.delete=function(){return Hu("DocumentReference.delete",arguments,0),this.ef.write([new Wr(this.Bo,Fr.dt())])},Cc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Qu("DocumentReference.onSnapshot",arguments,1,4);var n,i={includeMetadataChanges:!1},r=0;"object"!=typeof t[r]||dc(t[r])||(ra("DocumentReference.onSnapshot",i=t[r],["includeMetadataChanges"]),$u("DocumentReference.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++);var o={includeMetadataChanges:i.includeMetadataChanges};return n=dc(t[r])?t[r]:(Xu("DocumentReference.onSnapshot","function",r,t[r]),Yu("DocumentReference.onSnapshot","function",r+1,t[r+1]),Yu("DocumentReference.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.Vf(o,n)},Cc.prototype.Vf=function(t,n){var i=this,e=function(t){console.error("Uncaught Error in onSnapshot:",t)};n.error&&(e=n.error.bind(n));var r=new oc({next:function(t){if(n.next){var e=t.docs.get(i.Bo);n.next(new _c(i.firestore,i.Bo,e,t.fromCache,t.hasPendingWrites,i.Uo))}},error:e}),o=this.ef.listen(_o.Wt(this.Bo.path),r,t);return function(){r.U_(),i.ef.bu(o)}},Cc.prototype.get=function(n){var i=this;return Qu("DocumentReference.get",arguments,0,1),Hc("DocumentReference.get",n),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.tf().M_(i.Bo).then(function(t){e(new _c(i.firestore,i.Bo,t,!0,t instanceof Io&&t.At,i.Uo))},t):i.pf(e,t,n)})},Cc.prototype.pf=function(e,n,i){var r=this.Vf({includeMetadataChanges:!0,Pl:!0},{next:function(t){r(),!t.exists&&t.metadata.fromCache?n(new Si(Di.UNAVAILABLE,"Failed to get document because the client is offline.")):t.exists&&t.metadata.fromCache&&i&&"server"===i.source?n(new Si(Di.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(t)},error:n})},Cc.prototype.withConverter=function(t){return new Cc(this.Bo,this.firestore,t)},Cc),Nc=(Mc.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Mc),_c=(Uc.prototype.data=function(t){var e=this;if(Qu("DocumentSnapshot.data",arguments,0,1),t=zc("DocumentSnapshot.data",t),this.yf){if(this.Uo){var n=new Rc(this.If,this.Bo,this.yf,this.gf,this.bf,null);return this.Uo.fromFirestore(n,t)}return new mc(this.If.xo,this.If.Ef(),t.serverTimestamps||"none",function(t){return new Ac(t,e.If,null)}).j_(this.yf.Ot())}},Uc.prototype.get=function(t,e){var n=this;if(Qu("DocumentSnapshot.get",arguments,1,2),e=zc("DocumentSnapshot.get",e),this.yf){var i=this.yf.data().field(ih("DocumentSnapshot.get",t));if(null!==i)return new mc(this.If.xo,this.If.Ef(),e.serverTimestamps||"none",function(t){return new Ac(t,n.If,n.Uo)}).j_(i)}},Object.defineProperty(Uc.prototype,"id",{get:function(){return this.Bo.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(Uc.prototype,"ref",{get:function(){return new Ac(this.Bo,this.If,this.Uo)},enumerable:!0,configurable:!0}),Object.defineProperty(Uc.prototype,"exists",{get:function(){return null!==this.yf},enumerable:!0,configurable:!0}),Object.defineProperty(Uc.prototype,"metadata",{get:function(){return new Nc(this.bf,this.gf)},enumerable:!0,configurable:!0}),Uc.prototype.isEqual=function(t){if(!(t instanceof Uc))throw oa("isEqual","DocumentSnapshot",1,t);return this.If===t.If&&this.gf===t.gf&&this.Bo.isEqual(t.Bo)&&(null===this.yf?null===t.yf:this.yf.isEqual(t.yf))&&this.Uo===t.Uo},Uc),Rc=(n(Vc,vc=_c),Vc.prototype.data=function(t){return vc.prototype.data.call(this,t)},Vc),Dc=(Pc.prototype.where=function(t,e,n){Hu("Query.where",arguments,3),ia("Query.where",3,n);var i,r=Zu("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),o=ih("Query.where",t);if(o.Y()){if("array-contains"===r||"array-contains-any"===r)throw new Si(Di.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+r+"' queries on FieldPath.documentId().");if("in"===r){this.Sf(n,r);for(var s=[],u=0,a=n;u<a.length;u++){var h=a[u];s.push(this.Cf(h))}i={arrayValue:{values:s}}}else i=this.Cf(n)}else"in"!==r&&"array-contains-any"!==r||this.Sf(n,r),i=this.firestore.af.ea("Query.where",n,"in"===r);var c=Ro.create(o,r,i);return this.Df(c),new Pc(this.vf.Ht(c),this.firestore,this.Uo)},Pc.prototype.orderBy=function(t,e){var n;if(Qu("Query.orderBy",arguments,1,2),Yu("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Si(Di.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}if(null!==this.vf.startAt)throw new Si(Di.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.vf.endAt)throw new Si(Di.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=ih("Query.orderBy",t),r=new Vo(i,n);return this.Ff(r),new Pc(this.vf.Kt(r),this.firestore,this.Uo)},Pc.prototype.limit=function(t){return Hu("Query.limit",arguments,1),Xu("Query.limit","number",1,t),sa("Query.limit",1,t),new Pc(this.vf.zt(t),this.firestore,this.Uo)},Pc.prototype.limitToLast=function(t){return Hu("Query.limitToLast",arguments,1),Xu("Query.limitToLast","number",1,t),sa("Query.limitToLast",1,t),new Pc(this.vf.Yt(t),this.firestore,this.Uo)},Pc.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Wu("Query.startAt",arguments,1);var i=this.Nf("Query.startAt",t,e,!0);return new Pc(this.vf.Xt(i),this.firestore,this.Uo)},Pc.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Wu("Query.startAfter",arguments,1);var i=this.Nf("Query.startAfter",t,e,!1);return new Pc(this.vf.Xt(i),this.firestore,this.Uo)},Pc.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Wu("Query.endBefore",arguments,1);var i=this.Nf("Query.endBefore",t,e,!0);return new Pc(this.vf.Jt(i),this.firestore,this.Uo)},Pc.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Wu("Query.endAt",arguments,1);var i=this.Nf("Query.endAt",t,e,!1);return new Pc(this.vf.Jt(i),this.firestore,this.Uo)},Pc.prototype.isEqual=function(t){if(!(t instanceof Pc))throw oa("isEqual","Query",1,t);return this.firestore===t.firestore&&this.vf.isEqual(t.vf)&&this.Uo===t.Uo},Pc.prototype.withConverter=function(t){return new Pc(this.vf,this.firestore,t)},Pc.prototype.Nf=function(t,e,n,i){if(ia(t,1,e),e instanceof _c){if(0<n.length)throw new Si(Di.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var r=e;if(!r.exists)throw new Si(Di.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.$f(r.yf,i)}var o=[e].concat(n);return this.Lf(t,o,i)},Pc.prototype.$f=function(t,e){for(var n=[],i=0,r=this.vf.orderBy;i<r.length;i++){var o=r[i];if(o.field.Y())n.push(mr(this.firestore.xo,t.key));else{var s=t.field(o.field);if(sr(s))throw new Si(Di.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=o.field.j();throw new Si(Di.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}n.push(s)}}return new Po(n,e)},Pc.prototype.Lf=function(t,e,n){var i=this.vf.Mt;if(e.length>i.length)throw new Si(Di.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var r=[],o=0;o<e.length;o++){var s=e[o];if(i[o].field.Y()){if("string"!=typeof s)throw new Si(Di.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.vf.le()&&-1!==s.indexOf("/"))throw new Si(Di.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.vf.path.child(Ci.G(s));if(!$i.et(u))throw new Si(Di.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new $i(u);r.push(mr(this.firestore.xo,a))}else{var h=this.firestore.af.ea(t,s);r.push(h)}}return new Po(r,n)},Pc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Qu("Query.onSnapshot",arguments,1,4);var n,i={},r=0;return"object"!=typeof t[r]||dc(t[r])||(ra("Query.onSnapshot",i=t[r],["includeMetadataChanges"]),$u("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++),n=dc(t[r])?t[r]:(Xu("Query.onSnapshot","function",r,t[r]),Yu("Query.onSnapshot","function",r+1,t[r+1]),Yu("Query.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.Of(this.vf),this.Vf(i,n)},Pc.prototype.Vf=function(t,e){var n=this,i=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(i=e.error.bind(e));var r=new oc({next:function(t){e.next&&e.next(new Sc(n.firestore,n.vf,t,n.Uo))},error:i}),o=this.firestore.tf(),s=o.listen(this.vf,r,t);return function(){r.U_(),o.bu(s)}},Pc.prototype.Of=function(t){if(t.ae()&&0===t.Mt.length)throw new Si(Di.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},Pc.prototype.get=function(n){var i=this;return Qu("Query.get",arguments,0,1),Hc("Query.get",n),this.Of(this.vf),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.tf().x_(i.vf).then(function(t){e(new Sc(i.firestore,i.vf,t,i.Uo))},t):i.pf(e,t,n)})},Pc.prototype.pf=function(e,n,i){var r=this.Vf({includeMetadataChanges:!0,Pl:!0},{next:function(t){r(),t.metadata.fromCache&&i&&"server"===i.source?n(new Si(Di.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(t)},error:n})},Pc.prototype.Cf=function(t){if("string"==typeof t){if(""===t)throw new Si(Di.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.vf.le()&&-1!==t.indexOf("/"))throw new Si(Di.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.vf.path.child(Ci.G(t));if(!$i.et(e))throw new Si(Di.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return mr(this.firestore.xo,new $i(e))}if(t instanceof Ac){var n=t;return mr(this.firestore.xo,n.Bo)}throw new Si(Di.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+na(t)+".")},Pc.prototype.Sf=function(t,e){if(!Array.isArray(t)||0===t.length)throw new Si(Di.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Si(Di.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Si(Di.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Si(Di.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},Pc.prototype.Df=function(t){if(t instanceof Ro){var e=["array-contains","array-contains-any"],n=["in","array-contains-any"],i=0<=e.indexOf(t.op),r=0<=n.indexOf(t.op);if(t.ue()){var o=this.vf.jt();if(null!==o&&!o.isEqual(t.field))throw new Si(Di.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.vf.Gt();null!==s&&this.kf(t.field,s)}else if(r||i){var u=null;if(r&&(u=this.vf.ce(n)),null===u&&i&&(u=this.vf.ce(e)),null!=u)throw u===t.op?new Si(Di.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Si(Di.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},Pc.prototype.Ff=function(t){if(null===this.vf.Gt()){var e=this.vf.jt();null!==e&&this.kf(e,t.field)}},Pc.prototype.kf=function(t,e){if(!e.isEqual(t))throw new Si(Di.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},Pc),Sc=(Object.defineProperty(Lc.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(Lc.prototype,"empty",{get:function(){return this.Mf.docs.M()},enumerable:!0,configurable:!0}),Object.defineProperty(Lc.prototype,"size",{get:function(){return this.Mf.docs.size},enumerable:!0,configurable:!0}),Lc.prototype.forEach=function(e,n){var i=this;Qu("QuerySnapshot.forEach",arguments,1,2),Xu("QuerySnapshot.forEach","function",1,e),this.Mf.docs.forEach(function(t){e.call(n,i.Uf(t))})},Object.defineProperty(Lc.prototype,"query",{get:function(){return new Dc(this.qf,this.If,this.Uo)},enumerable:!0,configurable:!0}),Lc.prototype.docChanges=function(t){t&&(ra("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),$u("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Mf.hs)throw new Si(Di.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.xf&&this.Bf===e||(this.xf=function(r,e,o,s){if(o.ss.M()){var n=0;return o.docChanges.map(function(t){var e=new Rc(r,t.doc.key,t.doc,o.fromCache,o.ns.has(t.doc.key),s);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var u=o.ss;return o.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Rc(r,t.doc.key,t.doc,o.fromCache,o.ns.has(t.doc.key),s),n=-1,i=-1;return 0!==t.type&&(n=u.indexOf(t.doc.key),u=u.delete(t.doc.key)),1!==t.type&&(i=(u=u.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ks()}}(t.type),doc:e,oldIndex:n,newIndex:i}})}(this.If,e,this.Mf,this.Uo),this.Bf=e),this.xf},Lc.prototype.isEqual=function(t){if(!(t instanceof Lc))throw oa("isEqual","QuerySnapshot",1,t);return this.If===t.If&&this.qf.isEqual(t.qf)&&this.Mf.isEqual(t.Mf)&&this.Uo===t.Uo},Lc.prototype.Uf=function(t){return new Rc(this.If,t.key,t,this.metadata.fromCache,this.Mf.ns.has(t.key),this.Uo)},Lc),Oc=(n(kc,yc=Dc),Object.defineProperty(kc.prototype,"id",{get:function(){return this.vf.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(kc.prototype,"parent",{get:function(){var t=this.vf.path.O();return t.M()?null:new Ac(new $i(t),this.firestore,null)},enumerable:!0,configurable:!0}),Object.defineProperty(kc.prototype,"path",{get:function(){return this.vf.path.j()},enumerable:!0,configurable:!0}),kc.prototype.doc=function(t){Qu("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Zs.cn()),Xu("CollectionReference.doc","non-empty string",1,t);var e=Ci.G(t);return Ac.Tf(this.vf.path.child(e),this.firestore,this.Uo)},kc.prototype.add=function(t){Hu("CollectionReference.add",arguments,1),Xu("CollectionReference.add","object",1,this.Uo?this.Uo.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},kc.prototype.withConverter=function(t){return new kc(this.Qf,this.firestore,t)},kc);function kc(t,e,n){var i=this;if(((i=yc.call(this,_o.Wt(t),e,n)||this).Qf=t).length%2!=1)throw new Si(Di.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.j()+" has "+t.length);return i}function Lc(t,e,n,i){this.If=t,this.qf=e,this.Mf=n,this.Uo=i,this.xf=null,this.Bf=null,this.metadata=new Nc(n.hasPendingWrites,n.fromCache)}function Pc(t,e,n){this.vf=t,this.firestore=e,this.Uo=n}function Vc(){return null!==vc&&vc.apply(this,arguments)||this}function Uc(t,e,n,i,r,o){this.If=t,this.Bo=e,this.yf=n,this.gf=i,this.bf=r,this.Uo=o}function Mc(t,e){this.hasPendingWrites=t,this.fromCache=e}function Cc(t,e,n){var i=this;return(i=gc.call(this,e.xo,t,n)||this).Bo=t,i.firestore=e,i.Uo=n,i.ef=i.firestore.tf(),i}function qc(t){this.If=t,this.Rf=[],this.Af=!1}function xc(t,e){this.If=t,this.mf=e}function jc(t,e,n){var i=this;if(void 0===n&&(n=new ic),this.J_=null,this.Z_=new ku,this.INTERNAL={delete:function(){return d(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.tf(),[4,this.ef.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var r=t;this.J_=r,this.xo=jc.sf(r),this.if=r.name,this.nf=new ki(e)}else{var o=t;if(!o.projectId)throw new Si(Di.INVALID_ARGUMENT,"Must provide projectId");this.xo=new ru(o.projectId,o.database),this.if="[DEFAULT]",this.nf=new Oi}this.rf=n,this.hf=new bc({})}function Fc(t){var e,n,i,r;if(void 0===t.host){if(void 0!==t.ssl)throw new Si(Di.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Ku("settings","non-empty string","host",t.host),this.host=t.host,$u("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(ra("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),$u("settings","object","credentials",t.credentials),this.credentials=t.credentials,$u("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),$u("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Xs("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Xs("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(i=t.ignoreUndefinedProperties)&&void 0!==i&&i,$u("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Uu.hh;else{if(t.cacheSizeBytes!==wc&&t.cacheSizeBytes<Uu.rh)throw new Si(Di.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Uu.rh);this.cacheSizeBytes=t.cacheSizeBytes}$u("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(r=t.experimentalForceLongPolling)&&void 0!==r&&r}function Bc(t,e,n,i){this.ii=t,this.timestampsInSnapshots=e,this.Q_=n,this.W_=i}function Gc(t,e){if(void 0===e)return{merge:!1};if(ra(t,e,["merge","mergeFields"]),$u(t,"boolean","merge",e.merge),n=t,void 0!==(i=e.mergeFields)&&function(t,e,n,i){if(!(n instanceof Array))throw new Si(Di.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+na(n));for(var r=0;r<n.length;++r)if(!i(n[r]))throw new Si(Di.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+r+" was: "+na(n[r]))}(n,"mergeFields",i,function(t){return"string"==typeof t||t instanceof da}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Si(Di.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n,i;return e}function zc(t,e){return void 0===e?{}:(ra(t,e,["serverTimestamps"]),Ju(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Hc(t,e){Yu(t,"object",1,e),e&&(ra(t,e,["source"]),Ju(t,0,"source",e.source,["default","server","cache"]))}function Wc(t,e,n){if(e instanceof Ua){if(e.firestore!==n)throw new Si(Di.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw oa(t,"DocumentReference",1,e)}function Qc(t,e,n){var i;return t?(i=t.toFirestore(e),n="toFirestore() in "+n):i=e,[i,n]}function Xc(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new Si(Di.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}var Yc,Kc=Xc(Ec,"Use firebase.firestore() instead."),$c=Xc(Ic,"Use firebase.firestore().runTransaction() instead."),Jc=Xc(Tc,"Use firebase.firestore().batch() instead."),Zc=Xc(Ac,"Use firebase.firestore().doc() instead."),tf=Xc(_c),ef=Xc(Rc),nf=Xc(Dc),rf=Xc(Sc),of=Xc(Oc,"Use firebase.firestore().collection() instead."),sf=Xc(ka,"Use FieldValue.<field>() instead."),uf=Xc(pa,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),af={Firestore:Kc,GeoPoint:Pa,Timestamp:Vi,Blob:uf,Transaction:$c,WriteBatch:Jc,DocumentReference:Zc,DocumentSnapshot:tf,Query:nf,QueryDocumentSnapshot:ef,QuerySnapshot:rf,CollectionReference:of,FieldPath:da,FieldValue:sf,setLogLevel:Ec.setLogLevel,CACHE_SIZE_UNLIMITED:wc},hf=(mf.prototype.ou=function(t){},mf.prototype.yu=function(){},mf),cf=(gf.prototype.ou=function(t){this.Kf.push(t)},gf.prototype.yu=function(){window.removeEventListener("online",this.Wf),window.removeEventListener("offline",this.Gf)},gf.prototype.zf=function(){window.addEventListener("online",this.Wf),window.addEventListener("offline",this.Gf)},gf.prototype.jf=function(){Qs("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Kf;t<e.length;t++)(0,e[t])(0)},gf.prototype.Hf=function(){Qs("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Kf;t<e.length;t++)(0,e[t])(1)},gf.Yf=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},gf),ff=(vf.prototype.Aa=function(t){this.Zf=t},vf.prototype.Ta=function(t){this.td=t},vf.prototype.onMessage=function(t){this.ed=t},vf.prototype.close=function(){this.Jf()},vf.prototype.send=function(t){this.Xf(t)},vf.prototype.sd=function(){this.Zf()},vf.prototype.nd=function(t){this.td(t)},vf.prototype.rd=function(t){this.ed(t)},vf),lf={BatchGetDocuments:"batchGet",Commit:"commit"},pf="gl-js/ fire/"+Ii,df=(yf.prototype.od=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=pf},yf.prototype.La=function(a,i,r){var h=this,c=this.ad(a);return new Promise(function(o,s){var u=new Ei;u.listenOnce(wi.COMPLETE,function(){try{switch(u.getLastErrorCode()){case mi.NO_ERROR:var t=u.getResponseJson();Qs("Connection","XHR received:",JSON.stringify(t)),o(t);break;case mi.TIMEOUT:Qs("Connection",'RPC "'+a+'" timed out'),s(new Si(Di.DEADLINE_EXCEEDED,"Request time out"));break;case mi.HTTP_ERROR:var e=u.getStatus();if(Qs("Connection",'RPC "'+a+'" failed with status:',e,"response text:",u.getResponseText()),0<e){var n=u.getResponseJson().error;if(n&&n.status&&n.message){var i=(r=n.status.toLowerCase().replace("_","-"),0<=Object.values(Di).indexOf(r)?r:Di.UNKNOWN);s(new Si(i,n.message))}else s(new Si(Di.UNKNOWN,"Server responded with status "+u.getStatus()))}else Qs("Connection",'RPC "'+a+'" failed'),s(new Si(Di.UNAVAILABLE,"Connection failed."));break;default:Ks()}}finally{Qs("Connection",'RPC "'+a+'" completed.')}var r});var t=Object.assign({},i);delete t.database;var e=JSON.stringify(t);Qs("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.od(n,r),u.send(c,"POST",e,n,15)})},yf.prototype.Oa=function(t,e,n){return this.La(t,e,n)},yf.prototype.Pa=function(t,e){var n,i,r=[this.hd,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=gi(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ii.projectId+"/databases/"+this.ii.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.od(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=g().indexOf("Electron/")||0<=(i=g()).indexOf("MSIE ")||0<=i.indexOf("Trident/")||0<=g().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=r.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Qs("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new ff({Xf:function(t){f?Qs("Connection","Not sending because WebChannel is closed:",t):(c||(Qs("Connection","Opening WebChannel transport."),h.open(),c=!0),Qs("Connection","WebChannel sending:",t),h.send(t))},Jf:function(){return h.close()}});return a(bi.EventType.OPEN,function(){f||Qs("Connection","WebChannel transport opened.")}),a(bi.EventType.CLOSE,function(){f||(f=!0,Qs("Connection","WebChannel transport closed"),l.nd())}),a(bi.EventType.ERROR,function(t){f||(f=!0,function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(zs.logLevel<=p.WARN){var i=e.map(Ys);zs.warn.apply(zs,v(["Firestore ("+Ii+"): Connection"],i))}}("Connection","WebChannel transport errored:",t),l.nd(new Si(Di.UNAVAILABLE,"The operation could not be completed")))}),a(bi.EventType.MESSAGE,function(t){var e;if(!f){var n=t.data[0];$s(!!n);var i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(i){Qs("Connection","WebChannel received error:",i);var r=i.status,o=function(){var t=co[r];if(void 0!==t)return $o(t)}(),s=i.message;void 0===o&&(o=Di.INTERNAL,s="Unknown error status: "+r+" with message "+i.message),f=!0,l.nd(new Si(o,s)),h.close()}else Qs("Connection","WebChannel received:",n),l.rd(n)}}),setTimeout(function(){l.sd()},0),l},yf.prototype.ad=function(t){var e=lf[t];return this.hd+"/v1/projects/"+this.ii.projectId+"/databases/"+this.ii.database+"/documents:"+e},yf);function yf(t){this.ii=t.ii;var e=t.ssl?"https":"http";this.hd=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function vf(t){this.Xf=t.Xf,this.Jf=t.Jf}function gf(){var t=this;this.Wf=function(){return t.jf()},this.Gf=function(){return t.Hf()},this.Kf=[],this.zf()}function mf(){}function wf(){this.yo="undefined"!=typeof atob}Gs.an((Object.defineProperty(wf.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(wf.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),wf.prototype.L_=function(t){return Promise.resolve(new df(t))},wf.prototype.D_=function(){return new(cf.Yf()?cf:hf)},wf.prototype.Yo=function(t){return new js(t,{hi:!0})},wf.prototype.un=function(t){return JSON.stringify(t)},wf.prototype.atob=function(t){return atob(t)},wf.prototype.btoa=function(t){return btoa(t)},wf.prototype.ln=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n},new wf)),(Yc=bf).INTERNAL.registerComponent(new I("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Ec(e,n,new ic);var e,n},"PUBLIC").setServiceProps(Object.assign({},af))),Yc.registerVersion("@firebase/firestore","1.15.1")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
